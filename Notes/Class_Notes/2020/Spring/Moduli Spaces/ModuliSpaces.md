\newcommand{\textoperatorname}[1]{
  \operatorname{\textnormal{#1}}
}
\newcommand{\et}{\text{ét}}
\newcommand{\Et}{\text{Ét}}
\newcommand\stacksymbol[3]{
  \mathrel{\stackunder[2pt]{\stackon[4pt]{$#3$}{$\scriptscriptstyle#1$}}{
  $\scriptscriptstyle#2$}}
}
\newcommand{\ext}{\operatorname{Ext}}
\newcommand{\Ext}{\operatorname{Ext}}
\newcommand{\Endo}{\operatorname{End}}
\newcommand{\Ind}{\operatorname{Ind}}
\newcommand{\ind}{\operatorname{Ind}}
\newcommand{\coind}{\operatorname{Coind}}
\newcommand{\proj}{\operatorname{Proj}}
\newcommand{\Proj}{\operatorname{Proj}}
\newcommand{\res}{\operatorname{Res}}
\newcommand{\Res}{\operatorname{Res}}
\newcommand{\Hol}{\operatorname{Hol}}
\newcommand{\Br}{\operatorname{Br}}
\newcommand{\coh}{\operatorname{coh}}
\newcommand{\colspace}{\operatorname{colspace}}
\newcommand{\rowspace}{\operatorname{rowspace}}
\newcommand{\codom}{\operatorname{codom}}
\newcommand{\range}{\operatorname{range}}
\newcommand{\nullspace}{\operatorname{nullspace}}
\newcommand{\nullity}{\operatorname{nullspace}}
\newcommand{\projection}{\operatorname{Proj}}
\newcommand{\Der}{\operatorname{Der}}
\renewcommand{\AA}[0]{{\mathbb{A}}}
\newcommand{\Af}[0]{{\mathbb{A}}}
\newcommand{\CC}[0]{{\mathbb{C}}}
\newcommand{\CP}[0]{{\mathbb{CP}}}
\newcommand{\DD}[0]{{\mathbb{D}}}
\newcommand{\FF}[0]{{\mathbb{F}}}
\newcommand{\fq}[0]{{\mathbb{F}_{q}}}
\newcommand{\fqr}[0]{{\mathbb{F}_{q^r}}}
\newcommand{\GF}[0]{{\mathbb{GF}}}
\newcommand{\GG}[0]{{\mathbb{G}}}
\newcommand{\HH}[0]{{\mathbb{H}}}
\newcommand{\HP}[0]{{\mathbb{HP}}}
\newcommand{\KK}[0]{{\mathbb{K}}}
\newcommand{\kk}[0]{{\Bbbk}}
\newcommand{\bbm}[0]{{\mathbb{M}}}
\newcommand{\NN}[0]{{\mathbb{N}}}
\newcommand{\OP}[0]{{\mathbb{OP}}}
\newcommand{\PP}[0]{{\mathbb{P}}}
\newcommand{\QQ}[0]{{\mathbb{Q}}}
\newcommand{\RP}[0]{{\mathbb{RP}}}
\newcommand{\RR}[0]{{\mathbb{R}}}
\newcommand{\SpSp}[0]{{\mathbb{S}}}
\renewcommand{\SS}[0]{{\mathbb{S}}}
\newcommand{\TT}[0]{{\mathbb{T}}}
\newcommand{\ZZ}[0]{{\mathbb{Z}}}
\newcommand{\znz}[0]{\mathbb{Z}/n\mathbb{Z}}
\newcommand{\zpz}[0]{\mathbb{Z}/p\mathbb{Z}}
\newcommand{\zlz}[0]{\mathbb{Z}/\ell\mathbb{Z}}
\newcommand{\zlnz}[0]{\mathbb{Z}/\ell^n\mathbb{Z}}
\newcommand{\Qp}[0]{\mathbb{Q}_{(p)}}
\newcommand{\Zp}[0]{\mathbb{Z}_{(p)}}
\newcommand{\Arg}[0]{\operatorname{Arg}}
\newcommand{\PGL}[0]{\operatorname{PGL}}
\newcommand{\GL}[0]{\operatorname{GL}}
\newcommand{\Gl}[0]{\operatorname{GL}}
\newcommand{\gl}[0]{\operatorname{GL}}
\newcommand{\mat}[0]{\operatorname{Mat}}
\newcommand{\Mat}[0]{\operatorname{Mat}}
\newcommand{\Rat}[0]{\operatorname{Rat}}
\newcommand{\Perv}[0]{\operatorname{Perv}}
\newcommand{\Gal}[0]{\operatorname{Gal}}
\newcommand{\Hilb}[0]{\operatorname{Hilb}}
\newcommand{\Quot}[0]{\operatorname{Quot}}
\newcommand{\Art}[0]{\operatorname{Art}}
\newcommand{\red}[0]{\operatorname{red}}
\newcommand{\Pic}[0]{{\operatorname{Pic}}}
\newcommand{\lcm}[0]{\operatorname{lcm}}
\newcommand{\maps}[0]{\operatorname{Maps}}
\newcommand{\maxspec}[0]{{\operatorname{maxSpec}}}
\newcommand{\Tr}[0]{\operatorname{Tr}}
\newcommand{\adj}[0]{\operatorname{adj}}
\newcommand{\ad}[0]{\operatorname{ad}}
\newcommand{\ann}[0]{\operatorname{Ann}}
\newcommand{\Ann}[0]{\operatorname{Ann}}
\newcommand{\arcsec}[0]{\operatorname{arcsec}}
\newcommand{\ch}[0]{\operatorname{ch}}
\newcommand{\Sp}[0]{{\operatorname{Sp}}}
\newcommand{\syl}[0]{{\operatorname{Syl}}}
\newcommand{\ff}[0]{\operatorname{ff}}
\newcommand{\txand}[0]{{\operatorname{ and }}}
\newcommand{\fppf}[0]{\mathrm{\operatorname{fppf}}}
\newcommand{\Fppf}[0]{\mathrm{\operatorname{Fppf}}}
\newcommand{\zar}[0]{{\mathrm{zar}}}
\newcommand{\Zar}[0]{{\mathrm{Zar}}}
\newcommand{\qcoh}[0]{{\mathrm{QCoh}}}
\newcommand{\Qcoh}[0]{{\mathrm{QCoh}}}
\newcommand{\QCoh}[0]{{\mathrm{QCoh}}}
\newcommand{\codim}[0]{\operatorname{codim}}
\newcommand{\coim}[0]{\operatorname{coim}}
\newcommand{\ssets}[0]{\operatorname{sSets}}
\newcommand{\dom}[0]{\operatorname{dom}}
\newcommand{\txor}[0]{{\operatorname{ or }}}
\newcommand{\txt}[1]{{\operatorname{ {#1} }}}
\newcommand{\Gr}[0]{{\operatorname{Gr}}}
\newcommand{\gr}[0]{{\operatorname{gr}}}
\newcommand{\dcoset}[3]{
    {\textstyle #1}
    \mkern-4mu\scalebox{1.5}{$\diagdown$}\mkern-5mu^{\textstyle #2}
    \mkern-4mu\scalebox{1.5}{$\diagup$}\mkern-5mu{\textstyle #3} }
\newcommand{\grdim}[0]{{\operatorname{gr\,dim}}}
\newcommand{\Aut}[0]{{\operatorname{Aut}}}
\newcommand{\aut}[0]{\operatorname{Aut}}
\newcommand{\Inn}[0]{{\operatorname{Inn}}}
\newcommand{\Out}[0]{{\operatorname{Out}}}
\newcommand{\mltext}[1]{\left\{\begin{array}{c}#1\end{array}\right\}}
\newcommand{\Fun}[0]{{\operatorname{Fun}}}
\newcommand{\SL}[0]{{\operatorname{SL}}}
\newcommand{\PSL}[0]{{\operatorname{PSL}}}
\newcommand{\SO}[0]{{\operatorname{SO}}}
\newcommand{\SU}[0]{{\operatorname{SU}}}
\newcommand{\SP}[0]{{\operatorname{SP}}}
\newcommand{\per}[0]{{\operatorname{Per}}}
\newcommand{\loc}[0]{{\operatorname{loc}}}
\newcommand{\Top}[0]{{\operatorname{Top}}}
\newcommand{\Ab}[0]{{\operatorname{Ab}}}
\newcommand{\mcTop}[0]{\mathcal{T}\operatorname{op}}
\newcommand{\hoTop}[0]{{\operatorname{hoTop}}}
\newcommand{\Sch}[0]{{\operatorname{Sch}}}
\newcommand{\sch}[0]{{\operatorname{Sch}}}
\newcommand{\Sing}[0]{{\operatorname{Sing}}}
\newcommand{\alg}[0]{\mathrm{Alg}}
\newcommand{\scalg}[0]{\mathrm{sCAlg}}
\newcommand{\calg}[0]{\mathrm{CAlg}}
\newcommand{\dR}[0]{\mathrm{dR}}
\newcommand{\poly}[0]{\operatorname{poly}}
\newcommand{\Vect}[0]{{\operatorname{Vect}}}
\newcommand{\Sh}[0]{{\operatorname{Sh}}}
\newcommand{\presh}[0]{{\operatorname{Presh}}}
\newcommand{\Presh}[0]{{\operatorname{Presh}}}
\newcommand{\ab}[0]{{\operatorname{ab}}}
\newcommand{\op}[0]{^{\operatorname{op}}}
\newcommand{\Op}[0]{{\operatorname{Op}}}
\newcommand{\Ob}[0]{{\operatorname{Ob}}}
\newcommand{\prim}[0]{{\operatorname{prim}}}
\newcommand{\Set}[0]{{\operatorname{Set}}}
\newcommand{\Sets}[0]{{\operatorname{Set}}}
\newcommand{\Grp}[0]{{\operatorname{Grp}}}
\newcommand{\Groups}[0]{{\operatorname{Groups}}}
\newcommand{\Homeo}[0]{{\operatorname{Homeo}}}
\newcommand{\Diffeo}[0]{{\operatorname{Diffeo}}}
\newcommand{\MCG}[0]{{\operatorname{MCG}}}
\newcommand{\set}[0]{{\operatorname{Set}}}
\newcommand{\Tor}[0]{\operatorname{Tor}}
\newcommand{\sets}[0]{{\operatorname{Set}}}
\newcommand{\Sm}[0]{{\operatorname{Sm}_k}}
\newcommand{\orr}[0]{{\operatorname{ or }}}
\newcommand{\annd}[0]{{\operatorname{ and }}}
\newcommand{\bung}[0]{\operatorname{Bun}_G}
\newcommand{\const}[0]{{\operatorname{const.}}}
\newcommand{\disc}[0]{{\operatorname{disc}}}
\newcommand{\id}[0]{\operatorname{id}}
\newcommand{\im}[0]{\operatorname{im}}
\newcommand{\pt}[0]{{\{\operatorname{pt}\}}}
\newcommand{\sep}[0]{^\operatorname{sep}}
\newcommand{\tors}[0]{{\operatorname{tors}}}
\newcommand{\tor}[0]{\operatorname{Tor}}
\newcommand{\height}[0]{\operatorname{ht}}
\newcommand{\cpt}[0]{\operatorname{compact}}
\newcommand{\abs}[1]{{\left\lvert {#1} \right\rvert}}
\newcommand{\stack}[1]{\mathclap{\substack{ #1 }}} 
\newcommand{\qtext}[1]{{\quad \operatorname{#1} \quad}}
\newcommand{\qst}[0]{{\quad \operatorname{such that} \quad}}
\newcommand{\actsonl}[0]{\curvearrowleft}
\newcommand{\actson}[0]{\curvearrowright}
\newcommand{\bd}[0]{{\del}}
\newcommand{\bigast}[0]{{\mathop{\Large \ast}}}
\newcommand{\coker}[0]{\operatorname{coker}}
\newcommand{\cok}[0]{\operatorname{coker}}
\newcommand{\conjugate}[1]{{\overline{{#1}}}}
\newcommand{\converges}[1]{\overset{#1}}
\newcommand{\correspond}[1]{\theset{\substack{#1}}}
\newcommand{\cross}[0]{\times}
\newcommand{\by}[0]{\times}
\newcommand{\dash}[0]{{\hbox{-}}}
\newcommand{\dd}[2]{{\frac{\partial #1}{\partial #2}\,}}
\newcommand{\definedas}[0]{\coloneqq}
\newcommand{\da}[0]{\coloneqq}
\newcommand{\del}[0]{{\partial}}
\newcommand{\directlim}[0]{\varinjlim}
\newcommand{\inverselim}[0]{\varprojlim}
\newcommand{\disjoint}[0]{{\coprod}}
\newcommand{\Disjoint}[0]{\displaystyle\coprod}
\newcommand{\dual}[0]{^\vee}
\newcommand{\sm}[0]{\setminus}
\newcommand{\smz}[0]{\setminus\theset{0}}
\newcommand{\eps}[0]{\varepsilon}
\newcommand{\equalsbecause}[1] {\stackrel{\mathclap{\scriptscriptstyle{#1}}}{=}}
\newcommand{\floor}[1]{{\left\lfloor #1 \right\rfloor}}
\newcommand{\up}[0]{\uparrow}
\newcommand{\generators}[1]{\left\langle{#1}\right\rangle}
\newcommand{\gs}[1]{\left\langle{#1}\right\rangle}
\newcommand{\homotopic}[0]{\simeq}
\newcommand{\injectivelim}[0]{\varinjlim}
\newcommand{\inner}[2]{{\left\langle {#1},~{#2} \right\rangle}}
\newcommand{\ip}[2]{{\left\langle {#1},~{#2} \right\rangle}}
\newcommand{\union}[0]{\cup}
\newcommand{\Union}[0]{\bigcup}
\newcommand{\intersect}[0]{\cap}
\newcommand{\Intersect}[0]{\bigcap}
\newcommand{\into}[0]{\to}
\newcommand{\inv}[0]{^{-1}}
\newcommand{\mfa}[0]{{\mathfrak{a}}}
\newcommand{\mfb}[0]{{\mathfrak{b}}}
\newcommand{\mfc}[0]{{\mathfrak{c}}}
\newcommand{\mff}[0]{{\mathfrak{f}}}
\newcommand{\mfi}[0]{{\mathfrak{I}}}
\newcommand{\mfm}[0]{{\mathfrak{m}}}
\newcommand{\mfn}[0]{{\mathfrak{n}}}
\newcommand{\mfp}[0]{{\mathfrak{p}}}
\newcommand{\mfq}[0]{{\mathfrak{q}}}
\newcommand{\mfr}[0]{{\mathfrak{r}}}
\newcommand{\lieb}[0]{{\mathfrak{b}}}
\newcommand{\liegl}[0]{{\mathfrak{gl}}}
\newcommand{\lieg}[0]{{\mathfrak{g}}}
\newcommand{\lieh}[0]{{\mathfrak{h}}}
\newcommand{\lien}[0]{{\mathfrak{n}}}
\newcommand{\liesl}[0]{{\mathfrak{sl}}}
\newcommand{\lieso}[0]{{\mathfrak{so}}}
\newcommand{\liesp}[0]{{\mathfrak{sp}}}
\newcommand{\lieu}[0]{{\mathfrak{u}}}
\newcommand{\Lie}[0]{\operatorname{Lie}}
\newcommand{\nilrad}[0]{{\mathfrak{N}}}
\newcommand{\jacobsonrad}[0]{{\mathfrak{J}}}
\newcommand{\mm}[0]{{\mathfrak{m}}}
\newcommand{\pr}[0]{{\operatorname{pr}}}
\newcommand{\mapsvia}[1]{\xrightarrow{#1}}
\newcommand{\fromvia}[1]{\xleftarrow{#1}}
\newcommand{\mapstovia}[1]{\xmapsto{#1}}
\newcommand{\ms}[0]{\xrightarrow{\sim}}
\newcommand{\from}[0]{\leftarrow}
\newcommand{\mapstofrom}[0]{\rightleftharpoons}
\DeclareMathOperator*{\mapbackforth}{\rightleftharpoons}
\newcommand{\mapscorrespond}[2]{\mathrel{\operatorname*{\rightleftharpoons}_{#1}^{#2}}}
\newcommand{\injects}[0]{\hookrightarrow}
\newcommand{\injectsvia}[1]{\xhookrightarrow{#1}}
\newcommand{\surjects}[0]{\twoheadrightarrow}
\newcommand{\surjectsvia}[2][]{
  \xrightarrow[#1]{#2}\mathrel{\mkern-14mu}\rightarrow
}
\newcommand{\adjoint}[0]{\leftrightarrows}
\newcommand{\kx}[1]{k[x_1, \cdots, x_{#1}]}
\newcommand{\kxn}[0]{k[x_1, \cdots, x_{n}]}
\newcommand{\MM}[0]{{\mathcal{M}}}
\newcommand{\OO}[0]{{\mathcal{O}}}
\newcommand{\OX}[0]{{\mathcal{O}_X}}
\newcommand{\imaginarypart}[1]{{\mathcal{Im}({#1})}}
\newcommand{\mca}[0]{{\mathcal{A}}}
\newcommand{\mcb}[0]{{\mathcal{B}}}
\newcommand{\mcc}[0]{{\mathcal{C}}}
\newcommand{\mcd}[0]{{\mathcal{D}}}
\newcommand{\mce}[0]{{\mathcal{E}}}
\newcommand{\mcf}[0]{{\mathcal{F}}}
\newcommand{\mcg}[0]{{\mathcal{G}}}
\newcommand{\mch}[0]{{\mathcal{H}}}
\newcommand{\mci}[0]{{\mathcal{I}}}
\newcommand{\mcj}[0]{{\mathcal{J}}}
\newcommand{\mck}[0]{{\mathcal{K}}}
\newcommand{\mcl}[0]{{\mathcal{L}}}
\newcommand{\mcm}[0]{{\mathcal{M}}}
\newcommand{\mcp}[0]{{\mathcal{P}}}
\newcommand{\mcs}[0]{{\mathcal{S}}}
\newcommand{\mct}[0]{{\mathcal{T}}}
\newcommand{\mcu}[0]{{\mathcal{U}}}
\newcommand{\mcv}[0]{{\mathcal{V}}}
\newcommand{\mcx}[0]{{\mathcal{X}}}
\newcommand{\mcz}[0]{{\mathcal{Z}}}
\newcommand{\kfq}[0]{K_{/\mathbb{F}_q}}
\newcommand{\cl}[0]{\operatorname{cl}}
\newcommand{\Cl}[0]{\operatorname{Cl}}
\newcommand{\St}[0]{\operatorname{St}}
\newcommand{\trdeg}[0]{\operatorname{trdeg}}
\newcommand{\dist}[0]{\operatorname{dist}}
\newcommand{\Dist}[0]{\operatorname{Dist}}
\newcommand{\crit}[0]{\operatorname{crit}}
\newcommand{\diam}[0]{{\operatorname{diam}}}
\newcommand{\gal}[0]{\operatorname{Gal}}
\newcommand{\diff}[0]{\operatorname{Diff}}
\newcommand{\diag}[0]{\operatorname{diag}}
\newcommand{\soc}[0]{\operatorname{Soc}}
\newcommand{\hd}[0]{\operatorname{Head}}
\newcommand{\grad}[0]{\operatorname{grad}}
\newcommand{\hilb}[0]{\operatorname{Hilb}}
\newcommand{\minpoly}[0]{{\operatorname{minpoly}}}
\newcommand{\Hom}[0]{{\operatorname{Hom}}}
\newcommand{\shom}{\mathscr{H}\operatorname{\kern -3pt {\calligra\large om}}}
\newcommand{\Map}[0]{{\operatorname{Map}}}
\newcommand{\multinomial}[1]{\left(\!\!{#1}\!\!\right)}
\newcommand{\nil}[0]{{\operatorname{nil}}}
\newcommand{\normalneq}{\mathrel{\reflectbox{$\trianglerightneq$}}}
\newcommand{\normal}[0]{{~\trianglelefteq~}}
\newcommand{\norm}[1]{{\left\lVert {#1} \right\rVert}}
\newcommand{\pnorm}[2]{{\left\lVert {#1} \right\rVert}_{#2}}
\newcommand{\notdivides}[0]{\nmid}
\newcommand{\notimplies}[0]{\centernot\implies}
\newcommand{\onto}[0]{\twoheadhthtarrow}
\newcommand{\ord}[0]{{\operatorname{Ord}}}
\newcommand{\pic}[0]{{\operatorname{Pic}}}
\newcommand{\projectivelim}[0]{\varprojlim}
\newcommand{\rad}[0]{{\operatorname{rad}}}
\newcommand{\ralg}[0]{\operatorname{R-alg}}
\newcommand{\kalg}[0]{k\dash\operatorname{alg}}
\newcommand{\rank}[0]{\operatorname{rank}}
\newcommand{\realpart}[1]{{\mathcal{Re}({#1})}}
\newcommand{\Log}[0]{\operatorname{Log}}
\newcommand{\reg}[0]{\operatorname{Reg}}
\newcommand{\restrictionof}[2]{ {\left.{{#1}} \right|_{{#2}} } }
\newcommand{\ro}[2]{{ \left.{{#1}} \right|_{{#2}} }}
\newcommand{\rk}[0]{{\operatorname{rank}}}
\newcommand{\evalfrom}[0]{\Big|}
\renewcommand{\mod}{\pmod}
\newcommand{\rmod}[0]{{R\dash\operatorname{mod}}}
\newcommand{\mods}[1]{{{#1}\dash\operatorname{mod}}}
\newcommand{\modr}[0]{{\operatorname{mod}}}
\newcommand{\kmod}[0]{{k\dash\operatorname{mod}}}
\newcommand{\Mod}[0]{{\operatorname{Mod}}}
\newcommand{\rotate}[2]{{\style{display: inline-block; transform: rotate(#1deg)}{#2}}}
\newcommand{\selfmap}[0]{{\circlearrowleft}}
\newcommand{\semidirect}[0]{\rtimes}
\newcommand{\sgn}[0]{\operatorname{sgn}}
\newcommand{\sign}[0]{\operatorname{sign}}
\newcommand{\spanof}[0]{{\operatorname{span}}}
\newcommand{\spec}[0]{\operatorname{Spec}}
\newcommand{\mspec}[0]{\operatorname{mSpec}}
\newcommand{\Jac}[0]{\operatorname{Jac}}
\newcommand{\stab}[0]{{\operatorname{Stab}}}
\newcommand{\stirlingfirst}[2]{\genfrac{[}{]}{0pt}{}{#1}{#2}}
\newcommand{\stirling}[2]{\genfrac\{\}{0pt}{}{#1}{#2}}
\newcommand{\strike}[1]{{\enclose{horizontalstrike}{#1}}}
\newcommand{\suchthat}[0]{{~\mathrel{\Big|}~}}
\newcommand{\st}[0]{{~\mathrel{\Big|}~}}
\newcommand{\supp}[0]{{\operatorname{supp}}}
\newcommand{\sym}[0]{\operatorname{Sym}}
\newcommand{\Sym}[0]{\operatorname{Sym}}
\newcommand{\Wedge}[0]{\Lambda}
\newcommand{\tensor}[0]{\otimes}
\newcommand{\connectsum}[0]{\mathop{\Large \#}}
\newcommand{\theset}[1]{\left\{{#1}\right\}}
\newcommand{\ts}[1]{\left\{{#1}\right\}}
\newcommand{\infsum}[1]{\sum_{{#1=0}}^\infty}
\newcommand{\gens}[1]{\left\langle{#1}\right\rangle}
\newcommand{\thevector}[1]{{\left[ {#1} \right]}}
\newcommand{\tv}[1]{{\left[ {#1} \right]}}
\newcommand{\too}[1]{{\xrightarrow{#1}}}
\newcommand{\transverse}[0]{\pitchfork}
\newcommand{\trianglerightneq}{\mathrel{\ooalign{\raisebox{-0.5ex}{\reflectbox{\rotatebox{90}{$\nshortmid$}}}\cr$\triangleright$\cr}\mkern-3mu}}
\newcommand{\tr}[0]{\operatorname{Tr}}
\newcommand{\uniformlyconverges}[0]{\rightrightarrows}
\newcommand{\abuts}[0]{\Rightarrow}
\newcommand{\covers}[0]{\rightrightarrows}
\newcommand{\units}[0]{^{\times}}
\newcommand{\nonzero}[0]{^{\bullet}}
\newcommand{\wait}[0]{{\,\cdot\,}}
\newcommand{\wt}[0]{{\operatorname{wt}}}
\renewcommand{\bar}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}
\renewcommand{\div}[0]{\operatorname{Div}}
\newcommand{\Div}[0]{\operatorname{Div}}
\newcommand{\Prin}[0]{\operatorname{Prin}}
\newcommand{\Frac}[0]{\operatorname{Frac}}
\renewcommand{\hat}[1]{\widehat{#1}}
\renewcommand{\mid}[0]{\mathrel{\Big|}}
\renewcommand{\qed}[0]{\hfill\blacksquare}
\renewcommand{\too}[0]{\longrightarrow}
\renewcommand{\vector}[1]{\mathbf{#1}}
\newcommand*\dif{\mathop{}\!\operatorname{d}}
\newcommand{\ddt}{\tfrac{\dif}{\dif t}}
\newcommand{\ddx}{\tfrac{\dif}{\dif x}}
\renewcommand{\labelitemiii}{$\diamondsuit$}
\renewcommand{\labelitemiv}{$\diamondsuit$}
\newcommand\vecc[2]{\textcolor{#1}{\textbf{#2}}}
\newcommand*{\vertbar}{\rule[-1ex]{0.5pt}{2.5ex}}
\newcommand*{\horzbar}{\rule[.5ex]{2.5ex}{0.5pt}}
\newcommand\aug{\fboxsep=-\fboxrule\!\!\!\fbox{\strut}\!\!\!}
\newcommand\rref{\operatorname{RREF}}
\newcommand{\interior}[0]{^\circ}
\newcommand{\increasesto}[0]{\nearrow}
\newcommand{\decreasesto}[0]{\searrow}
\newcommand\jan{\operatorname{Jan}}
\DeclareMathOperator{\righttriplearrows} {{\; \tikz{ \foreach \y in {0, 0.1, 0.2} { \draw [-stealth] (0, \y) -- +(0.5, 0);}} \; }}
\DeclareMathOperator{\Exists}{\exists}
\DeclareMathOperator{\Forall}{\forall}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclareMathOperator*{\hocolim}{hocolim}

\newcommand{\contains}[0]{\supseteq}
\newcommand{\containing}[0]{\supseteq}

\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\thecat}[1]{\mathbf{#1}}
\newcommand{\sheaf}[1]{\operatorname{\mathcal{#1}}}

\newcommand\rrarrows{\rightrightarrows}
\newcommand\rrrarrows{
    \mathrel{\substack{\textstyle\rightarrow\\[-0.6ex]
        \textstyle\rightarrow \\[-0.6ex]
        \textstyle\rightarrow}}
}

\newcommand{\colim}{\operatornamewithlimits{\underset{\longrightarrow}{colim}}}


\newcommand\fp[1]{\underset{\scriptscriptstyle {#1} }{\times}}
\newcommand\ul[1]{\underline{#1}}

\newcommand\Hc[0]{{\check{H}}}
\newcommand\Cc[0]{{\check{C}}}

# References

- Course notes [@bakker_8330]

- General reference [@hartshorne_2010]

- Hilbert schemes/functors of points: [@stromme], [@hartshorne_def].
  
  - Slightly more detailed: [@fantechi_2005]
  
- Curves on surfaces: [@mumford_1985]

- Moduli of Curves: [@harris_morrison_1998] (chatty and less rigorous) 


# Schemes vs Representable Functors (Thursday January 9th)

Last time:
fix an $S\dash$scheme, i.e. a scheme over $S$.
Then there is a map
\[
\Sch_{_{/S}} &\to \Fun( \Sch_{_{/S}}\op, \Set ) \\
x &\mapsto h_x(T) = \hom_{\Sch_{_{/S}} }(T, x)
.\]

where $T' \mapsvia{f} T$ is given by 

\[
h_x(f): h_x(T) &\to h_x(T') \\
\qty{ T \mapsto x } &\mapsto \text{triangles of the form}
.\]

\begin{tikzcd}
T' \arrow[rr] \arrow[rdd] &               & X \\
                          &               &   \\
                          & T \arrow[ruu] &  
\end{tikzcd}


## Representability


:::{.theorem title="?"}
$$\hom_{\Fun}(h_x, F) = F(x).$$
:::


:::{.corollary title="?"}
$$\hom_{\Sch_{/S}}(x, y) \cong \hom_{\Fun}(h_x, h_y).$$
:::



:::{.definition title="Moduli Functor"}
A **moduli functor** is  a map

\[
F: (\Sch_{/S})\op &\to \Set \\
F(x) &= \text{ "Families of something over $x$" } \\
F(f) &= \text{"Pullback"}
.\]

:::


:::{.definition title="Moduli Space"}
A **moduli space** for that "something" appearing above is an $M \in \mathrm{Obj}(\Sch_{/S})$ such that $F \cong h_M$.
:::

:::{.remark}
Now fix $S = \spec(k)$, and write $h_m$ for the functor of points over $M$.
Then
\[
h_m(\spec(k)) = M(\spec(k)) \cong \text{families over } \spec k = F(\spec k)
.\]
:::

:::{.remark}
$h_M(M) \cong F(M)$ are families over $M$, and $\id_M \in \mathrm{Mor}_{\Sch_{/S}}(M, M) = \xi_{Univ}$ is the universal family.

Every family is uniquely the pullback of $\xi_{\text{Univ}}$.
This makes it much like a classifying space.
For $T\in \Sch_{/S}$,
\[
h_M &\mapsvia{\cong} F \\
f\in h_M(T) &\mapsvia{\cong} F(T) \ni \xi = F(f)(\xi_{\text{Univ}})
.\]

where $T\mapsvia{f} M$ and $f = h_M(f)(\id_M)$.
:::


:::{.remark}
If $M$ and $M'$ both represent $F$ then $M \cong M'$ up to unique isomorphism.

\begin{tikzcd}
\xi_M              &  & \xi_{M'} \\
M \arrow[rr, "f"]  &  & M'       \\
                  &  &          \\
M' \arrow[rr, "g"] &  & M        \\
\xi_{M'}           &  & \xi_M   
\end{tikzcd}

which shows that $f, g$ must be mutually inverse by using universal properties.
:::


:::{.example title="?"}
A length 2 subscheme of $\AA^1_k$ (??) then 
$$
F(S) = \theset{ V(x^2 + bx + c)} \subset \AA^5
$$ 
where $b, c \in \OO_s(s)$, which is functorially bijective with $\theset{b, c \in \OO_s(s)}$ and $F(f)$ is pullback.
Then $F$ is representable by $\AA_k^2(b, c)$ and the universal object is given by 
$$
V(x^2 + bx + c) \subset \AA^1(?) \cross \AA^2(b, c)
$$ 
where $b, c \in k[b, c]$.
Moreover, $F'(S)$ is the set of effective Cartier divisors in $\AA_5'$ which are length 2 for every geometric fiber.
$F''(S)$ is the set of subschemes of $\AA_5'$ which are length 2 on all geometric fibers.
In both cases, $F(f)$ is always given by pullback.
:::

Problem:
$F''$ is not a good moduli functor, as it is not representable.
Consider $\spec k[\varepsilon]$, for which we have the following situation:

\begin{tikzpicture}[scale=2.0]
\begin{axis}[
		hide axis,
    xmin=-12,
xmax=18,
    ymin=-4,
    ymax=10,
		xtick = {0},
		ytick = {0},
    disabledatascaling]

\draw[-][black][opacity=1] (axis cs:-10.0, 9) --  (axis cs:-10, -0);
\draw[-][black][opacity=1] (axis cs:-14.0, 0) --  (axis cs:-6, -0);

\draw[-][black][opacity=1] (axis cs:0.0, 9)  --  (axis cs:-0, -0);
\draw[-][black][opacity=1] (axis cs:-4.0, 0) --  (axis cs:4, -0);

\draw[-][black][opacity=1] (axis cs:10.0, 9)  --  (axis cs: 10, -0);
\draw[-][black][opacity=1] (axis cs:6.0, 0) --  (axis cs:14, -0);

\node[draw, circle, blue,  scale=0.4, fill=blue](left1) at (axis cs:-10, 6)  [anchor=center] {};
\node[right=1mm of left1,font=\tiny] {$(\eps+ x  - 1)$};
\node[draw, circle, blue,  scale=0.4, fill=blue](center1) at (axis cs:0, 6)  [anchor=center] {};
\node[right=1mm of center1,font=\tiny] {$(x)(\eps, x-1)$};
\node[draw, circle, blue,  scale=0.4, fill=blue](right1) at (axis cs:10, 6)  [anchor=center] {};
\node[right=1mm of right1,font=\tiny] {$(x(x-1), \eps)$};

\node[draw, circle, blue,  scale=0.4, fill=blue](left2) at (axis cs:-10, 3)  [anchor=center] {};
\node[draw, circle, blue,  scale=0.4, fill=blue](center2) at (axis cs:0, 3)  [anchor=center] {};
\node[draw, circle, blue,  scale=0.4, fill=blue](right2) at (axis cs:10, 3)  [anchor=center] {};

\node[draw, circle, blue,  scale=0.4, fill=blue](left3) at (axis cs:-10, 0)  [anchor=center] {};
\node[draw, circle, blue,  scale=0.4, fill=blue](center3) at (axis cs:0, 0)  [anchor=center] {};
\node[draw, circle, blue,  scale=0.4, fill=blue](right3) at (axis cs:10, 0)  [anchor=center] {};

\draw[-][blue, very thick][opacity=0.9] (axis cs:-10.0, 6) --  (axis cs:-7, 9);
\draw[-][blue, very thick][opacity=0.9] (axis cs:-10.0, 3) --  (axis cs:-7, 3);

\draw[-][blue, very thick][opacity=0.9] (axis cs:0, 3) --  (axis cs:3, 3);
\draw[-][blue, very thick][opacity=0.9] (axis cs:0, 0) --  (axis cs:3, 0);

\draw[-][blue, very thick][opacity=0.9] (axis cs:10, 0) --  (axis cs:13, 0);
\end{axis}
\end{tikzpicture}

\begin{table}[H]
\centering
\begin{tabular}{l|lll}
\hline \\
$F$   & $\checkmark$ & x & x \\
$F'$  & $\checkmark$ & x &  x \\
$F''$ & $\checkmark$ & $\checkmark$ & $\checkmark$
\end{tabular}
\end{table}

\begin{tikzcd}
\spec k \arrow[rrr, "i", hook]                &  &  & {\spec k[\varepsilon]} &  & =F'(\spec k) \arrow[rd] &               \\
{F(\spec k[\varepsilon])} \arrow[rrr, "F(i)"] &  &  & F(\spec k) \arrow[rru] &  &                         & =F''(\spec k) \\
&  &  & &  &                         &               \\
{T_p F^{', ''}}\arrow[uu, "\subset", hook]&  &  & P = V(x(x-1)) \arrow[uu, "\in", hook] & &&              
\end{tikzcd}

We think of $T_p F^{', ''}$ as the tangent space at $p$.
If $F$ is representable, then it is actually the Zariski tangent space.

\begin{tikzcd}
{M(\spec k[\varepsilon])} \arrow[rr] &  & M(\spec k) \\
&  & \\
T_p M \arrow[rr] \arrow[uu, "\subset", hook]&  & p \arrow[uu, "\subset", hook]         
\end{tikzcd}


\begin{tikzcd}
&                                            & \spec k \arrow[rdd, "?"] \arrow[lldd, hook] &                                     \\
&                                            &                                             &                                     \\
{\spec k[\varepsilon]} \arrow[rrr] &                                            &                                             & {\spec \OO_{M, p} \subset M} \\
&                                            &                                             & k                                   \\
& {\OO_{M, p}} \arrow[rru] \arrow[rr] &                                             & {k[\varepsilon]} \arrow[u]          \\
& \mfm_p  \arrow[u, hook]                                     &                                             & (\varepsilon)  \arrow[u, hook]                       \\
& \mfm_p^2 \arrow[u, hook]                                      &                                             & 0  \arrow[u, hook]                                 
\end{tikzcd}

Moreover, $T_p M = (\mfm_p / \mfm_p^2)\dual$, and in particular this is a $k\dash$vector space.
To see the scaling structure, take $\lambda \in k$.

\[
\lambda: k[\varepsilon] & \to k[\varepsilon] \\
\varepsilon &\mapsto \lambda \varepsilon \\ \\
\lambda^*: \spec(k[\varepsilon]) &\to \spec(k[\varepsilon]) \\ \\
\lambda: M(\spec(k[\varepsilon])) &\to M(\spec(k[\varepsilon]))
.\]


\begin{tikzcd}
M(\spec(k[\varepsilon])) 
  \ar[r, "\lambda"]
&
M(\spec(k[\varepsilon])) \\
T_pM 
  \ar[r]
  \ar[u, "\subseteq"]
& 
T_pM 
  \ar[u, "\subseteq"]
\end{tikzcd}



**Conclusion**:
If $F$ is representable, for each $p\in F(\spec k)$ there exists a unique point of $T_p F$ that are invariant under scaling.


:::{.remark}
If $F, F', G \in \Fun( (\Sch_{/S})\op, \Set)$, there exists a fiber product

\begin{tikzcd}
F \cross_G F' \arrow[rr, dotted] \arrow[dd, dotted] &  & F' \arrow[dd] \\
&  & \\
F \arrow[rr] &  & G            
\end{tikzcd}

where 
$$
(F \cross_G F')(T) = F(T) \cross_{G(T)} F'(T)
.$$

:::



:::{.remark}
This works with the functor of points over a fiber product of schemes $X \cross_T Y$ for $X, Y \to T$, where 
$$
h_{X \cross_T Y}= h_X \cross_{h_t} h_Y
.$$
:::


:::{.remark}
If $F, F', G$ are representable, then so is the fiber product $F \cross_G F'$.
:::



:::{.remark}
For any functor 
$$
F: (\Sch_{/S})\op \to \Set
,$$
for any $T \mapsvia{f} S$ there is an induced functor 
\[
F_T: (\Sch_{/T}) &\to \Set \\ 
x &\mapsto F(x)
.\]
:::

:::{.remark}
$F$ is representable by $M_{/S}$ implies that $F_T$ is representable by $M_T = M \cross_S T / T$.
:::

## Projective Space

Consider $\PP^n_\ZZ$, i.e. "rank 1 quotient of an $n+1$ dimensional free module".

:::{.proposition title="?"}
$\PP^n_{/\ZZ}$ represents the following functor
\[
F: \Sch\op &\to \Set \\
S &\mapsto  \ts{ \OO_S^{n+1} \to L \to 0 } / \sim
.\]

where $\sim$ identifies diagrams of the following form:

\begin{tikzcd}
\OO_s^{n+1} \arrow[dd, equal] \arrow[rr] &  & L \arrow[dd, "\cong"] \arrow[rr] &  & 0 \\
&  &                                  &  &   \\
\OO_s^{n+1} \arrow[rr]                 &  & M \arrow[rr]                     &  & 0
\end{tikzcd}

and $F(f)$ is given by pullbacks.
:::

:::{.remark}
$\PP^n_{/S}$ represents the following functor: 
\[
F_S: (\Sch_{/S})\op &\to \Sets \\
T &\mapsto F_S(T) =  \theset{ \OO_T^{n+1} \to L \to 0} / \sim
.\]

This gives us a cleaner way of gluing affine data into a scheme.
:::


### Proof of Proposition

:::{.remark}
Note that $\OO^{n+1} \to L \to 0$ is the same as giving $n+1$ sections $s_1, \cdots s_n$ of $L$, where surjectivity ensures that they are not the zero section.
So 
$$
F_i(S) = \theset{\OO_s^{n+1} \to L \to 0}/\sim
,$$ 
with the additional condition that $s_i \neq 0$ at any point.
There is a natural transformation $F_i \to F$ by forgetting the latter condition, and is in fact a subfunctor. 
[^what-is-a-subfunction]

[^what-is-a-subfunction]: 
$F\leq G$ is a subfunctor iff $F(s) \injects G(s)$.

:::

:::{.claim}
It is enough to show that each $F_i$ and each $F_{ij}$ are representable, since we have natural transformations:

\begin{tikzcd}
F_i  \arrow[rr]              &  & F              \\
                        &  &                \\
F_{ij} \arrow[rr] \arrow[uu] &  & F_j \arrow[uu]
\end{tikzcd}

and each $F_{ij} \to F_i$ is an open embedding on the level of their representing schemes.
:::


:::{.example title="?"}
For $n=1$, we can glue along open subschemes

\begin{tikzcd}
&  & F_0 \\
F_{01} \arrow[rru] \arrow[rrd] &  &     \\
&  & F_1
\end{tikzcd}

For $n=2$, we get overlaps of the following form:
\begin{tikzcd}
&  &                                                                                             &                              & F_0 \arrow[rrdd] &  &   \\
&  &                                                                                             & F_{01} \arrow[rd] \arrow[ru] &                  &  &   \\
F_{012} \arrow[rr] \arrow[rrru] \arrow[rrrd] &  & F_{02} \arrow[ru] \arrow[rd] \arrow[rruu, dotted, bend left=49] \arrow[rrdd, bend right=49] &                              & F_1 \arrow[rr]   &  & F \\
&  &                                                                                             & F_{12} \arrow[ru] \arrow[rd] &                  &  &   \\
&  &                                                                                             &                              & F_2 \arrow[rruu] &  &  
\end{tikzcd}

This claim implies that we can glue together $F_i$ to get a scheme $M$.
We want to show that $M$ represents $F$.
$F(s)$ (LHS) is equivalent to an open cover $U_i$ of $S$ and sections of $F_i(U_i)$ satisfying the gluing (RHS).
Going from LHS to RHS isn't difficult, since for $\OO_s^{n+1} \to L \to 0$, $U_i$ is the locus where $s_i \neq 0$ and by surjectivity, this gives a cover of $S$.
The RHS to LHS comes from gluing.
:::

:::{.proof title="of claim"}
We have
$$
F_i(S) = \theset{\OO_S^{n+1} \to L \cong \OO_s \to 0, s_i \neq 0}
,$$ 
but there are no conditions on the sections other than $s_i$.  
So specifying $F_i(S)$ is equivalent to specifying $n-1$ functions $f_1 \cdots \hat f_i \cdots f_n \in \OO_S(s)$ with $f_k \neq 0$.
We know this is representable by $\AA^n$.
We also know $F_{ij}$ is obviously the same set of sequences, where now $s_j \neq 0$ as well, so we need to specify $f_0 \cdots \hat f_i \cdots f_j \cdots f_n$ with $f_j \neq 0$.
This is representable by $\AA^{n-1} \cross \GG_m$, i.e. $\spec k[x_1, \cdots, \hat x_i, \cdots, x_n, x_j\inv]$.
Moreover, $F_{ij} \injects F_i$ is open.

What is the compatibility we are using to glue?
For any subset $I \subset \theset{0, \cdots, n}$, we can define 
$$
F_I = \theset{\OO_s^{n+1} \to L \to 0, s_i\neq 0 \text{ for } i\in I} = {\prod{i\in I}}_F F_i
,$$ 
and $F_I \to F_J$ when $I \supset J$.
:::


# Functors as Spaces (Tuesday January 14th)

Last time:
representability of functors, and specifically projective space $\PP_{/\ZZ}^n$ constructed via a functor of points, i.e.

\[
h_{\PP^n_{/\ZZ} }: \Sch\op &\to \Set \\
s &\mapsto \PP^n_{/\ZZ}(s) = \theset{ \OO_s^{n+1} \to L \to 0}
.\]

for $L$  a line bundle, up to isomorphisms of diagrams:

\begin{tikzcd}
\OO_{s}^{n+1} \arrow[dd, no head, Rightarrow] \arrow[rr] &  & L \arrow[rr] \arrow[dd, "\cong"] &  & 0 \\
&  &                                  &  &   \\
\OO_{s}^{n+1} \arrow[rr]                                 &  & M \arrow[rr]                     &  & 0
\end{tikzcd}


That is, line bundles with $n+1$ sections that globally generate it, up to isomorphism.
The point was that for $F_i \subset \PP_{/\ZZ}^n$ where
$$
F_i(s) = \theset{\OO_s^{n+1} \to L \to 0 \suchthat s_i \text{ is invertible}}
$$
are representable and can be glued together, and projective space represents this functor.

:::{.remark}
Because projective space represents this functor, there is a universal object:
\begin{tikzcd}
  \OO_{\PP_{\ZZ}^n}^{n+1} 
  \arrow[rr] 
&  
& L \arrow[dd, equal] 
    \arrow[rr] 
&  
&
0 
\\
&  
&                                              
&  
&   
\\
&  
& \OO_{\PP_{\ZZ}^n}(1)
&  
&
\end{tikzcd}
and other functors are pullbacks of the universal one. (Moduli Space)
:::


:::{.exercise title="?"}
Show that $\PP_{/\ZZ}^n$ is proper over $\spec \ZZ$.
Use the evaluative criterion, i.e. there is a unique lift

\begin{tikzcd}
\spec k \arrow[dd] \arrow[rrr]            &  &  & \PP^n_{\ZZ} \arrow[dd] \\
&  &  &                        \\
\spec R \arrow[rrr] \arrow[rrruu, dashed] &  &  & \spec \ZZ
\end{tikzcd}
:::

## Generalizing Open Covers

:::{.definition title="Equalizer"}
For a category $C$, we say a diagram $X \to Y \rightrightarrows Z$ is an *equalizer* iff it is universal with respect to the following property:

\begin{tikzcd}
X \arrow[rr] &  & Y \arrow[rr, shift left=.5ex] \ar[rr, shift right=.5ex] &  & Z \\
&  &                                                &  &   \\
&  & S \arrow[lluu, dashed, "\exists!"] \arrow[uu] \arrow[rruu] &  &
\end{tikzcd}

where $X$ is the universal object.
:::

:::{.example title="?"}
For sets, $X = \theset{y \suchthat f(y) = g(y)}$ for $Y \mapsvia{f, g} Z$.
:::

:::{.definition title="?"}
A **coequalizer** is the dual notion,
\begin{tikzcd}
&  & S                       &  &                                     \\
&  &                         &  &                                     \\
Z \arrow[rruu] \arrow[rr, shift left=.5ex] \ar[rr, shift right=.5ex] &  & Y \arrow[uu] \arrow[rr] &  & X \arrow[lluu, "\exists!"', dashed]
\end{tikzcd}
:::

:::{.example title="?"}
Take $C = \Sch_{/S}$, $X_{/S}$ a scheme, and $X_\alpha \subset X$ an open cover.
We can take two fiber products, $X_{\alpha \beta}, X_{\beta, \alpha}$:

\begin{tikzcd}
X_\alpha \arrow[rr]                   &  & X                  &  &  & X_\beta \arrow[rr]                    &  & X                   \\
&  &                    &  &  &                                       &  &                     \\
X_{\alpha\beta} \arrow[uu] \arrow[rr] &  & X_\beta \arrow[uu] &  &  & X_{\beta\alpha} \arrow[uu] \arrow[rr] &  & X_\alpha \arrow[uu]
\end{tikzcd}

These are canonically isomorphic.
:::


In $\Sch_{/S}$, we have

\begin{tikzcd}
\disjoint_{\alpha\beta} X_{\alpha\beta}
\arrow[rr, shift left=.5ex, "f_{\alpha\beta}"]
\arrow[rr, shift right=.5ex,"g_{\alpha\beta}", swap]
&  & \disjoint_{\alpha} X_\alpha \arrow[rr] &  & X
\end{tikzcd}


where
\[
f_{\alpha\beta}: X_{\alpha\beta} &\to X_\alpha \\
g_{\alpha\beta}: X_{\alpha\beta} &\to X_\beta
;\]

form a coequalizer.
Conversely, we can glue schemes.
Given $X_\alpha \to X_{\alpha\beta}$ (schemes over open subschemes), we need to check triple intersections:

\begin{tikzpicture}[scale=0.25]
\node[draw,circle,minimum size=5cm,inner sep=0pt, label={[xshift=-1.25cm, yshift=-1.0cm] $X_\alpha$ }] at (-3,3) {};
\node[draw,circle,minimum size=5cm,inner sep=0pt, label={[xshift=1.25cm, yshift=-1.0cm] $X_\beta$ }] at (3,3) {};
\node[draw,circle,minimum size=5cm,inner sep=0pt, label={[yshift=-4.25cm] $X_\gamma$ }] at (0,-3) {};
\end{tikzpicture}


Then $\varphi_{\alpha\beta}: X_{\alpha\beta}\mapsvia{\cong} X_{\beta\alpha}$ must satisfy the **cocycle condition**:

:::{.definition title="Cocycle Condition"}
Maps $\varphi_{\alpha\beta}: X_{\alpha\beta}\mapsvia{\cong} X_{\beta\alpha}$ satisfy the **cocycle condition** iff

1. $$\varphi_{\alpha\beta}\inv \qty{ X_{\beta\alpha} \intersect X_{\beta\gamma} } = X_{\alpha\beta} \intersect X_{\alpha \gamma},$$
noting that the intersection is exactly the fiber product $X_{\beta\alpha} \cross_{X_\beta} X_{\beta \gamma}$.

2. The following diagram commutes:

\begin{tikzcd}
X_{\alpha\beta} \intersect X_{\alpha\gamma} \arrow[rdd, "\varphi_{\alpha\beta}"'] \arrow[rr, "\varphi_{\alpha\gamma}"] && X_{\gamma\alpha} \intersect X_{\gamma\beta} \\
&&                                             \\
& X_{\beta\alpha}\intersect X_{\beta\gamma} \arrow[ruu, "\varphi_{\beta\gamma}"'] &
\end{tikzcd}
:::
  

Then there exists a scheme $X_{/S}$ such that $\disjoint_{\alpha\beta} X_{\alpha\beta} \rightrightarrows \disjoint X_\alpha \to X$ is a coequalizer; this is the gluing.

Subfunctors satisfy a patching property because morphisms to schemes are locally determined.
Thus representable functors (e.g. functors of points) have to be (Zariski) sheaves.


:::{.definition title="Zariski Sheaf"}
A functor $F: (\Sch_{/S})\op \to \Set$ is a **Zariski sheaf** iff for any scheme $T_{/S}$ and any open cover $T_\alpha$, the following is an equalizer:
$$
F(T) \to \prod F(T_\alpha) \rightrightarrows \prod_{\alpha\beta} F(T_{\alpha\beta})
$$
where the maps are given by restrictions.
:::

:::{.example title="?"}
Any representable functor is a Zariski sheaf precisely because the gluing is a coequalizer.
Thus if you take the cover
$$
\disjoint_{\alpha\beta} T_{\alpha\beta} \to \disjoint_{\alpha}T_\alpha \to T
,$$
since giving a local map to $X$ that agrees on intersections if enough to specify a map from $T\to X$.

Thus any functor represented by a scheme automatically satisfies the sheaf axioms.

:::
  
  
:::{.definition title="Subfunctors and Open/Closed Functors"}
Suppose we have a morphism $F' \to F$ in the category $\Fun(\Sch_{/S}, \Set)$.

- This is a **subfunctor** if $\iota(T)$ is injective for all $T_{/S}$.

- $\iota$ is **open/closed/locally closed** iff for any scheme $T_{/S}$ and any section $\xi \in F(T)$ over $T$, then there is an open/closed/locally closed set $U\subset T$ such that for all maps of schemes $T' \mapsvia{f} T$, we can take the pullback $f^* \xi$ and $f^*\xi \in F'(T')$ iff $f$ factors through $U$.

:::


:::{.remark}
This says that we can test if pullbacks are contained in a subfunctors by checking factorization.
This is the same as asking if the subfunctor $F'$, which maps to $F$ (noting a section is the same as a map to the functor of points), and since $T\to F$ and $F' \to F$, we can form the fiber product $F' \cross_F T$:
\begin{tikzcd}
F' \ar[r] & F \\
& \\
F' \cross_F T \ar[r, "g"] \ar[uu] & T \ar[uu, "\xi" swap]
\end{tikzcd}

and $F' \cross_F T \cong U$.
Note: this is almost tautological!
Thus $F' \to F$ is open/closed/locally closed iff $F' \cross_F T$ is representable and $g$ is open/closed/locally closed.
I.e. base change is representable.
:::



:::{.exercise title="?"}
\envlist

1. If $F' \to F$ is open/closed/locally closed and $F$ is representable, then $F'$ is representable as an open/closed/locally closed subscheme

2. If $F$ is representable, then open/etc subschemes yield open/etc subfunctors
:::


:::{.slogan}
Treat functors as spaces.
:::

We have a definition of open, so now we'll define coverings.


:::{.definition title="Open Covers"}
A collection of open subfunctors $F_\alpha \subset F$ is an **open cover** iff for any $T_{/S}$ and any section $\xi \in F(T)$, i.e. $\xi: T\to F$, the $T_\alpha$ in the following diagram are an open cover of $T$:

\begin{tikzcd}
F_\alpha \ar[r] & F \\
& \\
T_\alpha \ar[uu] \ar[r] & T \ar[uu, "\xi" swap]
\end{tikzcd}

:::

:::{.example title="?"}
Given
$$
F(s) = \theset{\OO_s^{n+1} \to L \to 0}
$$
and $F_i(s)$ given by those where $s_i \neq 0$ everywhere, the $F_i \to F$ are an open cover.
Because the sections generate everything, taking the $T_i$ yields an open cover.
:::

## Results About Zariski Sheaves

:::{.proposition title="?"}
A Zariski sheaf $F: (\Sch_{/S})\op \to \Set$ with a representable open cover is representable.
:::

:::{.proof title="?"}
Let $F_\alpha \subset F$ be an open cover, say each $F_\alpha$ is representable by $x_\alpha$.
Form the fiber product $F_{\alpha\beta} = F_\alpha \cross_F F_\beta$.
Then $x_\beta$ yields a section (plus some openness condition?), so $F_{\alpha\beta} = x_{\alpha\beta}$ representable.
Because $F_\alpha \subset F$, the $F_{\alpha\beta} \to F_\alpha$ have the correct gluing maps.


This follows from Yoneda (schemes embed into functors), and we get maps $x_{\alpha\beta} \to x_\alpha$ satisfying the gluing conditions.
Call the gluing scheme $x$; we'll show that $x$ represents $F$.
First produce a map $x\to F$ from the sheaf axioms.
We have a map $\xi \in \prod_\alpha F(x_\alpha)$, and because we can pullback, we get a unique element $\xi \in F(X)$ coming from the diagram
\[
F(x) \to \prod F(x_\alpha) \rightrightarrows \prod_{\alpha\beta} F(x_{\alpha\beta})
.\]
:::




:::{.lemma title="?"}
If $E \to F$ is a map of functors and $E, F$ are Zariski sheaves, where there are open covers $E_\alpha \to E, F_\alpha \to F$ with commutative diagrams

\begin{tikzcd}
E \ar[r] & F \\
  & \\
E_\alpha \ar[uu] \ar[r, "\cong"] & F_\alpha \ar[uu]
\end{tikzcd}


(i.e. these are isomorphisms locally), then the map is an isomorphism.
:::


With the following diagram, we're done by the lemma:
\begin{tikzcd}
X \ar[r] & F \\
  & \\
X_\alpha \ar[uu] \ar[r, "\cong"] & F_\alpha \ar[uu]
\end{tikzcd}


:::{.example title="?"}
For $S$ and $E$ a locally free coherent $\OO_s$ module,
\[
\PP E(T) = \theset{f^* E \to L \to 0} / \sim
\]
is a generalization of projectivization, then $S$ admits a cover $U_i$ trivializing $E$.
Then the restriction $F_i \to \PP E$ were $F_i(T)$ is the above set if $f$ factors through $U_i$ and empty otherwise.
On $U_i$, $E \cong \OO_{U_i}^{n_i}$, so $F_i$ is representable by $\PP_{U_i}^{n_i - 1}$ by the proposition.
Note that this is clearly a sheaf.
:::



:::{.example title="?"}
For $E$ locally free over $S$ of rank $n$, take $r<n$ and consider the functor
$$
\Gr(k, E)(T) = \theset{f^*E \to Q \to 0} /\sim
$$
(a Grassmannian) where $Q$ is locally free of rank $k$.
:::


:::{.exercise title="?"}
\envlist

1. Show that this is representable

2. For the Plucker embedding
$$
\Gr(k, E) \to \PP \wedge^k E
,$$
a section over $T$ is given by $f^*E \to Q \to 0$ corresponding to
$$
\wedge^k f^*E \to \wedge^k Q \to 0
,$$
noting that the left-most term is $f^* \wedge^k E$.
Show that this is a closed subfunctor.

> That it's a functor is clear, that it's closed is not.

:::
  


Take $S = \spec k$, then $E$ is a $k\dash$vector space $V$, then sections of the Grassmannian are quotients of $V \tensor \OO$ that are free of rank $n$.
Take the subfunctor $G_w \subset \Gr(k, V)$ where
$$
G_w(T) = \theset{\OO_T \tensor V \to Q \to 0} \text{ with } Q \cong \OO_t\tensor W \subset \OO_t \tensor V
.$$
If we have a splitting $V = W \oplus U$, then $G_W = \AA(\hom(U, W))$.
If you show it's closed, it follows that it's proper by the exercise at the beginning.

> Thursday:
> Define the Hilbert functor, show it's representable.
> The Hilbert scheme functor gives e.g. for $\PP^n$ of all flat families of subschemes.

# Thursday January 16th

## Subfunctors

:::{.definition title="Open Functors"}
A functor $F' \subset F: (\Sch_{/S})\op \to \Set$ is **open** iff for all $T \mapsvia{\xi} F$ where $T = h_T$ and $\xi \in F(T)$.
:::

We can take fiber products:
\begin{tikzcd}
F' \ar[r] & F \\
 & \\
\parbox{3cm}{\centering $F' \cross_F T$ \\ Representable} \ar[r, "\text{Open}"] \ar[uu] & T \ar[uu]
\end{tikzcd}

So we can think of "inclusion in $F$" as being an *open condition*: for all $T_{/S}$ and $\xi \in F(T)$, there exists an open $U \subset T$ such that for all covers $f: T' \to T$, we have
$$
F(f)(\xi) = f^*(\xi) \in F'(T')
$$
iff $f$ factors through $U$.

Suppose $U \subset T$ in $\Sch/T$,  we then have
\[
h_{U/T}(T') = \begin{cases}
\emptyset & T' \to T \text{ doesn't factor } \\
\pt & \text{otherwise}
\end{cases}
.\]

which follows because the literal statement is $h_{U/T}(T') = \hom_T(T', U)$.
By the definition of the fiber product,
\[
(F' \cross_F T)(T') = \theset{ (a,b) \in F'(T) \cross T(T) \suchthat \xi(b) = \iota(a) \text{ in  } F(T)}
,\]
where $F' \mapsvia{\iota} F$ and $T \mapsvia{\xi} F$.
So note that the RHS diagram here is exactly given by pullbacks, since we identify sections of $F/T'$ as sections of $F$ over $T/T'$ (?).
\begin{tikzcd}
F' \ar[r, "\iota"] & F \\
 & & \\
F' \cross_F T \ar[uu] \ar[r] & T\ar[uu, "\xi"] \\
 & & \\
& & T'
\ar[uuuul, "f\circ \xi", bend right]
\ar[uul, "f"]
\end{tikzcd}

We can thus identify
\[
(F' \cross_F T)(T') = h_{U_{/S}}(T')
,\]
and so for $U \subset T$ in $\Sch_{/S}$ we have $h_{U_{/S}} \subset h_{T_{/S}}$ is the functor of maps that factor through $U$.
We just identify $h_{U_{/S}}(T') = \hom_S(T', U)$ and $h_{T_{/S}}(T') = \hom_S(T', T)$.


:::{.example title="?"}
$\GG_m, \GG_a$.
The scheme/functor $\GG_a$ represents giving a global function, $\GG_m$ represents giving an invertible function.

\begin{tikzcd}
\GG_m \ar[r] & \GG_a \\
& \\
T'
\arrow[uur, phantom, "\scalebox{1.5}{$\llcorner$}" , very near start, color=black]
\ar[uu] \ar[r] & T \ar[uu, "f \in \OO_T(T)", swap]
\end{tikzcd}

where $T' = \theset{f\neq 0}$ and $\OO_T(T)$ are global functions.
:::

## Actual Geometry: Hilbert Schemes

> The best moduli space!

:::{.warnings}
Unless otherwise stated, assume all schemes are Noetherian.
:::

We want to parameterize families of subschemes over a fixed object.
Fix $k$ a field, $X_{/k}$ a scheme; we'll parameterize subschemes of $X$.

:::{.definition title="The Hilbert Functor"}
The **Hilbert functor** is given by
\[
\Hilb_{X_{/S}}: (\Sch_{/S})^{op} \to \Set
\]
which sends $T$ to closed subschemes $Z \subset X \cross_S T \to T$ which are flat over $T$.
:::

Here **flatness** will replace the Cartier condition:

:::{.definition title="Flatness"}
For $X \mapsvia{f} Y$ and $\FF$ a coherent sheaf on $X$, $f$ is **flat** over $Y$ iff for all $x\in X$ the stalk $F_x$ is a flat $\OO_{y, f(x)}\dash$module.
:::

:::{.remark}
Note that $f$ is flat if $\OO_x$ is.
Flatness corresponds to varying continuously.
Note that everything works out if we only play with finite covers.
:::

:::{.remark}
If $X_{/k}$ is projective, so $X \subset \PP^n_k$, we have line bundles $\OO_x(1) = \OO(1)$.
For any sheaf $F$ over $X$, there is a Hilbert polynomial $P_F(n) = \chi(F(n)) \in \ZZ[n]$, i.e. we twist by $\OO(1)$ $n$ times.
The cohomology of $F$ isn't changed by the pushforward into $\PP_n$ since it's a closed embedding, and so
\[
\chi(X, F) = \chi(\PP^n, i_* F) = \sum (-1)^i \dim_k H^i(\PP^n, i_* F(n))
.\]
:::

:::{.fact}
For $n \gg 0$, $\dim_k H^0 = \dim M_n$, the $n$th graded piece of $M$, which is a graded module over the homogeneous coordinate ring whose $i_*F = \tilde M$.
:::

In general, for $L$ ample of $X$ and $F$ coherent on $X$, we can define a **Hilbert polynomial**,
\[
P_F(n) = \chi(F\tensor L^n)
.\]

This is an invariant of a polarized projective variety, and in particular subschemes.
Over irreducible bases, flatness corresponds to this invariant being constant.

:::{.proposition title="?"}
For $f:X\to S$ projective, i.e. there is a factorization:


\begin{tikzcd}
X \arrow[ddr, "f"] \arrow[rr, hook] & & \PP^n \cross S \ni \OO(1) \ar[ddl] \\
& & \\
& S &
\end{tikzcd}


If $S$ is reduced, irreducible, locally Noetherian, then $f$ is flat $\iff$ $P_{\OO_{x_s}}$ is constant for all $s\in S$.
:::

:::{.remark}
To be more precise, look at the base change to $X_1$, and the pullback of the fiber? $\OO\mid_{x_i}$?
Note that we're not using the word "integral" here!
$S$ is flat $\iff$ the Hilbert polynomial over the fibers are constant.
:::

:::{.example title="?"}
The zero-dimensional subschemes $Z \in \PP^n_k$, then $P_Z$ is the length of $Z$, i.e. $\dim_k(\OO_Z)$, and
$$
P_Z(n) = \chi(\OO_Z \tensor \OO(n)) = \chi(\OO_Z) = \dim_k H^0(Z; \OO_Z) = \dim_k \OO_Z(Z)
.$$

For two closed points in $\PP^2$, $P_Z = 2$.
Consider the affine chart $\AA^2 \subset \PP^2$, which is given by
$$
\spec k[x, y]/(y, x^2) \cong k[x]/(x^2)
$$
and $P_Z = 2$.
I.e. in flat families, it has to record how the tangent directions come together.
:::

:::{.example title="?"}
Consider the flat family $xy = 1$ (flat because it's an open embedding) over $k[x]$, here we have points running off to infinity.
:::

:::{.proposition title="Modified Characterization of Flatness for Sheaves"}
A sheaf $F$ is flat iff $P_{F_S}$ is constant.
:::
  
## Proof That Flat Sheaves Have Constant Hilbert Polynomials

Assume $S = \spec A$ for $A$ a local Noetherian domain.

:::{.lemma title="?"}
For $F$ a coherent sheaf on $X_{/A}$ is flat, we can take the cohomology via global sections $H^0(X; F(n))$.
This is an $A\dash$module, and is a free $A\dash$module for $n\gg 0$.
:::

:::{.proof title="of lemma"}
Assumed $X$ was projective, so just take $X = \PP_A^n$ and let $F$ be the pushforward.
There is a correspondence sending $F$ to its ring of homogeneous sections constructed by taking the sheaf associated to the graded module \

\[
\sum_{n\gg0} H^0( \PP_A^m; F(n) )
=
\bigoplus_{n \gg 0} H^0(\PP_A^m; F(n))
\]
and taking the associated sheaf ($Y \mapsto \tilde Y$, as per Hartshorne's notation) which is free, and thus $F$ is free. [^tilde-construction]

[^tilde-construction]: 
See tilde construction in Hartshorne, essentially amounts to localizing free tings.

Conversely, take an affine cover $U_i$ of $X$.
We can compute the cohomology using Čech cohomology, i.e. taking the Čech resolution.
We can also assume $H^i(\PP^m; F(n)) = 0$ for $n \gg 0$, and the Čech complex vanishes in high enough degree.
But then there is an exact sequence
\[
0 \to H^0(\PP^m; F(n)) \to \mathcal C^0( \underline{U}; F(n) ) \to \cdots \to C^m( \underline{U}; F(n) ) \to 0
.\]
Assuming $F$ is flat, and using the fact that flatness is a 2 out of 3 property, the images of these maps are all flat by induction from the right.
Finally, local Noetherian and finitely generated flat implies free.
:::

By the lemma, we want to show $H^0(\PP^m; F(n))$ is free for $n\gg 0$ iff the Hilbert polynomials on the fibers $P_{F_S}$ are all constant.

:::{.claim title="1"}
It suffices to show that for each point $s\in \spec A$, we have
$$
H^0(X_s; F_S(n)) = H^0(X; F(n)) \tensor k(S)
$$
for $k(S)$ the residue field, for $n\gg 0$.
:::

:::{.claim title="2"}
$P_{F_S}$ measures the rank of the LHS.
:::

:::{.proof title="of claim 2"}

$\implies$:
The dimension of RHS is constant, whereas the LHS equals $P_{F_S}(n)$.

$\impliedby$:
If the dimension of the RHS is constant, so the LHS is free.
:::

For a f.g. module over a local ring, testing if localization at closed point and generic point have the same rank.
For $M$ a finitely generated module over $A$, we find that
$$
0 \to A^n \to M \to Q
$$
is surjective after tensoring with $\mathrm{Frac}(A)$, and tensoring with $k(S)$ for a closed point, if $\dim A^n = \dim M$ then $Q = 0$.


:::{.proof title="of claim 1"}
By localizing, we can assume $s$ is a closed point.
Since $A$ is Noetherian, its ideal is f.g. and we have
$$
A^m \to A \to k(S) \to 0
.$$
We can tensor with $F$ (viewed as restricting to fiber) to obtain
$$
F(n)^m \to F(n) \to F_S(n) \to 0
.$$
Because $F$ is flat, this is still exact.
We can take $H^*(x, \wait)$, and for $n\gg 0$ only $H^0$ survives.
This is the same as tensoring with $H^0(x, F(n))$.
:::

:::{.definition title="Hilbert Polynomial Subfunctor"}
Given a polynomial $P \in \ZZ[n]$ for $X_{/S}$ projective, we define a subfunctor by picking only those with Hilbert polynomial $p$ fiberwise as $\Hilb^P_{X_{/S}} \subset \Hilb_{X_{/S}}$.
This is given by $Z \subset X \cross_S T$ with $P_{Z} = P$.
:::

:::{.theorem title="Grothendieck"}
If $S$ is Noetherian and $X_{/S}$ projective, then $\Hilb_{X_{/S}}^P$ is representable by a projective $S\dash$scheme.

> See **cycle spaces** in analytic geometry.
:::

# Hilbert Polynomials (Thursday January 23)

Some facts about the Hilbert polynomial:

1. For a subscheme $Z \subset \PP_k^n$ with $\deg P_z = \dim Z = n$, then
  $$
  p_z(t) = \deg z \frac{t^n}{n!} + O(t^{n-1})
  .$$

2. We have $p_z(t) = \chi(\OO_z(t))$, consider the sequence
  $$
  0 \to I_z(t) \to \OO_{\PP^n}^{(t)} \to \OO_z^{(t)} \to 0
  ,$$
  then $\chi(I_z(t)) = \dim H^0( \PP^n, J_z(t)  )$ for $t \gg 0$, and $p_z(0)$ is the Euler characteristic of $\OO_Z$.

:::{.remark}
Keywords to look up here: Serre vanishing, Riemann-Roch, ideal sheaf.
:::

:::{.example title="The twisted cubic"}

\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1, scale=0.6, every node/.style={scale=0.6}]

\node (myfirstpic) at (325,200) {\includegraphics{/home/zack/SparkleShare/github.com/Notes/Class_Notes/2020/Spring/Moduli Spaces/sections/figures/2021-01-03_17-27}};
\node[scale=2.0] at (400, 180) {$C$};
\node[scale=2.0] at (200, 0) {$\PP^3$};


\draw[very thick, blue] (-50,400) -- (-50,100);
\draw[thick] (-50-20,400) -- (-50+20,400);
\draw[thick] (-50-20,100) -- (-50+20,100);
\node[scale=2.0] at (-25, 100-20) {$\PP^1$};

\draw [thick, right hook-latex ] (-50+20, 200) -- (150, 200);
\node[scale=2.0] at (50, 180) {$\iota$};

\end{tikzpicture}

Then
\[
p_C(t) = (\deg C)t + \chi(\OO_{\PP^1}) = 3t + 1
.\]

:::

### Hypersurfaces

Recall that length 2 subschemes of $\PP^1$ are the same as specifying quadratics that cut them out, each such $Z \subset \PP^1$ satisfies $Z = V(f)$ where $\deg f = d$ and $f$ is homogeneous.
So we'll be looking at $\PP H^0(\PP^n_k, \OO(d))\dual$, and the guess would be that this is $\hilb_{\PP^n_k}$
Resolve the structure sheaf

\[
0 \to \OO_{\PP^n}(-d) \to \OO_{\PP^n}(t) \to \OO_D(t) \to 0
.\]
so we can twist to obtain
\[
0 \to \OO_{\PP^n}(t-d) \to \OO_{\PP^n}(t) \to \OO_D(t) \to 0
.\]
Then
\[
\chi(\OO_D(t)) = \chi(\OO_{\PP^n}(t)) - \chi(\OO_{\PP^n}(t-d))
,\]
which is
\[
{n+t \choose n} - {n+t-d \choose n} = \frac{dt^{n-1}}{(n-1)!} + O(t^{n-2})
.\]

:::{.lemma title="?"}
Anything with the Hilbert polynomial of a degree $d$ hypersurface is in fact a degree $d$ hypersurface.
:::

We want to write a morphism of functors
\[
\hilb_{\PP^n_k}^{P_{n, d}} \to \PP H^0 (\PP^n, \OO(d) )\dual
.\]
which sends flat families to families of equations cutting them out.
Want
$$
Z \subset \PP^n \cross S \to \OO_s \tensor H^0( \PP^n, \OO(d) )\dual \to L \to 0
.$$
This happens iff
$$
0 \to L\dual \to \OO_s \tensor H^0(\PP^n, \OO(d))
$$
with torsion-free quotient.
Note that we use $L\dual$ instead of $\OO_s$ because of scaling.
We have
\[
0 \to I_z &\to \OO_{\PP^n \cross S} \to \OO_z \to 0 \\
0 \to I_z(d) &\to \OO_{\PP^n \cross S}(d) \to \OO_z(d) \to 0 \quad\text{by twisting}
.\]
We then consider $\pi_s: \PP^n \cross S \to S$, and apply the pushforward to the above sequence.
Notie that it is not right-exact:

\begin{tikzcd}
  0 
  \ar[r]  
& \pi_{s*} I_z(d) 
  \ar[r] 
& \pi_{s*} \OO_{\PP^n \cross S}(d) 
  \ar[r] 
& \pi_{s*} \OO_z(d) 
  \ar[r] 
&  0 
\\
& & & & 
\\
  \ar[uu, equal]0 
  \ar[r] 
& \OO_s \tensor H^0(\PP^n, \OO(d)) 
  \ar[uu, equal]L\dual = 
  \ar[uu, equal]
  \ar[r] 
& 
  \ar[uu, equal]\text{locally free} 
  \ar[r] 
& 0
\ar[uu, equal]
\end{tikzcd}

\todo[inline]{Note: above diagram may be off horizontally?}

This equality follows from flatness, cohomology, and base change.
In particular, we need the following:

:::{.fact}
The scheme-theoretic fibers, given by $H^0(\PP^n, I_z(d))$ and $H^0(\PP^n, \OO_z(d))$, are all the same dimension.
:::
     

Using

1. Cohomology and base change, i.e. for $X \mapsvia{f} Y$ a map of Noetherian schemes (or just finite-type) and $F$ a sheaf on $X$ which is flat over $Y$, there is a natural map (not usually an isomorphism)
$$
R^i f_* f \tensor k(y) \to H^i(x_y, \restrictionof{F}{x_y})
,$$
but is an isomorphism if $\dim H^i(x_y, \restrictionof{F}{x_y})$ is constant, in which case $R^i f_* f$ is locally free.

2. If $Z \subset \PP^n_k$ is a degree $d$ hypersurface, then independently we know
  $$
  \dim H^0(\PP^n, I_z(d)) = 1 \text{ and } \dim H^0(\PP^n, \OO_z(d)) = {d+n \choose n} - 1
  .$$


To get a map going backwards, we take the universal degree 2 polynomial and form
$$
V(a_{00} x_0^2 + a_{11} x_1^2 + a_{12}x_2^2 + a_{01}x_0 x_1 + a_{02} x_0 x_2 + a_{12} x_1 x_2) \subset \PP^2 \cross \PP^5
.$$

### Example: Twisted Cubics

Consider a map $\PP^1 \to \PP^3$ obtained by taking a basis of a homogeneous cubic polynomial.
The canonical example is
\[
(x, y) \to (x^3, x^2y, xy^2, y^3)
.\]
Then
\[
P_C(t) = 3t + 1
\]
and $\hilb_{\PP_k^3}^{3t+1}$ has a component with generic point a twisted cubic, and another component with points a curve disjoint union a point, and the overlap are nodal curves with a "fat" 3-dimensional point:

![Components of the Hilbert Scheme](figures/2020-01-23-13:20.png)\

Then $P_{C'} = 1 + \tilde P$, the Hilbert polynomial of just the base without the disjoint point, so this equals $1 + P_{2, 3} = 1 + (3t + 0) = 3t +1$.
For $P_{C''}$, we take the sequence
$$
0 \to k \to \OO_{C''} \to \OO_{C'' \text{reduced}} \to 0
,$$
so
$$
P_{C''} = 1 + P_{C'' \text{red}} = 3t+1
.$$

:::{.remark}
Note that flat families *must* have the same (constant) Hilbert polynomial.
:::

Note that we can get paths in this space from $C\to C''$ and $C'\to C''$ by collapsing a twisted cubic onto a plane, and sending a disjoint point crashing into the node on a nodal cubic.
We're mapping $\PP^1 \to \PP^3$, and there is a natural action of $\PGL(4) \actson \PP^3$, so we get a map
\[
\PGL(4) \cross \PP^3 \to \PP^3
.\]

Let $c\in \PP^3$ and let $\mcc$ be the preimage.
This induces (?) a map
\[
\PGL(4) \to \hilb_{\PP^3}^{3t+1}
\]
where the fiber over $[C]$ in the latter is $\PGL(2) = \Aut(\PP^1)$.
By dimension counting, we find that the dimension of the twisted cubic component is $15 - 3 = 12$.
The 15 in the other component comes from 3-dim choices of plane, 3-dim choices of a disjoint point, and
\[
\PP H^0(\PP^2, \OO(3))\dual \cong \PP^9
,\]
yielding 15 dimensions.
To show that these are actually different components, we use Zariski tangent spaces.
Let $T_1$ be the tangent space of the twisted cubic component, then
$$
\dim T_1 \hilb_{\PP_k^3}^{3t+1} = 12
,$$
and similarly the dimension of the tangent space over the $C'$ component is 15.

:::{.fact}
Let $A$ be Noetherian and local, then the dimension of the Zariski tangent space, $\dim \mfm /\mfm^2 \geq \dim A$, the Krull dimension.
If this is an equality, then $A$ is regular.
:::

:::{.slogan}
Dimensions of tangent spaces give an upper bound.
:::

:::{.proposition title="?"}
If $X_{/k}$ is projective and $P$ is a Hilbert polynomial, then $[Z] \in \hilb_{X_{/k}}^P$, i.e. a closed subscheme of $X$ with Hilbert polynomial $p$ (note there's an ample bundle floating around) then the tangent space is $\hom_{\OO_x}(I_z, \OO_z)$.
:::

# Hilbert Schemes of Hypersurfaces (Tuesday January 28th)

Last time:
Twisted cubics, given by $\hilb_{\PP^3_k}^{3t+1}$.

\begin{tikzpicture}
\node (node_one) at (0,0) {
  \includegraphics{/home/zack/SparkleShare/github.com/Notes/Class_Notes/2020/Spring/Moduli Spaces/sections/figures/2021-01-03_21-29}
  };

\node (a) at (0, -4) {$?$};

\node (a) at (-4.5, 3.9) {$A$};
\filldraw[blue](-4.45, 3.4) circle (0.1);

\node (a) at (2.44, 2.4) {$B$};
\filldraw[blue](2.04, 2.2) circle (0.1);

\node (a) at (-1.8, 1.85) {$C$};
\filldraw[red](-1.38, 1.85) circle (0.1);

\node (a) at (-4., 7) {$12$};
\node (a) at (3., 5.5) {$15$};
\end{tikzpicture}

> Components of the Scheme of Cubic Curves.

We got lower (?) bounds on the dimension by constructing families, but want an exact dimension. 
The following will be a key fact:


:::{.proposition title="?"}
Let $Z\subset X$ be a closed $k\dash$dimensional subspace.
For $[z] \in \hilb_{X_{_{/k}}}^P(k)$, we have an identification of the Zariski tangent space 
\[
T_{[z]} \hilb_{X_{_{/k}} }^P = \hom_{\OO_X}(I_z, \OO_Z)
\]
:::

Say
\[
F: (\sch_{_{_{/k}}})\op \to \Set
\]
is a functor and let $x\in F(k)$.
There is an inclusion $i: \spec k \injects \spec k[\eps]$
and an induced map 
 
\[
F(\spec k [\eps]) &\mapsvia{i^*} F(\spec k) \\
T_x F \definedas (i^*)\inv(x) &\mapsto x
\]
So if $F$ is represented by a scheme $H_{/k}$, then  
\[
T_x h_J = T_x H = (\mfm_x / \mfm_x^2)\dual \,\,\text{over } k
\]
Will need a criterion for flatness later, esp. for Artinian thickenings.

:::{.lemma title="?"}
Assume $A'$ is a Noetherian ring and $0 \to J \to A' \to A \to 0$ with $J^2 = 0$.
Assume we have $X'_{/ \spec A'}$, and a coherent sheaf $F'$ on $X'$, where $X'$ is Noetherian.
Then $F'$ is flat over $A'$ iff


1. $F$ is flat
2. $0 \to F\tensor_A J \to F'$ is exact.

\begin{tikzcd}
F 
&
F'
\\
X \da \spec A' \cross_{\spec A} X
  \ar[r] 
  \ar[d]
& 
X'
  \ar[d] 
\\
\spec A
  \arrow[ur, phantom, "\scalebox{1.5}{$\ulcorner$}" , very near start, color=black]
  \ar[r]
& 
\spec A'
\end{tikzcd}

:::

### Sketch Proof of Lemma

Take the first exact sequence and tensor with $F'$ (which is right-exact), then $J \tensor_{A'} F' = J \tensor_A$ canonically.
This follows because $J = J \tensor_{A'} A$, and there is an isomorphism $J \tensor_{A'} A' \to J \tensor_{A'} A$.
And $F = F' \tensor_{A'} A$ is a pullback of $F'$.
If flat, then tensoring is exact.
Note that both conditions in the lemma are necessary since pullbacks of flats are flat by (1), and (2) gives the flatness condition.


:::{.definition title="Flat Modules"}
Recall that for a module over a Noetherian ring, $M/A$, $M$ is **flat** over $A$ iff 
\[
\tor_1^A(M, A/p) = 0 && 
\text{ for all primes } p
.\]
:::


:::{.remark}
Reason: Tor commutes with direct limits, so $M$ is flat iff 

\[
\Tor_1^A(M, N) = 0
&& \text{for all finitely generated } N
.\]

:::


Since $A$ is Noetherian, $N$ has a finite filtration $N^\cdot$ where $N_i / N_{i+1} \cong A/p_i$.
Use the fact that every ideal is contained in a prime ideal.
Take $x\in N$, this yields a map $A\to N$ which factors through $A/I$.
If we make such a filtration on $A/I$, then we can quotient $N$ by $\im f$ where $f: A/I \to N$.
Continuing inductively, the resulting filtration must stabilize.
So we can assume $N = A/I$.
Then $I$ is contained in a maximal.


:::{.exercise title="?"}
Finish proof.
See Aatiyah Macdonald.
:::

### Proof of Proposition


:::{.proof title="of proposition, given lemma"}
So it's enough to show that $\tor_1^{A'}(F', A'/p') = 0$ for all primes $p' \subset A'$.


:::{.observation}
Since $J$ is nilpotent, $J \subset p'$.
:::


## Consequences of Proof

Let $p = p'/J$, this is a prime ideal.
We have an exact diagram by taking quotients:

\begin{tikzcd}
             &  &              &  & 0 \arrow[dd]             &  & 0 \arrow[dd]            &  &   \\
             &  &              &  &                          &  &                         &  &   \\
0 \arrow[rr] &  & J \arrow[rr] &  & p' \arrow[rr] \arrow[dd] &  & p \arrow[rr] \arrow[dd] &  & 0 \\
             &  &              &  &                          &  &                         &  &   \\
0 \arrow[rr] &  & J \arrow[rr] &  & A' \arrow[rr] \arrow[dd] &  & A \arrow[rr] \arrow[dd] &  & 0 \\
             &  &              &  &                          &  &                         &  &   \\
             &  &              &  & A'/p' \arrow[dd]         &  & A/p \arrow[dd]          &  &   \\
             &  &              &  &                          &  &                         &  &   \\
             &  &              &  & 0                        &  & 0                       &  &
\end{tikzcd}

So we can tensor with $F'$ everywhere, and get a map from kernels to cokernels using the snake lemma:

\begin{tikzcd}
             &  &                                                                  &  & 0 \arrow[dd]                                     &  & {\tor(A, F) = 0} \arrow[dd]             &  &   \\
             &  &                                                                  &  &                                                  &  &                                         &  &   \\
             &  & 0 \arrow[rr, "\text{snake}"] \arrow[dd]                          &  & {\tor_1^{A_1}(A'/p', F')} \arrow[dd]             &  & {\tor_1^{A_1}(A/p, F')} \arrow[dd]      &  &   \\
             &  &                                                                  &  &                                                  &  &                                         &  &   \\
0 \arrow[rr] &  & J \tensor_{A'} F' \arrow[rr, "\text{by commuting square}", hook] &  & p' \tensor_{A'} F' \arrow[rr] \arrow[dd]         &  & p \tensor_{A'} F' \arrow[rr] \arrow[dd] &  & 0 \\
             &  &                                                                  &  &                                                  &  &                                         &  &   \\
0 \arrow[rr] &  & J \tensor_{A'} F' \arrow[rr, "\text{by (2)}"', hook]             &  & A' \tensor_{A'} F' \arrow[rr] \arrow[dd]         &  & A \tensor_{A'} F' \arrow[rr] \arrow[dd] &  & 0 \\
             &  &                                                                  &  &                                                  &  &                                         &  &   \\
             &  & 0 \arrow[rr, "\text{snake}"]                                     &  & A'/p' \tensor_{A'} F' \arrow[dd] \arrow[rr, "="] &  & A/p \tensor_{A'} F' \arrow[dd]          &  &   \\
             &  &                                                                  &  &                                                  &  &                                         &  &   \\
             &  &                                                                  &  & 0                                                &  & 0                                       &  &
\end{tikzcd}

Then by (1), we have
\[
\tor_1^{A'}(A'/p', F') = \tor_1^{A'}(A/p, F') = 0
.\]
:::


We will just need this for $A' = k[\eps]$ and $A=k$.


:::{.proposition title="?"}
\[
T_z \hilb_{X_{_{/k}}} = \hom_{\OO_x}(I_z, \OO_z)
.\]
:::


:::{.proof title="?"}
Again we have $T_z \hilb_{X_{_{/k}}} \subset \hilb_{X_{_{/k}}}(k[\eps])$, and is given by
$$
\theset{Z' \subset X \cross_{\spec k} \spec k[\eps] 
\st Z' \text{ is flat}_{/k[\eps]},\,\, Z' \cross_{\spec k[\eps]}\spec k = Z}
.$$

We have an exact diagram:


\begin{tikzcd}
              &  & 0 \arrow[r]  & I_{Z'} \arrow[r]           & {\OO_{X[\eps]}} \arrow[r]                               & \OO_{Z'} \arrow[r]           & 0  \\
0 \arrow[d]         &  &              & {} \arrow[d]               & {} \arrow[d]                                            & {} \arrow[d]                 &    \\
k \arrow[d]         &  & {} \arrow[r] & I_Z \arrow[r] \arrow[d]    & \OO_x \arrow[r] \arrow[d]                               & \OO_z \arrow[r] \arrow[d]    & {} \\
{k[\eps]} \arrow[d] &  & {} \arrow[r] & I_{Z'} \arrow[r] \arrow[d] & {\OO_{x[\eps]}} \arrow[r] \arrow[d]                     & \OO_{Z'} \arrow[r] \arrow[d] & {} \\
k \arrow[d]         &  & {} \arrow[r] & I_Z \arrow[r] \arrow[d]    & \OO_x \arrow[r] \arrow[d] \arrow[u, dotted, bend right] & \OO_Z \arrow[r] \arrow[d]    & {} \\
0                   &  &              & {}                         & {}                                                      & {}                           &
\end{tikzcd}


Note the existence of a splitting above.
Given $\phi \in \hom_{\OO_x}(I_Z, \OO_Z)$.
We have
\[
I_{Z'} = \left\{
f + \eps g \,
\middle\vert
\,
\begin{array}{ll}
f,g &\in I_Z, \\
\phi(f) &= g\mod I_Z, \\
\phi(f) &\in \OO_Z, \\
g\mod I_Z &\in \OO_x/I_Z = \OO_Z
\end{array}
\right\}
.\]

It's easy to see that $Z' \subset x'$, and

1. $Z'\cross k = Z$
2. It's flat over $k[\eps]$, looking at $0 \to k\tensor I_{Z'} \to I_{Z'}$.

For the converse, take $f\in I_Z$ and lift to $f' = f + \eps g \in I_{Z'}$, then $g\in \OO_x$ is well-defined wrt $I_Z$.
Then $g\in \hom_{\OO_x}(I_z, \OO_z)$.
:::
  
The main point here is that these hom sets are extremely computable.

:::{.example title="?"}
Let $Z$ be a twisted cubic in $\hilb_{\PP^3_{/k}}^{3t+1}(k)$.
:::

:::{.observation}
\[
\hom_{\OO_x}(I_Z, \OO_Z) = \hom_{\OO_X}(I_Z/I_Z^2, \OO_Z) = \hom_{\OO_Z}(I_Z/I_Z^2, \OO_Z)
\]
:::
  
If $I_Z/I_Z^2$ is locally free, these are global sections of the dual, i.e. $H^0((I_Z/I_Z^2)\dual)$.
In this case, $Z\injects X$ is regularly embedded, and thus $(I_Z/I_Z^2)\dual$ should be regarded as the normal bundle.
Sections of the normal bundle match up with directions to take first-order deformations:


\begin{tikzpicture}
\definecolor{arrow_color}{HTML}{ba0cff}
\node (node_one) at (0,0) {
\includegraphics{/home/zack/SparkleShare/github.com/Notes/Class_Notes/2020/Spring/Moduli Spaces/sections/figures/2021-01-03_22-40}
};

\node (a) at (-7, 5) {\Huge $\PP^3$};
\node[arrow_color] (a) at (1, -3) {\Huge Deformation};
\end{tikzpicture}

For $i:C \injects \PP^3$, there is an exact sequence
\[
0 \to I/I^2 \to &i^* \Omega_{\PP^3} \to \Omega_\eps \to 0 \\
&\Downarrow \quad \text{ taking duals } \\
0 \to T_C \to &i^* T_{\PP^3} \to N_{C_{/\PP^3} } \to 0
,\]
How do we compute $T_{\PP^3}$? Fit into the exact sequence
$$
0 \to \OO \to i^* \OO(1)^4 \to i^* T_{\PP^3} \to 0
,$$ which we can restrict to $C$.

We have $i^* \OO(1) \cong \OO_{\PP^1}(3)$, so
\[
0 \to H^0 \OO_c \to &H^*(\OO(3)^4) \to H^0(i^* T_{\PP^3}) \to 0 \\
&\Downarrow \\
0\to k \to &k^{16} \to k^{15} \to 0
.\]

This yields
\[
0 \to H^0(T_c) \to &H^0(i^* T_{\PP^3}) \to H^0(N_{C_{ /\PP^3} }) \to H^1 T_c \\
&\Downarrow \\
0\to k^3 \to &k^{15} \to k^{12} \to 0
\]

:::{.example title="?"}
$\hilb_{\PP^n_k}^{P_?} \cong \PP H^0(\PP^n, \OO(d))\dual$ which has dimension ${n+1 \choose n} - 1$.
Pick $Z$ a $k$ point in this Hilbert scheme, then $T_Z H = \hom(I_Z, \OO_Z)$.
Since $I_Z \cong \OO_{\PP}(-d)$ which fits into
\[
0 \to \OO_{\PP^n}(-d) \to \OO_{\PP^n} \to \OO_Z \to 0
.\]


We can identify
\[
\hom(I_Z,\OO_Z) = H^0( (I_Z/I_Z^2)\dual  ) = H^0(\OO_Z(d))
.\]


\begin{tikzcd}
0\ar[r] & \OO_{\PP^n}\ar[r]  & \OO_{\PP^n}(d)\ar[r]     & \OO_Z(d)\ar[r]              & 0 \\
  &             &                   &                      &   \\
0\ar[r]  & H^0( \OO_{\PP^n}  ) \ar[r]  & H^0( \OO_{\PP^n}(d)  ) \ar[r]        & H^0(\OO_Z(d)  ) \ar[r]            & 0 \\
\text{dim:} & k           & k^{n+d \choose n} & k^{{n+d\choose n}-1} &
\end{tikzcd}
:::
  


:::{.example title="?"}
The tangent space of the following cubic:

\begin{tikzpicture}
\node (node_one) at (0,0) {
\includegraphics{/home/zack/SparkleShare/github.com/Notes/Class_Notes/2020/Spring/Moduli Spaces/sections/figures/2021-01-03_17-27}
};
\end{tikzpicture}

We can identify
\[
\hom_{\OO_k}(I_Z, \OO_Z) = H^0((I_Z/I_Z^2)\dual) = 3 + H^0((I_{Z_0}/I_{Z_0}^2)\dual)
,\]

where the latter equals $H^0 \qty{ \OO_1\mid_{z_0} \oplus \OO(\zeta)\mid_{z_0} }$ yielding
\[
3+9 = 12
.\]
:::


# Uniform Vanishing Statements (Thursday January 30th)

Recall how we constructed the Hilbert scheme of hypersurfaces
$$
\hilb_{\PP_k^n}^{P_{m, d}} = \PP H^0(\PP^n; \OO(d))\dual
$$
A section $\hilb_{\PP_k^n}^{P}(s)$ corresponds to $z\in \PP^n_s$.
We can look at the exact sequence

\[
0 \to I_Z(m) \to \OO_{\PP_S^n} \mapsvia{\text{restrict}} \OO_z(m) \to 0
.\]

as $\PP_s^n \mapsvia{\pi_s} S$, so we can pushforward along $\pi$, which is left-exact, so

\[
0 \to \pi_{s*} I_Z(m) \to \pi_{s*} \OO_{\PP_S^n}  = \OO_S \tensor H^0(\PP^n; \OO(m)) \to \OO_z(m) \to R^1 \pi_{s*} I_Z(m) \to \cdots
.\]

*Idea:*
$Z \subset \PP_k^n$ will be determined (in families!) by the space of degree $d$ polynomials vanishing on $Z$ (?), i.e.
$$
H^0(\PP^n, I_z(m)) \subset H^0(\PP^n, \OO(m))
$$
for $m$ very large.
This would give a map of functors
$$
\hilb_{\PP_k^n}^{P} \to \Gr(N, H^0(\PP^n, \OO(m) ))
.$$
If this is a closed subfunctor, a closed subfunctor of a representable functor is representable and we're done
.


:::{.remark}
We need to get an $m$ uniform in $Z$, and more concretely:

1. First need to make sense of what it means for $Z$ to be determined by $H^0(\PP^n, I_Z(m))$ for $m$ only depending on $P$.

2. This works point by point, but we need to do this in families.
  I.e. we'll use the previous exact sequence, and want the $R^1$ to vanish.
:::

:::{.slogan}
We need *uniform* vanishing statements.
There is a convenient way to package the vanishing requirements needed here.
From now on, take $k=\bar k$ and $\PP^n = \PP_k^n$.
:::

## $m\dash$Regularity

:::{.definition title="m-Regularity of Coherent Sheaves"}
A coherent sheaf $F$ on $\PP^n$ is **$m\dash$regular** if $H^i(\PP^n; F(m-i)) = 0$ for all $i> 0$.
:::



:::{.example title="?"}
Consider $\OO_{\PP^n}$, this is $0\dash$regular.
Line bundles on $\PP_n$ only have 0 and top cohomology.
Just need to check that $H^n(\PP^n; \OO(-n)) = 0$, but by Serre duality this is
\[
H^0(\PP^n; \OO(n) \tensor \omega_{\PP^n})\dual = H^0(\PP^n; \OO(-1))\dual = 0
.\]
:::



:::{.proposition title="?"}
Assume $F$ is $m\dash$regular.
Then

1. There is a natural multiplication map from linear forms on $\PP^n$,
 \[
  H^0(\PP^n; \OO(1)) \tensor H^0(\PP^n; F(k)) \to H^0(\PP^n; F(k+1))
  ,\]
  which is surjective for $k\geq n$.[^graded_module_note]

2. $F$ is $m'\dash$regular for $m' \geq m$.

3. $F(k)$ is globally generated for $k\geq m$, i.e. the restriction
  \[
  H^0(\PP^n; F(k)) \tensor \OO_{\PP^n} \to F(k) \to 0
  \]
  is exact (i.e. surjective).

[^graded_module_note]: 
Think of this as a graded module, this tells you the lowest number of small grade pieces needed to determine the entire thing.

:::

:::{.example title="?"}
$\OO$ is $m\dash$regular for $m \geq 0$ implies $\OO(k)$ is $-k\dash$regular and is also $m\dash$regular for$m\geq -k$.
:::

### Proof of 2 and 3

Induction on dimension of $n$ in $\PP^n$.
Coherent sheaves on $\PP^0$ are vector spaces, so no higher cohomology.

:::{.proof title="Step 1"}
Take a generic hyperplane $H \subset \PP^n$, there is an exact sequence
\[
0 \to \OO(-1) \to \OO \to \OO_H \to 0
.\]

where $\OO_H$ is the structure sheaf.
Tensoring with $H$ remains exact, so we get
\[
0 \to F(-1) \to F \to F_H \to 0
.\]

Why? $\AA^n \subset \PP^n$, let $A = \OO_{\PP^n}(\AA^n)$ be the polynomial ring over $\AA^n$.
Then the restriction of the first sequence to $\AA^n$ yields
$$
0 \to A \mapsvia{f} A \to A/f \to 0
,$$
and thus we want
$$
F \mapsvia{f} F \to F/fF \to 0
$$
which results after restricting the second sequence to $\AA^n$.
Thus we just want $f$ to not be a zero divisor.
If we take $f$ not vanishing on any associated point of $F$, then this will be exact.
Associated points: generic points arising by supports of sections of $F$.
$F$ is coherent, so it has finitely many associated points.
If $H$ does not contain any of the associated points of $F$, then the second sequence is indeed exact.
:::


:::{.proof title="Step 2"}
Twist up by $k$ to obtain
\[
0 \to F(k-1) \to F(k) \to F_H(k) \to 0
.\]
Look at the LES in cohomology to get
\[
H^i(F(m-i)) \to H^i(F_H(m-i)) \to H^{i+1}(F(m - (i+1)))
.\]
So $F_H$ is $m\dash$regular.
By induction, this proves statements 1 and 2 for all $F_H$.
So take $k = m+1-i$ and consider
\[
H^i(F(m-i)) \to H^i(F(m+1-i)) \to H^i(F_H(m+1-i))
.\]
We know 2 is satisfied, so the RHS is zero, and we know the LHS is zero, so the middle term is zero.
Thus $F$ itself is $m+1$ regular, and by inducting on $m$ we get statement 2.
:::


By multiplication maps, we get a commutative diagram:

\begin{tikzcd}
                                                        &  & H^0(\OO(1)) \tensor H^0(F(k)) \arrow[dd, "\beta"] \arrow[rrr] \arrow[rrrdd] &  &  & H^0(\OO(1))\tensor H^0(F_H(k)) \arrow[dd] \\
                                                        &  &                                                                             &  &  &                                           \\
H^0(F(k)) \arrow[rr, "H"] \arrow[rruu, "H \tensor \id"] &  & H^0(F(k+1)) \arrow[rrr, "\alpha", dashed]                                   &  &  & H^0(F_H(k+1))
\end{tikzcd}

We'd like to show the diagonal map is surjective.


:::{.observation}
\envlist

1. The top map is a surjection, since
$$
H^0(F(k)) \to H^0(F_H(k)) \to H^1(F(k-1)) = 0
$$
for $k\geq m$ by (2).

2. The right-hand map is surjective for $k\geq m$.

3. $\ker(\alpha) \subset \im(\beta)$ by a small diagram chase, so $\beta$ is surjective.

This shows (1) and (2) completely.

:::


:::{.proof title="of 3"}
We know $F(k)$ is globally generated for $k\gg 0$.
Thus for all $k\geq m$, $F(k)$ is globally generated by (1).
:::


:::{.theorem title="?"}
Let $P \in \QQ[t]$ be a Hilbert polynomial.
There exists an $m_0$ only depending on $P$ such that for all subschemes $Z \subset \PP^n_k$ with Hilbert polynomial $P_Z = P$, the ideal sheaf $I_z$ is $m_0\dash$regular.
:::
  

### Proof of Theorem

Induct on $n$.
For $n=0$, again clear because higher cohomology vanishes and there are no nontrivial subschemes.
For a fixed $Z$, pick $H$ in $\PP^n$ (and setting $I \definedas I_z$ for notation) such that
\[
0 \to I(-1) \to I \to I_H \to 0
.\]
is exact.
Note that the Hilbert polynomial $P_{I_H}(t) = P_I(t) - P_I(t-1)$ and $P_I = P_{\OO_{\PP^n}} - P_Z$.
By induction, there exists some $m_1$ depending only on $P$ such that $I_H$ is $m_1\dash$regular.
We get
\[
H^{i-1}(I_H(k)) \to H^i(I(k-1)) \to H^i(I(k)) \to H^i(I_H(k))
,\]
and for $k\geq m_1 - i$ the LHS and RHS vanish so we get an isomorphism in the middle.
By Serre vanishing, for $k \gg 0$ we have $H^i(I(k)) = 0$ and thus $H^i(I(k)) = 0$ for $k\geq m_i - i$.
This works for all $i > 1$, we have $H^i(I(m_i - i)) = 0$.
We now need to find $m_0 \geq m_1$ such that $H^1(I(m_0 - 1)) = 0$ (trickiest part of the proof).


:::{.lemma title="?"}
The sequence $\qty{\dim H^1(I(k))}_{k\geq m_i - 1}$ is *strictly* decreasing.[^explain_little_h]

[^explain_little_h]: 
Note: $h^1 = \dim H^1$.

:::


:::{.remark}
Given the lemma, it's enough to take $m_0 \geq m_1 + h^1(I(m_1 - 1))$.
Consider the LES we have a surjection
$$
H^0(\OO_Z(m_1 - 1)) \to H^1(I(m_1 - 1)) \to 0
.$$
So the dimension of the LHS is equal to $P_Z(m_1 - 1)$, using the fact that terms vanish and make the Euler characteristic equal to $P_Z$.
Thus we can take $m_0 = m_1 + P(m_1 - 1)$.
:::


:::{.proof title="of Lemma"}
Considering the LES
\[
H^0(I(k+1)) \mapsvia{\alpha_{k+1}} H^0(I_H(k+1)) \to H^1(I(k)) \to H^1(I(k+1)) \to 0
,\]
where the last term is zero because $I_H$ is $m_1\dash$regular.
So the sequence $h^1(I(k))$ is non-increasing.

:::{.observation}
If it does *not* strictly decrease for some $k$, then there is an equality on the RHS, which makes $\alpha_{k+1}$ surjective.
This means that $\alpha_{k+2}$ is surjective, since
\[
H^0(\OO(1)) \tensor H^0(I_H(k+1)) \surjects H^0(I_H(k+2))
.\]

:::
  
So if one is surjective, everything above it is surjective, but by Serre vanishing we eventually get zeros.
So $\alpha_{k+i}$ is surjective for all $i\geq 1$, contradicting Serre vanishing, since the RHS are isomorphisms for all $k$.
:::


Thus for any $Z\subset \PP^n_k$ with $P_Z = P$, we uniformly know that $I_Z$ is $m_0\dash$regular for some $m_0$ depending only on $P$.


:::{.claim}
$Z$ is determined by the degree $m_0$ polynomials vanishing on $Z$, i.e. $H^0(I_z(m_0))$ as a subspace of all degree $m_0$ polynomials $H^0(\OO(m_0))$ and has fixed dimension.
We have $H^i(I_Z(m_0)) = 0$ for all $i> 0$, and in particular $h^0(I_Z(m_0)) = P(m_0)$ is constant.
:::
  
It is determined by these polynomials because we have a sequence
\[
0 \to I_Z(m_0) \to \OO(m_0) \to \OO_Z(m_0) \to 0
.\]

We can get a commuting diagram over it
$$
0 \to H^0(I_Z(m_0)) \tensor \OO_{\PP^n} \to H^0(\OO(m_0)) \tensor \OO_{\PP^n} \to \cdots
$$
where the middle map down is just evaluation and.the first map down is a surjection.
Hence $I_Z(m_0)$, hence $\OO_Z$, hence $Z$ is determined by $H^0(I_Z(m_0))$.

> Next time: we'll show that this is a subfunctor that is locally closed.

# Thursday February 6th

> Review base-change!

For $k=\bar k$, and $C_{/k}$ a smooth projective curve, then $\hilb_{C_{/k}}^n = \sym^n C$.

:::{.definition title="The Hilbert-Chow Map"}
For $X_{_{/k}}$ a smooth projective  *surface*, $\hilb_{X_{_{/k}}}^n \neq \sym^n X$, there is a map (the Hilbert-Chow map)
\[
\hilb_{X_{_{/k}}}^n &\to \sym^n X \\
Z &\mapsto \supp(Z) \\
U  = \text{reduced subschemes} &\mapsto U' = \text{ reduced multisets } \\
\PP^1 &\mapsto (x, x)
.\]
:::

:::{.example title="?"}
Consider $\AA^2 \cross \AA^2$ under the $\ZZ/2\ZZ$ action
\[
( (x_1, y_1), (x_2, y_2)) \mapsto ((x_2, y_2), (x_1, y_1))
.\]


Then
\[
(\AA^2)^2 / \ZZ/2\ZZ
&= \spec k[x_1, y_1, x_2, y_2]^{\ZZ/2\ZZ} \\
&= \spec k[x_1 x_2, y_1 y_2, x_1 + x_2, y_1 + y_2, x_1 y_2 + x_2 y_1, \cdots]
\]
with a bunch of symmetric polynomials adjoined.
:::

:::{.example title="?"}
Take $\AA^2$ and consider $\hilb_{\PP^2}^3$.
If $I$ is a monomial ideal in $\AA^2$, there is a nice picture.
We can identify the tangent space
\[
T_Z \hilb_{\PP^2}^n = \hom_{\OO_{\PP^2}} ( I_2, \OO_Z) = \bigoplus \hom(I_{Z_i}, \OO_{Z_i})
.\]
if $Z = \disjoint Z_i$.
If $I$ is supported at 0, then we can identify the ideal with the generators it leaves out.
:::


:::{.example title="?"}
$I = (x^2, xy, y^2)$:

![Image](figures/2020-02-06-12:48.png){width=350px}
:::


:::{.example title="?"}
$I = (x^6, x^2y^2, xy^4, y^5)$:

![Image](figures/2020-02-06-12:49.png){width=350px}
:::



:::{.example title="?"}
$I = (x^2, y)$.
Let $e=x^2, f = y$.

![Image](figures/2020-02-06-12:54.png){width=350px}

By comparing rows to columns, we obtain a relation $ye = x^2 f$.
Write $\OO = \theset{1, x}$, then note that this relation is trivial in $\OO$ since $y=x^2=0$.
Thus $\hom(I, \OO) = \hom(k^2, k^2)$ is 4-dimensional.
:::



:::{.remark}
Note that $C_{_{/k}}$ for curves is an important case to know.
Take $Z \subset C \cross C^n$, then quotient by the symmetric group $S^n$ (need to show this can be done), then $Z/S^n \subset C \cross \sym^n C$ and composing with the functor $\hilb$ represents yields a map $\sym^n C \to \hilb_{C_{/k}}^n$.
This is bijective on points, and a tangent space computation shows it's an isomorphism.
:::


:::{.example title="?"}
Consider the nodal cubic in $\PP^2$:

![Nodal cubic](figures/2020-02-06-13:01.png){width=350px}

> The nodal cubic $zy^2 = x^2(x+z)$.

Consider the open subscheme $V \subset \hilb_{C_{/k}}^2$ of points $z \subset U$ for $U \subset C$ open.
We can normalize:

![Normalized cubic](figures/2020-02-06-13:03.png){width=350px}

This yields a map fro $\PP^1 \setminus\text{2 points}$.
This gives us a stratification, i.e. a locally closed embedding
\[
(\text{z supported on U}) \disjoint (\text{1 point at p}) \disjoint (\text{both points at p}) \to \hilb_{C_{/k}}^2
.\]

The first locus is given by the complement of two lines:

![Locus 1](figures/2020-02-06-13:08.png){width=350px}

The third locus is given by arrows at $p$ pointing in any direction, which gives a copy of $\PP^1$.
The second is $\PP^1$ minus two points.
Above each point is a nodal cubic with two marked points, and moving the base point towards a line correspond to moving one of the points toward the node:

![Moving base toward the point](figures/2020-02-06-13:11.png){width=350px}

More precisely, we're considering the cover $\PP^1 \setminus\text{2 points} \to C$ and thinking about ways in which two points and approach the missing points.
These give specific tangent directions at the node on the cubic, depending on how this approach happens -- either both points approach missing point #1, both approach missing point #2, or each approach a separate missing point.
:::

:::{.remark}
Useful example to think about. Not normal, reduced, but glued in a weird way.
Possibly easier to think about: cuspidal cubic.
:::
  

## Representability


Recall the following definition:

:::{.definition title="$m\dash$Regularity"}
A coherent sheaf $F$ on $\PP_k^n$ for $k$ a field is $m\dash$regular iff $H^i(F(m-i)) = 0$ for all $i> 0$.
:::


:::{.proposition title="?"}
For every Hilbert polynomial $P$, there exists some $m_0$ depending on $P$  such that any $Z \subset \PP^n_k$ with $P_Z = P$ satisfies $I_Z$ is $m\dash$regular.
:::
  


:::{.remark title="1"}
$F$ is $m\dash$ regular iff $\bar F = F \cross_{\spec k} \spec \bar k$ is $m\dash$regular.
:::


:::{.remark title="2"}
The $m_0$ produced does not depend on $k$.
:::



:::{.lemma title="?"}
For $m_0 = m_0(P)$ and $N = N(P)$, we have an embedding as a subfunctor
\[
\hilb_{\PP^m_\ZZ}^P \to \Gr(N, H^0( \PP^n_\ZZ, \OO(m_0)  )\dual )
.\]
:::

For any $Z \subset \PP^n_S$ flat over $S$ with $P_{Z_s} = P$ for all $s\in S$ points, we want to send this to
$$
0\to R\dual \to \OO_s \tensor H^0(\PP^n_\ZZ, \OO(m_0))\dual \to Q \to 0
$$
or equivalently
$$
0 \to Q\dual \to \OO_s \tensor H^0(\PP^n_\ZZ, \OO(m_0)) \to R \to 0
$$
with $R$ locally free.


So instead of the quotient $Q$ being locally free, we can ask for the sub $Q\dual$ to be locally free instead, which is a weaker condition.

We thus send $Z$ to
$$
0 \to \pi_{s*} I_Z(m_0) \to \pi_{s*} \OO_{\PP^n_s}(m_0) = \OO_s \tensor H^0(\PP^n, \OO(m_0))
$$
which we obtain by taking the pushforward from this square:


\begin{tikzcd}
\PP^n_s \arrow[dd, "\pi_s"] \arrow[rr] &  & \PP^n_Z \arrow[dd] \\
                                &  &                    \\
S \arrow[rr]                           &  & \spec \ZZ
\end{tikzcd}

We have a sequence $0 \to I_Z(m_0) \to \OO(m_0) \to \OO_Z(m_0) \to 0$.
Thus we get a sequence

\[
0 \to \pi_{s*}I_Z(m_0) \to \pi_{s*}\OO(m_o) \to \pi_{s*} \OO_Z(m_0) \to R^1 \pi_{s*}I_Z(m_0) \to \cdots
.\]

### Step 1

\[
R^1\pi_* I_Z(m_0) = 0
.\]

By base change, it's enough to show that $H^1(Z_s, I_{Z_s}(m_0)) = 0$.
This follows by $m_0\dash$regularity.

### Step 2

$\pi_{s*}I_Z(m_0)$ and $\pi_{s*} \OO_Z(m_0)$ are locally free.
For all $i>0$, we have

- $R^i \pi_{s*} I_Z(m_0) = 0$ by $m_0\dash$regularity,
- $R^i \pi_{s*} \OO(m_0) = 0$ by base change,
- and thus $R^i \pi_{s*} \OO_Z(m_0) = 0$.

### Step 3

$\pi_{s*}I_Z(m_0)$ has rank $N = N(P)$.

Again by base change, there is a map $\pi_* I_Z(m_0) \tensor k(s) \to H^0(Z_S, I_{Z_s}(m_0))$ which we know is an isomorphism.
Because $h^i ( I_{Z_S}(m_0) ) = 0$ for $i>0$ by $m\dash$regularity and
\[
h^0(I_{Z_S}(m_0)) = P_\OO(m_0) - P_{\OO_{Z_s}}(m_0) = P_\OO (m_0) - P(m_0)
.\]

This yields a well-defined functor 
\[
\hilb_{\PP^n_\ZZ}^P \to \Gr(N, H^0(\PP^n, \OO(m_0))\dual )
.\]

:::{.remark}
Note that we've just said what happens to objects; strictly speaking we should define what happens for morphisms, but they're always give by pullback.
:::

We want to show injectivity, i.e. that we can recover $Z$ from the data of a number f polynomials vanishing on it, which is the data $0 \to \pi_{s*} I_Z(m_0) \to \OO_s \tensor H^0(\PP^n, \OO(m_0))$.

Given
$$
0 \to Q\dual \to \OO_s \tensor H^0(\PP^n, \OO(m_0)) = \pi_{s*} \OO_{\PP^n_S}(m_0)
$$
we get a diagram


\begin{tikzcd}
\pi_{s}^* Q\dual \arrow[rrdd] \arrow[rrr] &  &                          & \OO_{\PP^n_s}(m_0) \\
                                  &  &                          &                    \\
                                  &  & I(m_0) \arrow[ruu, hook] &
\end{tikzcd}


where $Q\dual = \pi_{s*} I_Z(m_0)$, so we're looking at

\begin{tikzcd}
Q\dual = \pi_{s*}^* \pi_{s*} I_Z(m_0) 
  \arrow[rrdd, twoheadrightarrow] 
  \arrow[rrr] 
&  
&                          
& \OO_{\PP^n_s}(m_0) 
\\
&  
&                          
&                    
\\
&  
& I(m_0) 
  \arrow[ruu, hook] 
&
\end{tikzcd}

The surjectivity here follows from $\OO_{Z_s} \tensor H^0(I_{Z_s}(m_0)) \to I_{Z_s}(m_0)$ (?).
Given a universal family $G = \Gr( N, H^0(\OO(m_0))\dual )$ and $Q\dual \subset \OO_G \tensor H^0(\OO(m_0))\dual$, we obtain $I_W \subset \OO_G$ and $W \subset \PP^n_G$.

# Tuesday February 18th


:::{.theorem title="?"}
Let $X/S$ be a projective subscheme (i.e. $X\subset \PP^n$ for some $n$).
The Hilbert functor of flat families $\hilb_{X/S}^p$ is representable by a projective $S\dash$scheme.
:::


:::{.remark}
Note that without a fixed $P$, this is *locally* of finite type but not finite type.
After fixing $P$, it becomes finite type.
:::


:::{.example title="?"}
For a curve of genus $g$, there is a smooth family $\mcc \mapsvia{\pi} S$ with $S$ finite-type over $\ZZ$ where every genus $g$ curve appears as a fiber.
I.e., genus $g$ curves form a *bounded family* (here there are only finitely many algebraic parameters to specify a curve).
How did we construct? Take the third power of the canonical bundle and show it's very ample, so it embeds into some projective space and has a Hilbert polynomial.
:::
  
In fact, there is a finite type *moduli stack* $\mcm_g / \ZZ$ of genus $g$ curves.
There will be a map $S \surjects \mcm_g$, noting that $\mcc$ is not a moduli space since it may have redundancy.
We'll use the fact that a finite-type scheme surjects onto $\mcm_g$ to show it is finite type.

:::{.remark}
If $X/S$ is proper, we can't talk about the Hilbert polynomial, but the functor $\hilb_{X/S}$ is still representable by a locally finite-type scheme with connected components which are proper over $S$.
:::


:::{.remark}
If $X/S$ is *quasiprojective* (so locally closed, i.e. $X\injects \PP^n_S$), then $\hilb_{X/S}^P(T) \definedas \theset{z\in X_T \text{ projective, flat over S with fiberwise Hilbert polynomial P }}$ is still representable, but now by a quasiprojective scheme.
:::


:::{.example title="?"}
Length $Z$ subschemes of $\AA^1$: representable by $\AA^2$.

![Image](figures/2020-02-18-12:46.png)\

Upstairs: parametrizing length 1 subschemes, i.e. points.
:::
  


:::{.remark}
If $X\subset \PP_S^n$ and $E$ is a coherent sheaf on $X$, then
\[
\Quot_{E, X/S}^{P}(T) = \theset{ j^*E \to F \to 0, \text{ over } X_T \to T,~F \text{ flat with fiberwise Hilbert polynomial  } P  }
\]
where $T \mapsvia{g} S$ is representable by an $S\dash$projective scheme.
:::
    


:::{.example title="?"}
Take $E = \OO_x$, $X$ and $S$ a point, and $E$ is a vector space, then $\Quot_{E/S}^P = \Gr(\rank, E)$.
:::


:::{.warnings}
The Hilbert scheme of 2 points on a surface is more complicated than just the symmetric product.
:::


:::{.example title="?"}
\[
\qty{\AA^2}^3 &\to \qty{\AA^2}^2 \\
\supseteq \Delta\definedas \Delta_{01} \cross \Delta_{02} &\to \qty{\AA^2}^2
\]

where $\Delta_{ij}$ denote the diagonals on the $i, j$ factors.
Here all associate points of $\Delta$ dominate the image, but it is not flat.
Note that if we take the complement of the diagonal in the image, then the restriction $\Delta' \to \qty{\AA^2}^2\setminus D$ is in fact flat.
:::

    

:::{.example title="Mumford"}
The Hilbert scheme may have nontrivial scheme structure, i.e. this will be a "nice" Hilbert scheme with is generally not reduced.
We will find a component $H$ of a $\hilb_{\PP^3_C}^P$ whose generic point corresponds to a smooth irreducible $C\subset \PP^3$ which is generically non-reduced.
:::

## Cubic Surfaces

> See Hartshorne Chapter 5.

Let $X\subset \PP^3$ be a smooth cubic surface, then $\OO(1)$ on $\PP^3$ restricts to a divisor class $H$ of a hyperplane section, i.e. the associated line bundle $\OO_x(H) = \OO_x(1)$.

:::{.fact title="Important fact 1"}
$X$ is the blowup of $\PP^2$ minus 6 points (replace each point with a curve).
There is thus a blowdown map $X \mapsvia{\pi} \PP^2$.

![Image](figures/2020-02-18-13:07.png)

Let $\ell = \pi^*(\text{line})$, then a fact is that $3\ell - E_1 -\cdots - E_6$ (where $E_i$ are the curves about the $p_i$) is very ample and embeds $X$ into $\PP^3$ as a cubic.
:::


:::{.fact title="Important fact 2"}
Every smooth cubic surface $X$ has *precisely* 27 lines.
Any 6 pairwise skew lines arise as $E_1, \cdots, E_6$ as in the previous construction.
:::

Take an $X$ and a line $L\subset X$.
Consider any $C$ in the linear system $\abs{4H + 2L}$.
Fact: $\OO(4H + 2L)$ is very ample, so embeds into a big projective space, and thus $C$ is smooth and irreducible by Bertini.
Then the Hilbert polynomial of $C$ is of the form $at + b$ where $b = \chi(\OO_c)$, the Euler characteristic of the structure sheaf of $C$, and $a = \deg C$.
So we'll compute these.
We have $\deg C = H \cdot C$ (intersection) $= H \cdot(4H + 2L) = 4H^2 + 2H\cdot L = 4\cdot 3 + 2 = 14$.
The intersections here correspond to taking hyperplane sections, intersecting with $X$ to get a curve, and counting intersection points:

![Image](figures/2020-02-18-13:14.png)\

In general, for $X$ a surface and $C\subset X$ a smooth curve, then $\omega_C = \omega_X(C)\mid_C$.
Since $X\subset \PP^3$, we have 
\[
\omega_X 
&= \omega_{\PP^3}(X) \mid_X \\
&= \OO(-4) \oplus \OO(3)\mid_X \\
&= \OO_X(-1) \\
&= \OO_X(-H)
.\]
We also have 
\[
\omega_C 
&= \omega_X(C)\mid_X  \\
&= \ro{ \qty{ \OO_X(-H) \oplus \OO_X(4H + 2L)}}{C} \\ \\
&\Downarrow \qquad \text{taking degrees} \\ \\
\deg \omega_C 
&= C\cdot(3H + 2L) \\
&= (4H+2L)(3H+2L) \\
&= 12H^2 + 14HL + 4L^2 \\
&= 36 + 14 + (-4) \\
&= 46
.\]
Since this equals $2g(C) - 2$, we can conclude that the genus is given by $g(C) = 24$.
Thus $P$ is given by $14t + (1-g) = 14t - 23$.


:::{.remark}
Good to know: moving a cubic surface moves the lines, you get a monodromy action, and the Weyl group of $E_6$ acts transitively so lines look the same.
:::


:::{.claim title="1"}
There is a flat family $Z\subset \PP^3_S$ with fiberwise Hilbert polynomial $P$ of cures of this form such that the image of the map $S \to \hilb_{\PP^3}^P$ has dimension 56.
:::


:::{.proof title="of claim"}
We can compute the dimension of the space of smooth cubic surfaces, since these live in $\PP H^0(\PP^3, \OO(3))$, which has dimension ${3+3\choose 3} -1 = 19$.
Since there are 27 lines, the dimension of the space of such cubics with a choices of a line is also 19.
Choose a general $C$ in the linear system $\abs{4H + 2L}$ will add $\dim \abs{4H + 2L} = \dim \PP H^0(x, \OO_x(C))$.
We have an exact sequence
\[
0 \to \OO_X \to \OO_X(C) \to \OO_C(C) \to 0 \\
H^0\qty{ 0 \to \OO_X \to \OO_X(C) \to \OO_C(C) \to 0 } \\
.\]

Since the first $H^0$ vanishes (?) we get an isomorphism.
By Riemann-Roch, we have
$$
\deg \OO_C(C) = C^2 = (4H+2L)^2 = 16H^2 + 16 HL + 4L^2 = 64 - 4 = 60
.$$

We can also compute $\chi(\OO_C(C)) = 60 - 23 = 37$.
We have
$$
h^0(\OO_C(C)) - h^1(\OO_C(C)) =  h^0(\OO_C(C)) - h^0(\omega_C(-C))) = 2(23) - 60 < 0
,$$
so there are no sections.

So $\dim \abs{4H + 2L} =  37$.
Thus letting $S$ be the space of cubic surfaces $X$, a line $L$, and a general $C \in \abs{4H + 2L}$, $\dim S = 56$.
We get a map $S \to \hilb_{\PP^3}^P$, and we need to check that the fibers are 0-dimensional (so there are no redundancies).
We then just need that every such $C$ lies on a unique cubic.
Why does this have to be the case?
If $C \subset X, X'$ then $C \subset X\intersect X'$ is degree 14 curve sitting inside a degree 6 curve, which can't happen.
Thus if $H$ is a component of $\hilb_{\PP^3}^P$ containing the image of $S$, the $\dim H \geq 56$.
:::


:::{.claim title="2"}
For any $C$ above, we have $\dim T_C H = 57$.
:::
  

When the subscheme is smooth, we have an identification with sections of the normal bundle $T_C H = H^0(C, N_{C/\PP^3})$.
There's an exact sequence

\[
0 \to N_{C/X} = \OO_C(C) \to N_{C/\PP^3} \to N_{X/\PP^3}\mid_C = \OO_C(x)\mid_C = \OO_C(3H)\mid_C \to 0
.\]

> Note $\omega_C = \OO_C(3H + 2L)$.

As we computed,
\[
H^0(\OO_C(C)) &= 37 \\
H^1(\OO_C(C)) &= 0
.\]

So we need to understand the right-hand term $H^0(\OO_C(3H))$.
By Serre duality, this equals $h^1(\omega_C(-3H)) = h^1(\OO_C(3L))$.
We get an exact sequence

\[
0 \to \OO_X(2L-C) \to \OO_X(2L) \to \OO_C(2L) \to 0
.\]

Taking homology, we have $0\to 0 \to 1 \to 1 \to 0$ since $2L-C = -4H$.
Computing degrees yields $h^0 (\OO_C(3H)) = 20$.
Thus the original exact sequence yields
\[
0 \to 37 \to ? \to 20 \to 0
,\]
so $? = 57$ and thus $\dim N_{C/\PP^3} = 57$.


:::{.claim title="3"}
\[
\dim H = 56
.\]
:::


### Proof That the Dimension is 56

Suppose otherwise.
Then we have a family over $H^\mathrm{red}$ of *smooth* curves, where $f(S) \subset H^\mathrm{red}$, where the generic element is not on a cubic or any lower degree surface.
Let $C'$ be a generic fiber.
Then $C'$ lies on a pencil of quartics, i.e. 2 linearly independent quartics.
Let $I = I_{C'}$ be the ideal of this curve in $\PP^3$, there is a SES
$$
0\to I(4) \to \OO(4) \to \OO_C(4) \to 0
.$$
It can be shown that $\dim H^0(I(4)) \geq 2$.


:::{.fact}
A generic quartic in this pencil is *smooth* (can be argued because of low degree and smoothness).
:::
  

We can compute the dimension of quartics, which is ${4+3 \choose 3} - 1 = 35 - 1 = 34$.
The dimension of $C'$s lying on a fixed quartic is $24$.
But then the dimension of the image in the Hilbert scheme is at most $24 + 34 - 1 = 57$.
It can be shown that the picard rank of such a quartic is 1, generated by $\OO(1)$, so this is a *strict* inequality, which is a contradiction since $\dim \hilb = 56$.
This proves the theorem.


:::{.remark}
Use the fact that these curves are $K3$ surfaces?
Get the fact about the generator of the Picard group from Hodge theory.
So we can deform curves a bit, but not construct an algebraic family that escapes a particular cubic.
:::



# Obstruction and Deformation (Tuesday February 25th)

Let $k$ be a field, $X_{_{/k}}$ projective, then the $k\dash$points $\hilb_{X_{_{/k}}}^P(k)$ corresponds to closed subschemes $Z\subset X$ with hilbert polynomial $P_z = P$.
Given a $P$, we want to understand the local structure of $\hilb_{X_{_{/k}}}^p$, i.e. diagrams of the form


\begin{tikzcd}
                                        &  &                                               &  & \hilb_{X_{_{/k}}}^P \arrow[dd] \\
                                        &  &                                               &  &                          \\
\spec(k) \arrow[rrrruu, "p"] \arrow[rr] &  & \spec(A) \arrow[rruu, "?", dashed] \arrow[rr] &  & \spec(k)                 \\
                                        &  &                                               &  &                          \\
                                        &  & A_{/k} \text{ Artinian local} \arrow[uu]         &  &
\end{tikzcd}



:::{.example title="?"}
For $A = k[\eps]$, the set of extensions is the Zariski tangent space.
:::
  

  
:::{.definition title="Category of Artinian Algebras"}
Let $(\Art_{/k})$ be the category of local Artinian $k\dash$algebras with local residue field $k$.
:::

Note that these will be the types of algebras appearing in the above diagrams.


:::{.remark}
This category has fiber coproducts, i.e. there are pushouts:


\begin{tikzcd}
C \arrow[dd] \arrow[rr] &  & A \arrow[dd, dashed] \\
                        &  &                      \\
B \arrow[rr, dashed]    &  & A \tensor_C B
\end{tikzcd}


There are also fibered products,


\begin{tikzcd}
A \cross_C B \arrow[rr, dashed] \arrow[dd, dashed] &  & B \arrow[dd] \\
                                                  &  &              \\
A \arrow[rr]                                       &  & C
\end{tikzcd}


Here, $A \cross_C B \definedas \theset{(a, b) \suchthat f(a) = g(b)} \subset A\cross B$.

:::
    


:::{.example title="?"}
If $A = B = k[\eps]/(\eps^2)$ and $C = k$, then $A\cross_C B = k[\eps_1, \eps_2]/(\eps_1, \eps_2)^2$

Note that on the $\spec$ side, these should be viewed as
$$
\spec(A) \disjoint_{\spec(C)} \spec(B) = \spec(A\cross_C B)
.$$

:::



:::{.definition title="Deformation Functor (Preliminary Definition)"}
A *deformation functor* is a functor $F: (\Art_{/k}) \to \Set$ such that $F(k) = \pt$ is a singleton.
:::



:::{.example title="?"}
Let $X_{_{/k}}$ be any scheme and let $x\in X(k)$ be a $k\dash$point.
We can consider the deformation functor $F$ such that $F(A)$ is the set of extensions $f$ of the following form:


\begin{tikzcd}
                                          &  &                                               &  & X \arrow[dd] \\
                                          &  &                                               &  &              \\
\spec(k) \arrow[rrrruu, "x"] \arrow[rr, hook] &  & \spec(A) \arrow[rruu, "f", dashed] \arrow[rr] &  & \spec(k)
\end{tikzcd}


If $A' \to A$ is a morphism, then we define $F(A') \to F(A)$ is defined because we can precompose to fill in the following diagram


\begin{tikzcd}
                                    &  &                                                            &  &                                                       &  &  &  & X \arrow[ddd] \\
                                    &  &                                                            &  &                                                       &  &  &  &               \\
                                    &  &                                                            &  &                                                       &  &  &  &               \\
\spec(k) \arrow[rrd] \arrow[rrrrrrrruuu] &  &                                                            &  &                                                       &  &  &  & \spec(k)      \\
                                    &  & \spec(A) \arrow[rr] \arrow[rrrrrruuuu, "\exists \tilde f"] &  & \spec(A') \arrow[rrrru] \arrow[rrrruuuu, "f", dashed] &  &  &  &
\end{tikzcd}



So this is indeed a deformation functor.
:::


:::{.example title="a motivating example"}
The Zariski tangent space on the nodal cubic doesn't "see" the two branches, so we allow "second order" tangent vectors.
:::

We can consider parametrizing the functors above as $F_{X, x}(A)$, which is isomorphic to $F_{\spec (\OO_x)_{X, x}}$ and further isomorphic to $F_{\spec \hat{\OO_x}_{x, X} }$.
This is because for Artinian algebras, we have maps
$$
\spec (\OO_{x, X})/\mfm^N \to \spec \OO_{X, x} \to X
.$$



:::{.remark}
$\hat{ \OO }_{X, x}$ will be determined by $F_{X, x}$.
:::
  


:::{.example title="?"}
Consider $y^2 = x^2(x+1)$, and think about solving this over $k[t]/t^n$ with solutions equivalent to $(0, 0) \mod t$.

![Image](figures/2020-02-25-13:20.png)\

Note that the 'second order' tangent vector comes from $\spec k[t]/t^3$.

We can write $F_{X, x}(A) = \pi\inv(x)$ where
$$
\hom_{\Sch_{/k}}(\spec k, X) \mapsvia{\pi} \hom_{\Sch_{/k}}(\spec k, x) \ni x
.$$
Thus
$$
F_{X, x}(A) = \hom_{\Sch_{/k}}(\spec A, \spec \OO_{x, X}) = \hom_{k\dash\alg}(\hat \OO_{X, x}, A)
.$$
:::


:::{.example title="?"}
Given any local $k\dash$algebra $R$, we can consider

\[
h_R: (\Art_{/k}) &\to \Set \\
A &\mapsto \hom(R, A)
.\]

and

\[
h_{\spec R}: (\Art\Sch_{/k})\op \to \Set \\
\spec(A) &\mapsto \hom(\spec A, \spec R)
.\]
:::


:::{.definition title="Representable Deformation"}
A deformation $F$ is **representable** if it is of the form $h_R$ as above for some $R \in \Art_{/k}$.
:::


:::{.remark}
There is a Yoneda Lemma for $A\in \Art_{/k}$,
\[
\hom_{\mathrm{Fun}}(h_A, F) = F(A)
.\]

We are thus looking for things that are representable in a larger category, which restrict.

:::


:::{.definition title="Pro-Representability"}
A deformation functor is *pro-representable* if it is of the form $h_R$ for $R$ a complete local $k\dash$algebra (i.e. a limit of Artinian local $k\dash$algebras).
:::


:::{.remark}
We will see that there are simple criteria for a deformation functor to be pro-representable.
This will eventually give us the complete local ring, which will give us the scheme representing the functor we want.
:::



:::{.remark}
It is difficult to understand even $F_{X, x}(A)$ directly, but it's easier to understand small extensions.
:::
  

  
:::{.definition title="Small Extensions"}
A *small extension* is a SES of Artinian $k\dash$algebras of the form
\[
0 \to J \to A' \to A \to 0
.\]
such that $J$ is annihilated by the maximal ideal fo $A'$.
:::


:::{.lemma title="?"}
Given any quotient $B\to A \to 0$ of Artinian $k\dash$algebras, there is a sequence of small extensions (quotients):


\begin{tikzcd}
0                                          &  &                  &  &        &  &                          \\
                                        &  &                  &  &        &  &                          \\
B_0 \arrow[uu]                             &  & B_1 \arrow[lluu] &  & \cdots &  & B_n = A \arrow[lllllluu] \\
                                        &  &                  &  &        &  &                          \\
B \arrow[uu] \arrow[rruu] \arrow[rrrrrruu] &  &                  &  &        &  &
\end{tikzcd}




This yields


\begin{tikzcd}
\spec A \arrow[rrrr, hook] \arrow[rrrrdddddd, Rightarrow] &  &  &  & \spec B                    \\
                                                        &  &  &  &                            \\
                                                        &  &  &  & \spec B_0 \arrow[uu, hook] \\
                                                        &  &  &  &                            \\
                                                        &  &  &  & \vdots \arrow[uu, hook]    \\
                                                        &  &  &  &                            \\
                                                        &  &  &  & \spec B_n \arrow[uu, hook]
\end{tikzcd}


where the $\spec B_i$ are all small.
:::


:::{.remark}
In most cases, extending deformations over small extensions is easy.
:::

## First Example of Deformation and Obstruction Spaces

Suppose $k=\bar k$ and let $X_{_{/k}}$ be connected.
We have a picard functor
\[
\pic_{X_{_{/k}}}: (\Sch_{/k})\op &\to \Set \\
S &\mapsto \pic(X_S) / \pic(S)
.\]
If we take a point $x\in \pic_{X_{_{/k}}}(k)$, which is equivalent to line bundles on $X$ up to equivalence, we obtain a deformation functor
\[
F \definedas F_{\pic_{ X_{_{/k}}, x  }} &\to \Set\\
A \mapsto \pi\inv(x)
\]
where
\[
\pi: \pic_{X_{_{/k}}}(\spec A) &\to \pic_{X_{_{/k}}} (\spec k) \\
\pi\inv(x) &\mapsto x
.\]

This is given by taking a line bundle on the thickening and restricting to a closed point.
Thus the functor is given by sending $A$ to the set of line bundles on $X_A$ which restrict to $X_x$.
That is, $F(A) \subset \pic_{X_{_{/k}}}(\spec A)$ which restrict to $x$.
So just pick the subspace $\pic(X_A)$ (base changing to $A$) which restrict.
There is a natural identification of $\pic(X_A) = H^1(X_A, \OO_{X_A}^*)$.
If
\[
0\to J \to A' \to A \to 0
.\]
is a thickening of Artinian $k\dash$algebras, there is a restriction map of invertible functions
\[
\OO_{X_A}^* \to \OO_{X_A'}^* \to 0
.\]
which is surjective since the map on structure sheaves is surjective and its a nilpotent extension.
The kernel is then just $\OO_{X_{A'}} \tensor J$.
If this is a small extension, we get a SES
\[
0 \to \OO_X \tensor J \to \OO_{X_{A'}}^* \to \OO_{x_A}^* \to 0
.\]
Taking the LES in cohomology, we obtain
\[
H^1 \OO_X \tensor J \to H^1 \OO_{X_{A'}}^* \to H^1\OO_{x_A}^* \to H^0 \OO_X \tensor J
.\]
Thus there is an obstruction class in $H^2$, and the ambiguity is detected by $H^1$.
Thus $H^1$ is referred to as the **deformation space**, since it counts the extensions, and $H^2$ is the **obstruction space**.

# Deformation Theory (Thursday February 27th)

Big picture idea:
We have moduli functors, such as

\[
F_{S'}: (\Sch_{/k})\op &\to \Set \\
\hilb: S &\to \text{flat subschemes of } X_S \\
\pic: S &\to \pic(X_S)/\pic(S) \\
\mathrm{Def}: S &\to \text{flat families } / S,~ \text{smooth, finite, of genus } g
.\]



:::{.definition title="Deformation Theory"}
Choose a point $f$ the scheme representing $F_{S'}$ with $\xi_0 \in F_{gl}(\spec K)$.
Define

\[
F_{\text{loc}}: (\text{Artinian local schemes} / K)\op \to \set
.\]


\begin{tikzcd}
\spec(K) \arrow[rr, "i", hook] &  & \spec(A) \arrow[rr] &  & F(i)\inv(\xi_0) \arrow[rr] &  & F_{gr}(\spec K) \arrow[dd, "F(i)"] \\
                               &  &                     &  &                            &  &                                    \\
                               &  &                     &  &                            &  & F_{gl}(\spec K)
\end{tikzcd}
:::


:::{.definition title="Deformation Functors"}
Let $F: (\Art_{/k}) \to \Set$ where $F(k)$ is a point.
Denote $\hat{\Art}_{/k}$ the set of complete local $k\dash$algebras.
Since $\Art_{/k} \subset \hat{\Art} / k$, we can make extensions $\hat F$ by just taking limits:


\begin{tikzcd}
                                & \Art_{/k} \arrow[rrr, "F"]                         &  &  & \Set \\
                                &                                                 &  &  &      \\
\lim_{\from} R/\mfm_R^n = R \in & \hat{\Art}_{/k} \arrow[uu] \arrow[rrruu, "\hat F"] &  &  &
\end{tikzcd}


where we define 
\[
\hat{F}(R) \da \inverselim F(R/\mfm_R^n)
.\]
:::


:::{.question}
When is $F$ pro-representable, which happens iff $\hat F$ is representable?
In particular, we want $h_R \mapsvia{\cong} \hat F$ for $R\in \hat{\Art}_{/k}$, so
\[
h_R = \hom_{\hat{\Art}_{/k}}(R, \wait) = \hom_{?}(\wait, \spec k)
.\]
:::


:::{.example title="?"}
Let $F_{\text{gl}} = \hilb_{X_{_{/k}}}^p$, which is represented by $H_{/k}$.
Then .
\[
\xi_0 = F_{\text{gl}}(k) = H(k) = \theset{Z\subset X \suchthat P_z = f}
.\]
Then $F_{\text{loc} }$ is representable by $\hat \OO_{H/\xi_0}$.
:::


:::{.definition title="Thickening"}
Given an Artinian $k\dash$algebra $A \in \Art_{/k}$, a *thickening* is an $A' \in \Art_{/k}$ such that $0 \to J \to A' \to A \to 0$, so $\spec A \injects \spec A'$.
:::


:::{.definition title="Small Thickening"}
A **small thickening** is a thickening such that $0 = \mfm_{A'} J$, so $J$ becomes a module for the residue field, and $\dim_k J = 1$.
:::



:::{.lemma title="?"}
Any thickening of $A$, say $B\to A$, fits into a diagram:
\begin{tikzcd}
&  &                                      &  & 0                        &  &                                     &  &   \\
&  &                                      &  &                          &  &                                     &  &   \\
&  & J \arrow[rr]                         &  & A' \arrow[uu] \arrow[rr] &  & A \arrow[dd, Rightarrow] \arrow[rr] &  & 0 \\
&  &                                      &  &                          &  &                                     &  &   \\
0 \arrow[rr] &  & I \arrow[rr] \arrow[uu]              &  & B \arrow[uu] \arrow[rr]  &  & A \arrow[rr]                        &  & 0 \\
&  &                                      &  &                          &  &                                     &  &   \\
&  & I' \arrow[rr, Rightarrow] \arrow[uu] &  & I' \arrow[uu]            &  &                                     &  &   \\
&  &                                      &  &                          &  &                                     &  &   \\
&  & 0 \arrow[uu]                         &  & 0 \arrow[uu]             &  &                                     &  &
\end{tikzcd}
:::


:::{.proof title="of lemma"}
We just need $I' \subset I$ with $\mfm_S I \subset J' \subset I \iff J \mfm_B = 0$.
Choose $J'$ to be a preimage of a codimension 1 vector space in $I/\mfm_B I$.
Thus $J = I/I'$ is 1-dimensional.
:::


Thus any thickening $A$ can be obtained by a sequence of small thickenings.
By the lemma, in principle $F$ and thus $\hat{F}$ are determined by their behavior under small extensions.


### Example

Consider $\pic$, fix $X_{_{/k}}$, start with a line bundle $L_0 \in \pic(x) /\pic(k) = \pic(x)$ and the deformation functor $F(A)$ being the set of line bundles $L$ on $X_A$with $\restrictionof{L}{x} \cong L_0$, modulo isomorphism.
Note that this yields a diagram

\begin{tikzcd}
x \arrow[rr] \arrow[dd, hook] &  & k \arrow[dd, "\text{unique closed point}"] \\
                              &  &                                            \\
X_A \arrow[rr]                &  & \spec A
\end{tikzcd}


This is equal to $(I_x)\inv (L_0)$, where $\pic(X_a) \mapsvia{I_x} \pic(x)$.
If
\[
0 \to J \to A' \to A \to 0
.\]
is a small thickening, we can identify

\begin{tikzcd}
0 \arrow[rr] &  & J \tensor_x \OO_{x} \cong \OO_x \arrow[rr] &  & \OO_{X_{A'}} \arrow[rr]                    &  & \OO_{X_{A}} \arrow[rr]   &  & 0 &  & \\
          &  &                                            &  &                                            &  &                          &  &   &  &\in\text{AbSheaves}                      \\
0 \arrow[rr] &  & \OO_x \arrow[rr, "f\mapsto 1+f"]                           &  & \OO_{X_{A'}}^* \arrow[rr] \arrow[uu, hook] &  & \OO_{X_{A}}^* \arrow[rr] &  & 0 &  &
\end{tikzcd}

This yields a LES
\begin{tikzcd}[column sep=tiny]
0 \arrow[rr]            &  & {H^0(X, \OO_x) = k} \arrow[rr] &  & {H^0(X_{A'}, \OO_{x_{A'}}^*) = {A'}^*} \arrow[rr]                                     &  & {H^0(X_{A'}, \OO_{x_{A}}^*) = A^*} \arrow[lllldd] \arrow[rr]         &  & \therefore 0 \\
                        &  &                                &  &                                                                                       &  &                                                                      &  &              \\
\therefore 0 \arrow[rr] &  & {H^1(X, \OO_{x})} \arrow[rr]   &  & {H^1(X_{A'}, \OO_{x_{A'}}^*) = \pic(X_{A'})} \arrow[rr, "\scriptsize\text{restriction to } X_A", outer sep=1em] &  & {H^1(X_{A}, \OO_{x_{A}}^*) = \pic(X_A)} \arrow[lllldd, "\text{obs}"] &  &              \\
                        &  &                                &  &                                                                                       &  &                                                                      &  &              \\
&  & {H^2(X, \OO_x)} \ar[rr]                & &\cdots                                                                                        &  &                                                                      &  &
\end{tikzcd}


:::{.remark}
To understand $F$ on small extensions, we're interested in

1. Given $L \in F_{\text{loc}}(A)$, i.e. $L$ on $X_A$ restricting to $L_0$, when does it extend to $L' \in F_{\text{loc}}(A')$?
  I.e., does there exist an $L'$ on $X_{A'}$ restricting to $L$?

2. Provided such an extension $L'$ exists, how many are there, and what is the structure of the space of extensions?
:::


:::{.question}
We have an $L\in \pic(X_A)$, when does it extend?
:::


By exactness, $L'$ exists iff $\text{obs}(L) = 0\in H^2(X, \OO_x)$, which answers 1.
To answer 2, $(I_x)\inv(L)$ is the set of extensions of $L$, which is a torsor under $H^1(x, \OO_x)$.
Note that these are fixed $k\dash$vector spaces.


:::{.remark}
$H^1(X, \OO_x)$ is interpreted as the **tangent space** of the functor $F$, i.e. $F_{\text{loc}}(K[\eps])$.
Note that if $X$ is projective, line bundles can be unobstructed without the group itself being zero.
:::

For (3), just play with $A = k[\eps]$, which yields $0 \to k \mapsvia{\eps} k[\eps] \to k \to 0$, then

\begin{tikzcd}
0 \arrow[rr] &  & {H^1(X, \OO_x)} \arrow[rr] &  & {H^1(X_{k[\eps]}, \OO_{k[\eps]}^*)} \arrow[rr, "I_x"] &  & {H^1(X, \OO_x^*)} \arrow[ll, bend right=49] \\
             &  &                            &  & {(I_x)\inv(L_0) \in \pic(X_{k[\eps]})}                &  & L_0 \in \pic(x)
\end{tikzcd}


i.e., there is a canonical trivial extension $L_0[\eps]$.

:::{.example title="?"}
Let $X \supset Z_0 \in \hilb_{X_{_{/k}}}(k)$, we computed
\[
T_{Z_0} \hilb_{X_{_{/k}}} =  \hom_{\OO_x}(I_{Z_0}, \OO_z)
.\]
We took $Z_0 \subset X$ and extended to $Z' \subset X_{k[\eps]}$ by base change.
In this case, $F_{\text{loc}}(A)$ was the set of $Z'\subset X_A$ which are flat over $A$, such that base-changing $Z' \cross_{\spec A} \spec k \cong Z$.
This was the same as looking at the preimage restricted to the closed point,
\[
\hilb_{X_{_{/k}}}(A) \mapsvia{i^*} \hilb_{X_{_{/k}}}(k) \\
(i^*)\inv(z_0) \mapsfrom z_0
.\]
Recall how we did the thickening: we had
$0 \to J \to A' \to A \to 0$ with $J^2 = 0$, along with $F$ on $X_A$ which is flat over $A$ with $X_{_{/k}}$ projective, and finally an $F'$ on $X_{A'}$ restricting to $F$.
The criterion we had was $F'$ was flat over $A'$ iff $0 \to J\tensor_{A'} F' \to F'$, i.e. this is injective.
Suppose $z\in F_{\text{loc}}(A)$ and an extension $z' \in F_{\text{loc}}(A')$.
By tensoring the two exact sequences here, we get an exact grid:

\begin{tikzcd}
0 \arrow[rr] \arrow[dd] &             & I_{Z'} \arrow[rr]             &  & \OO_{X_{A'}} \arrow[rr]            &  & \OO_{Z'} \arrow[rr]            &   & 0 \\
                      &             & 0 \arrow[d]                   &  & 0 \arrow[d]                        &  & 0 \arrow[d]                    &   &   \\
J \arrow[dd]            & 0 \arrow[r] & I_{Z_0} \arrow[dd] \arrow[rr] &  & \OO_X \arrow[dd] \arrow[rr]        &  & \OO_{Z_0} \arrow[dd] \arrow[r] & 0 &   \\
                      &             &                               &  &                                    &  &                                &   &   \\
A' \arrow[dd]           & 0 \arrow[r] & I_{Z'} \arrow[rr] \arrow[dd]  &  & \OO_{X_{A'}} \arrow[rr] \arrow[dd] &  & \OO_{Z'} \arrow[dd] \arrow[r]  & 0 &   \\
                      &             &                               &  &                                    &  &                                &   &   \\
A \arrow[dd]            & 0 \arrow[r] & I_Z \arrow[d] \arrow[rr]      &  & \OO_{X_A} \arrow[rr] \arrow[d]     &  & \OO_Z \arrow[d] \arrow[r]      & 0 &   \\
                      &             & 0                             &  & 0                                  &  & 0                              &   &   \\
0                       &             &                               &  &                                    &  &                                &   &
\end{tikzcd}

The space of extension should be a torsor under $\hom_{\OO_X}(I_{Z_0}, \OO_{Z_0})$, which we want to think of as $\hom_{\OO_X}(I_{Z_0}, \OO_{Z_0})$.
Picking a $\phi$ in this hom space, we want to take an extension $I_{Z'} \mapsvia{\phi} I_{Z''}$.
:::

> We'll cover how to make this extension next time.


# Tuesday March 31st

See notes on Ben's website.
We'll review where we were.

## Deformation Theory

We want to represent certain moduli functors by schemes.
If we know a functor is representable, it's easier to understand the deformation theory of it and still retain a lot of geometric information.
The representability of deformation is much easier to show.
We're considering functors $F: \Art_{/k} \to \Sets$.


:::{.example title="?"}
The Hilbert functor
\[
\hilb_{X_{_{/k}}} (\Sch_{/k})\op \to \sets \\
S \mapsto \theset{ Z  \subset  X \cross S \text{ flat over } S}
.\]

This yields
\[
F: \Art_{/k} \to \sets \\
???
.\]
:::

![Image](figures/2020-03-31-12:44.png)

Recall that we're interested in pro-representability, where $\hat F(R) = \inverselim F(R\mu_R^n)$ is given by a lift of the form

\begin{tikzcd}
\Art_{/k} 
  \ar[r, "F"] 
& \sets 
\\
\hat{\Art_{/k}}
  \ar[u, hook] 
  \ar[ur, "\hat F"']
&
\end{tikzcd}


:::{.question}
Is $\hat F$ representable, i.e. is $F$ pro-representable?
:::

:::{.example title="?"}
The $F$ in the previous example is pro-representable by $\hat F = \hom(\OO_{\hilb, z_0}, \wait)$.
:::


:::{.definition title="Pro-Representable Hull"}
$F$ has a *pro-representable hull* iff there is a formally smooth map $h_R \to F$.
:::

:::{.question}
Does $F$ have a pro-representable hull?
:::

Recall that a map of functors on artinian $k\dash$algebras is **formally smooth** if it can be lifted through nilpotent thickenings.
That is, for $F, G: \Art_{/k} \to \Sets$, $F \to G$ is *formally smooth* if for any thickening $A' \surjects A$, we have

\begin{tikzcd}
& 
& F 
  \ar[d] 
\\
h_{A} 
  \ar[rru] 
  \ar[r] 
& h_{A'} 
  \ar[ru, dotted] 
  \ar[r] 
& G
\\
  \spec A 
  \ar[u, equal] 
  \ar[r] 
& \spec A' 
  \ar[u, equal] 
  \ar[r] 
& G
  \ar[u, equal]
\end{tikzcd}


We proved for $R, A$ finite type over $k$, $\spec R \to \spec A$ smooth is formally smooth.
Given a complete local $k\dash$algebra $R$ and a section $\xi \in \hat F(R)$, we make the following definitions:


:::{.definition title="Versal, Miniversal, Universal"}
The pair $(R, \xi)$ is

- *Versal* for $F$ iff $h_R \mapsvia{\xi} F$ is formally smooth.[^not_unique]

- *Miniversal* for $F$ iff versal and an isomorphism on Zariski tangent spaces.

- *Universal* for $F$ if $h_R \mapsvia{\cong} F$ is an isomorphism, i.e. $h_R$ pro-represents $F$.
  - Pullback by a unique map

[^not_unique]: 
Not a unique map, but still a pullback

:::


:::{.remark}
Note that **versal** means that any formal section $(s, \eta)$ where $\eta \in \hat F(s)$ comes from pullback, i.e there exists a map
\[
R &\to S \\
\hat F(R) &\to \hat F(s) \\
\xi &\mapsto \eta
.\]

**Miniversal** means adds that the derivative is uniquely determined, and universal means that $R\to S$ is unique.
:::


:::{.definition title="Obstruction Theory"}
An **obstruction theory** for $F$ is the data of $\mathrm{def}(F), \mathrm{obs}(F)$ which are finite-dimensional $k\dash$vector spaces, along with a functorial assignment of the following form:
\[
(A' \surjects A) \quad \text{a small thickening } \mapsto \\
\mathrm{def}(F) \selfmap F(A') \to F(A) \mapsvia{\mathrm{obs}} \mathrm{obs}(F)
\]
that is exact[^recall_right_exact] and if $A=k$, it is exact on the left (so the action was faithful on nonempty fibers).

[^recall_right_exact]: 
Recall that right-exactness was a transitive action.

:::

:::{.example title="?"}
We have
\[
\pic_{X_{/k}} : (\sch_{/k})\op &\to \sets \\
S &\mapsto \pic(X\cross X) / \pic(S)
.\]

This yields
\[
F: \Art_{/k} \to \sets \\
A \mapsto L\in \pic(X_A),~ L\tensor k \cong L_0
\]
where $X_{_{/k}}$ is proper and irreducible.
Then $F$ has an obstruction theory with $\mathrm{def}(F) = H^1(\OO_x)$ and $\mathrm{obs}(F) = H^2(\OO_x)$.
The key was to look at the LES of
\[
0 \to \OO_x \to \OO_{X_{A'}}^* \to \OO_{X_A}^* \to 0
.\]

for $0 \to k \to A' \to A \to 0$ small.
:::

:::{.remark title="Summary"}
In both cases, the obstruction theory is exact on the left for any small thickening.
We will prove the following:

- $F$ has an obstruction $\iff$ it has a pro-representable hull, i.e. a versal family

- $F$ has an obstruction theory which is always exact at the left $\iff$ it has a universal family.
:::
  

## Schlessinger's Criterion 

Let $F: \Art_{/k} \to \Set$ be a deformation functor (and it only makes sense to talk about deformation functors when $F(k) = \pt$).
This theorem will tell us when a miniversal and a universal family exists.

:::{.theorem title="Schlessinger"}
$F$ has a miniversal family iff

1. Gluing along common subspaces: ror any small $A' \to A$ and $A'' \to A$ any other thickening, the map
\[
F(A' \cross_A A'') \to F(A') \cross_{F(A)} F(A'')
\]
  is surjective.


2. Unique gluing: if $(A' \to A) = (k[\eps] \to k)$, then the above map is bijective.


3. $t_F = F(k[\eps])$ is a finite dimensional $k\dash$vector space, i.e.
\[
F(k[\eps] \cross_k k[\eps]) \mapsvia{\cong} F(k[\eps]) \cross F(k[\eps])
.\]

4. For $A' \to A$ small,

\begin{tikzcd}
F(A') 
  \ar[r, "f"] 
& F(A) 
\\
t_f\, \selfmap f\inv(\eta) 
  \ar[u, hook, "\subseteq"] 
& \eta 
  \ar[u, "\in"]
\end{tikzcd}
where the action is simply transitive.


$F$ has a miniversal family iff (1)-(3) hold, and universal iff all 4 hold.

:::

:::{.exercise title="?"}
Show that the existence of an obstruction theory which is exact on the left implies (1)-(4).
:::


The following diagram commutes:

\begin{tikzcd}
\mathrm{def} \selfmap F(A' \cross_A A'') \ni \eta 
  \ar[r]
  \ar[d] 
& F(A'') \ni \xi'' 
  \ar[r, "\mathrm{obs}"]
  \ar[d] 
& \mathrm{obs} 
\\
\mathrm{def} \selfmap F(A')\ni \eta'm \xi' 
  \ar[r] 
& F(A')\ni \xi 
  \ar[r, "\mathrm{obs}"] 
& \mathrm{obs} \\
\end{tikzcd}


So we have a map $F(A' \cross_A A'') \to F(A') \cross_{F(A)} F(A'') \ni (\xi',\xi'')$.
Using transitivity of the $\mathrm{def}$ action, we can get $\xi' = \eta' + \theta$ and thus $\eta + \theta$ is the lift.

## Abstract Deformation Theory


:::{.example title="?"}
We start with $\qty{X_0}_{/k}$ and define the functor $F$ sending $A$ to $X/A$ flat families over $A$ with $X_0 \injects^i X$ such that $i \tensor k$ is an isomorphism.
The punchline is that $F$ has an obstruction theory if $X_0$ is smooth with

- $\mathrm{def}(F) = H^1(T_{X_0})$
- $\mathrm{obs}(F) = H^2(T_{X_0})$

:::


:::{.remark}
\envlist

1. If $X$ is a deformation of $X_0$ over $A$ and we have a small extension $k \to A'\to A$ with $X'$ over $A'$ a lift of $X$.
  Then there is an exact sequence
\[
0 \to \text{Der}_R(\OO_{X_0}) \to\aut_{A'}(X') \to \aut_A(X)
.\]

2. If $\qty{X_0}_{/k}$ is smooth and *affine*, then any deformation $X$ over $A$ (a flat family restricting to $X_0$) is trivial, i.e. $X \cong X_0 \cross_k \spec(A)$.

\begin{tikzcd}
&
&
X_0 \cross \spec(A) 
  \ar[d]
\\
X_0 
  \ar[r, hook] 
&
X 
  \ar[r]
  \ar[ru, "f", dotted] 
& \spec(A)
\end{tikzcd}

Thus $X_0 \injects X$ has a section $X\to X_0$, and the claim is that this forces $X$ to be trivial.
:::
  

We have
\begin{tikzcd}
0 
  \ar[r] 
& J \tensor \OO_X 
  \ar[r] 
& \OO_x 
  \ar[r] 
& \OO_{X_0} 
  \ar[r] 
  \ar[l, bend right] 
& 0
\end{tikzcd}


yielding
\[
0 \to K \to \OO_{X_0} \tensor A \to \OO_X \to 0 \\
(\wait \tensor k) \\
1 \to k\tensor k = 0 \to \OO_{X_0} \mapsvia{\cong} \OO_{X_0} \to 0
.\]


:::{.remark}
Why does this involve cohomology of the tangent bundle?
For $X_0$ smooth, $\Der_k(\OO_{X_0}) = \mathcal{H}(T_{X_0})$, but the LHS is equal to $\hom( \Omega_{ \qty{X_0}_{/k}}, \OO_{X_0}) = H^0 (T_{X_0})$.
:::

> Upcoming: proof of Schlessinger so we can use it!

# Thursday April 2nd

## Abstract Deformations

Let $X_0$ be smooth and consider the deformation functor
\[
F : \Art_{_{/k}} &\to \sets \\
A &\mapsto (X_{/A} , \iota)
\]
where $X$ is flat (and thus smooth) and $i$ is a closed embedding 
$i: X_0 \injects X$ with $i\tensor k$ an isomorphism. 

Then $F$ has an obstruction theory with

- $\mathrm{def}(F) = H^1(X_0, T_0)$ of the tangent bundle
- $\mathrm{obs}(F) = H^2(X_0, T_0)$.

Additionally assume $X_0$ is smooth and projective, which will force the above cohomology groups to be finite-dimensional over $k$.


:::{.remark title="Key points"}
\envlist
- All deformations of smooth affine schemes are trivial
- Automorphisms of a deformation $X/A$ which are the identity on $X_0$ are $\id + \delta$ for $\delta$ a derivation in $\Der_k(\OO_{X_0}) = \hom_{\OO_{X_0}}(\Omega_{\qty{X_0}_{_{/k}}}, \OO_{X_0})$.

> See screenshot.
:::

Suppose we have a small thickening $k \to \AA^1 \to \AA$ and $X/\AA$ with an affine cover $X_\alpha$ of $X$.
This comes with gluing information $\phi_{\alpha\beta}: X_{\alpha\beta} \to X_{\beta\alpha} = X_\alpha \intersect X_\beta$.
These maps satisfy a cocycle condition:

\begin{tikzcd}
X_{\alpha\beta} \intersect X_{\alpha\gamma} 
  \ar[rr]
  \ar[rd] 
& 
& X_{\gamma\alpha} \intersect X_{\gamma\beta}
  \ar[ld] 
\\
& X_{\beta\alpha} \intersect X_{\beta\gamma} 
&
\end{tikzcd}



:::{.question}
Can we extend this to $X'/\AA$?
:::
  
We have $X_\alpha \cong X_\alpha^\mathrm{red} \cross \AA$?
Choose $\phi'_{\alpha\beta}$ such that

\begin{tikzcd}
X'_{\alpha\beta} 
  \ar[r, "\phi'_{\alpha\beta}"] 
& X'_{\beta\alpha} = X_{\beta\alpha}^\mathrm{red} \cross \AA 
\\
X_{\alpha\beta}\ar[u, hook] 
  \ar[r, "\phi_{\alpha\beta}"] 
& X_{\beta\alpha} 
  \ar[u, hook]
\end{tikzcd}

We need $\phi'_{\alpha\beta}$ to satisfy the cocycle condition in order to glue.
We want the following map to be the identity: $(\phi'_{\alpha\gamma})\inv \phi'_{\beta\gamma} \phi'_{\alpha\beta}$.
This is an automorphism of $X'_{\alpha\beta} \intersect X'_{\alpha\beta}$ and is thus the identity in $\aut(X_{\alpha\beta} \intersect X_{\alpha\gamma})$.
So it makes sense to talk about 
\[
\delta_{\alpha\beta\gamma} 
\da 
(\phi'_{\alpha\gamma})\inv 
\phi'_{\beta\gamma} 
\phi'_{\alpha\beta} - 
\id \in 
M^0(T_{X^\mathrm{red}_{\alpha\beta\gamma}})
.\]


:::{.exercise title="?"}
In parts,

1. $\delta_{\alpha\beta\gamma}$ is a $2\dash$cocycle for $T_{X_0}$, so it has trivial boundary in terms of Cech cocycles.
  Thus $[\delta_{\alpha\beta\gamma}] \in H^2(T_{X_0})$.

2. The class $[\delta_{\alpha\beta\gamma}]$ is independent of choice of $\phi'_{\alpha\beta}$, i.e. $\phi'_{\alpha\beta} - \phi_{\alpha\beta}'' \in H^0((T_X)_{\alpha\beta})$ gives a coboundary $\eta$ and thus $\delta = \delta' + \eta$.
  This yields $\mathrm{obs}(X) \in H^2(T_{X_0})$.

3. $\mathrm{obs}(X) = 0 \iff X$ lifts to some $X'$ (i.e. a lift exists)

:::


:::{.remark}
For the sufficiency, we have $\delta_{\alpha\beta\gamma} = \bd \eta_{\alpha\beta} \in H^0(T_{X_{\alpha\beta}})$.
Let $\phi_{\alpha\beta}'' = \phi_{\alpha\beta}' - \eta_{\alpha\beta}$, the claim is that $\phi_{\alpha\beta}''$ satisfies the gluing condition.
This covers the obstruction, so now we need to show that the set of lifts is a torsor for the action of the deformation space $\mathrm{def}(F) = H^1(T_{X_0})$.
From an $X'$, we obtain $X_{\alpha\beta}' \mapsvia{\phi_{\alpha\beta}'} X_{\beta\alpha}'$ where the LHS is isomorphic to $(X_{\alpha\beta}')^\mathrm{red} \cross \AA^r$?
Given $\eta_{\alpha\beta} \in H^0(T_{X_{\alpha\beta}})$, then $\phi'_{\alpha\beta} + \eta_{\alpha\beta} = \phi_{\alpha\beta}''$ is another such identification.

:::



:::{.exercise title="?"}
In parts

1. $\bd \eta_{\alpha\beta} = 0$.
2. Given an $X'$ and 1-coboundary $\eta$, we get a new lift $X'' = X' + \eta$.
If $[\eta] = [\eta'] \in H^1(T_{X_0})$, then $X' + \eta \cong X' + \eta'$.

By construction, $(X' + \eta)_\alpha \cong (X' + \eta')_\alpha$, but these may not patch together.
However, if $[\eta] = [\eta']$ then this isomorphism can be modified by by $\eps$ defined by $\eta-\eta' = \bd \eps$, and it patches.

:::

:::{.remark}
This kind of patching is ubiquitous -- essentially patching together local obstructions to get a global one.
In general, there is a local-to-global spectral sequence that computes the obstruction space
:::


## Proving Schlessinger

### The Schlessinger Axioms

#### H1

For any two small thickenings
\[
A' &\to A \\
A'' &\to A
\]

we have a natural map
\[
F(A' \cross_A A'') \to F(A') \cross_{F(A)} F(A'')
\]
and we require that this map is surjective.
So deformations agreeing on the sub glue together.

#### H2

When $(A' \to A) = (k[\eps] \to k)$ is the trivial extension, the map in H1 is an isomorphism.

> Doing things to first order is especially simple.

#### H3

The tangent space of $F$ is given by $t_F = F(k[\eps])$, and we require that $\dim_k t_F < \infty$, which makes sense due to H2.

#### H4

If we have two equal small thickenings $(A' \to A) = (A'' \to A)$, then the map in H1 is an isomorphism.

#### H4'

For $A' \to A$ small,
\[
t_F \selfmap F(A') \to F(A)
\]
is exact in the middle and left.


:::{.remark}
Note that the existence of this action uses H2.
:::



:::{.warnings}
For $(R, \xi)$ a complete local ring and $\xi \in \hat F(R)$ a formal family, this is a hull $\iff$ miniversal, i.e. for $h_R \mapsvia{\xi} F$, this is smooth an isomorphism on tangent spaces.
:::


:::{.theorem title="1, Schlessinger"}
\envlist

a. $F$ has a miniversal family $(R, \xi)$ with $\dim t_R < \infty$, noting that $t_R = \mfm_R / \mfm_R^2$, iff H1-H3 hold.
b. $F$ has a universal family $(R, \xi)$ with $\dim t_R < \infty$ iff h1-H4 hold.
:::


:::{.theorem title="2"}
\envlist

a. $F$ having an obstruction theory implies H1-H3.
b. $F$ having a strong obstruction theory (exact on the left) is equivalent to H1-H4.
:::

Some preliminary observations:

:::{.exercise title="Easy, fun, diagram chase"}
If $F$ has an obstruction theory, then H1-H3 hold.
:::

:::{.exercise title="?"}
An obstruction theory being exact on the left implies H4.
:::

### Example

:::{.exercise title="?"}
For $R$ a complete local $k\dash$algebra with $t_R$ finite dimensional has a strong obstruction theory.
:::

Can always find a surjection from a power series ring:
\[
S \da k[[t_R\dual]] \surjects R
\]
which yields an obstruction theory

- $\mathrm{def} = t_R$
- $\mathrm{obs} = I/\mfm_S I$

i.e., if $F$ is pro-representable, then it has a strong obstruction theory.
Suppose that $(R, \xi)$ is versal for $F$, this implies H1.
We get $F(A' \cross_A A'') \surjects F(A') \cross_{F(A)} F(A'')$
For versal, if we have $h_R \mapsvia{\xi} F$ smooth, we have



\begin{tikzcd}
& 
& 
&  h_r 
\ar[d] 
\\
h_k 
  \ar[r] 
  \ar[rrru] 
& h_A 
  \ar[r]
  \ar[rru, dotted] 
  \ar[rr, bend right, "\eta"] 
& h_{A'} 
  \ar[ur, dotted]
  \ar[r] 
& F
\end{tikzcd}


and we can find a lift from $h_{A''}$ as well, so we get a diagram

\begin{tikzcd}
& 
& 
F
\\
h_{A''} 
  \ar[r] 
& h_R 
\ar[ru] 
\\
h_A 
  \ar[u] 
  \ar[r] 
& h_{A'} 
  \ar[u]
\end{tikzcd}


and thus

\begin{tikzcd}
  {A''} \ar[r] 
& R 
\\
A 
  \ar[u] 
  \ar[r] 
& {A'} 
  \ar[u]
\end{tikzcd}

So we get the left $\tilde \eta$ of $(\eta', \eta'')$ we want from

\begin{tikzcd}
h_{A' \cross_A A''} 
  \ar[r, "f"] 
  \ar[rr, "\tilde\eta", bend right] 
& h_R 
  \ar[r] 
& F
\end{tikzcd}


If $(R, \xi)$ is miniversal, then H2 holds.
We want to show that the map
\[
F(A'' \cross_K k[\eps]) \mapsvia{\sim} ??
\]
is a bijection.

Suppose we have two maps


\begin{tikzcd}
&  
& h_R 
\\
h_{A''} 
  \ar[rru, bend left] 
  \ar[r] 
& h_{A'' \cross k[\eps]} 
  \ar[ru, shift left=0.75ex] 
  \ar[ru, shift right=0.75ex] 
  \ar[r, shift left=0.75ex] 
  \ar[r, shift right=0.75ex] 
& F 
\\
& h_{k[\eps]} 
  \ar[ur, bend right] 
&
\end{tikzcd}

Then the two lifts are in fact equal, and

\begin{tikzcd}
R 
  \ar[r, shift left=0.75ex] 
  \ar[r, shift right=0.75ex] 
& A'' \cross k[\eps]
  \ar[r]
  \ar[d] 
& k[\eps] 
\\
& A'' 
&
\end{tikzcd}

If $(R, \xi)$ is miniversal with $t_R$ finite dimensional, then H3 holds immediately.
If $(R, \xi)$ is universal, then H4 holds.


:::{.question}
Why are H4 and H4' connected?
:::


:::{.answer}
Let $A' \to A$ be small, then
\[
A' \cross_A A' &= A' \cross_k k[\eps] \\
(x, y) &\mapsto ??
.\]

Using H2, we can identify $F(A; \cross_A A') \cong t_F \cross F(A')$.
We can thus define an action
\[
(\theta, \xi) &\mapsto (\theta + \xi, \xi)
.\]

If this is an isomorphism, then this action is simply transitive.
The map $\theta \mapsto \theta + \xi$ gives an isomorphism on the fiber of $F(A') \to F(A)$.
:::

> Next time we'll show the interesting part of the sufficiency proof.

# Tuesday April 7th

> (Missing first few minutes.)

Take $I_{q+1}$ to be the minimal $I$ such that $\mfm_q I_q \subset I \subset I_1$ and $\xi_q$ lifts to $S/I$.


:::{.claim}
Such a minimal $I$ exists, i.e. if $I, I'$ satisfy the two conditions then $I \intersect I'$ does as well.
So $I, I'$ are determined by their images $v, v'$ in the vector space $I_q \tensor k$.
:::

So enlarge either $v$ or $v'$ such that $v + v' = I_q \tensor k$ but $v \intersect v'$ is the same.
We can thus assume that $I + I' = I_q$, and so
\[
S / I \intersect I' = S/I \cross_{S/I_q} S/I'
\]
which by H1 yields a map
\[
F(S/I\intersect I') &\to F(S/I) \cross_{F(S/I_q)} F(S/I')
\]

So $I\intersect I'$ satisfies both conditions and thus a minimal $I_{q+1}$ exists.
Let $\xi_{q+1}$ be a lift of $\xi_q$ over $S/I_{q+1}$ (noting that there may be many lifts).

## Showing Miniversality

:::{.claim}
Define $R = \directlim R_q$ and $\xi = \directlim \xi_q$, the claim is that $(R, \xi)$ is miniversal.
:::

We already have $h_R \mapsvia{\xi} F$ and thus $t_R \mapsvia{\cong}t_F$ is fulfilled.
We need to show formal smoothness, i.e. for $A' \to A$ a small thickening, suppose we have a lift
\begin{tikzcd}
&
& h_R 
  \ar[d, "\xi"] 
\\
h_a 
  \ar[rru, "n"] 
  \ar[rr, bend right] 
  \ar[r] 
& h_{A'} 
  \ar[r] 
& F
\end{tikzcd}

If we have a $u'$ such that commutativity in square 1 holds (?) then we can form a lift $u'$ satisfying commutativity in both squares 1 and 2.
We can restrict sections to get a map $F(A') \to F(A)$ and using representability obtain $h_R(A') \to h_R(A)$.
Combining H1 and H2, we know $t_F$ acts transitively on fibers, yielding


\begin{tikzcd}
t_R \selfmap \ar[d, "\cong"] & u'\in h_R(A') \ar[r] \ar[d] \ar[r] & u\in h_R(A) \ar[d]\\
t_F \selfmap & \eta' \in F(A') \ar[r] \ar[r] & \eta \in F(A) \\
\end{tikzcd}

Then $u' \mapsto u$ is equivalent to (1), and $u' \mapsto \eta'$ is equivalent to (2).
Let $\eta_0$ be the image of $u'$ and define $\eta' = \eta_0 + \theta, \theta \in t_F$ then $u' = u' + \theta, \theta \in t_R$.
So we can modify the lift to make these agree.
Thus it suffices to show

\begin{tikzcd}
A' \ar[r] & A & R_q \ar[l] \\
S \ar[u, "v"] \ar[r] & \ar[lu, dotted, "\exists_? u'"] \ar[u, "u"] \ar[ur] &
\end{tikzcd}


We get a diagram of the form

\begin{tikzcd}
S 
  \ar[d] 
  \ar[r, "w"] 
& A' \cross_A R_1 
  \ar[r]
  \ar[d, "{ \pi_2, \text{small} }"] 
& A' 
  \ar[d, "{ \text{small} }"]
\\
R 
  \ar[r] 
& R_q 
  \ar[r] 
& A
\end{tikzcd}



:::{.observation}
\envlist

- $S \to R_q$ is surjective.

- $\im(w) \subset A' \cross_A R_1$ is a subring, so either

  - $\im(w) \mapsvia{\cong} R_q$ if it doesn't meet the kernel, or
  
  - $\im(w) = A' \cross_A R_q$

In case (a), this yields a section of the middle map and we'd get a map $R_q \to A'$ and thus the original map we were after $R \to A$.
:::

So assume $w$ is surjective and consider

\begin{tikzcd}
0 \ar[r] & I \ar[r] & S \ar[r] & A' \cross_A R_q \ar[r]\ar[d, "\text{small}"] & 0  \\
 & & & R_q &
\end{tikzcd}


and we have $\mfm_S I_1 \subset I \subset I_q$ where the second containment is because $I$ a quotient of $R_q$ factors through $S/I$ and the first is because $S/I$ is a small thickening of $R_q$.
But $\xi_q$ lifts of $S/I$, and we have
\[
\xi \in F(S/I) \surjects \xi = \xi' \cross \xi_q ?
.\]
Therefore $I_{q+1} \subset I$ and we have a factorization

\begin{tikzcd}
S \ar[rr] \ar[dr, dotted] & & S/I \\
& R_{q+1}\ar[ur, dotted] &
\end{tikzcd}

Recall that we had

![](figures/image_2020-04-07-13-17-11.png)

\todo[inline]{Image to diagram}

where the diagonal map $u'$ gives us the desired lift, and thus

\begin{tikzcd}
R \ar[r] \ar[rr, bend left] & R_{q+1} \ar[r] & A'
\end{tikzcd}

exists.
This concludes showing miniversality.

## Part of Proof

To finish, we want to show that H4 implies that the map on sections $h_R \mapsvia{\xi} F$ is bijective.

\begin{tikzcd}
&
&
& h_R 
  \ar[d, "\xi"]
\\
& h_A 
  \ar[rr, bend right, "\eta"] 
  \ar[rru, bend left, "u"] 
& h_{A'} 
  \ar[r, "\eta'"] 
  \ar[ru, "\exists ! u'"] 
& F
\end{tikzcd}

where the map $\xi$ is "formal etale", which will necessarily imply that it's a bijection over all artinian rings.
So we just need to show formal étaleness.
We have a diagram

\begin{tikzcd}
t_R \selfmap u'\in h_R(A') \ar[r] \ar[d] & u\in h_R(A) \ar[d] \\
t_F \selfmap \eta' \in h_R(A') \ar[r] & \eta \in h_R(A)
\end{tikzcd}

where $u'$ exists by smoothness.

Assume that are two $u', u''$, then $u' = u'' + \theta$ and $\im(u') = \im(u'') + \theta \implies \theta = 0$ and thus $u' = u''$.

## Revisiting Goals

We originally had two goals:

1. Given a representable moduli functor (such as the Hilbert functor), we wanted to understand the local structure by analyzing the deformation functor at a given point.

2. We want to use representability of the deformation functors to get global representability of the original functor.


:::{.question}
What can we now deduce about the local structure of functors using their deformation theory?
:::


:::{.fact title="1"}
Any two hulls $h_R \to F$ are isomorphic but not canonically.
We can lift maps at every finite level and induct up, which is an isomorphism on tangent spaces and thus an isomorphism.
The sketch: use smoothness to get the map, and the tangent space condition will imply the full isomorphism.
:::



:::{.fact title="3"}
Suppose that $F$ has an obstruction theory (not necessarily strong).
This implies there exists a hull $h_R \mapsvia \xi F$.
The obstruction theory of $F$ *gives* an obstruction theory of $h_R$:
given $A' \to A$ a small thickening, we need a functorial assignment
\[
t_R = \mathrm{def} \selfmap h_R(A') \to h_R(A) \mapsvia{\mathrm{obs}} \mathrm{obs} \\
\mathrm{def} \selfmap F(A') \to F(A) \mapsvia{\mathrm{obs}} \mathrm{obs}
\]
where there are vertical maps with equality on the edges.

![Vertical maps](figures/image_2020-04-07-13-35-00.png)

By formal smoothness, $\eta'$ lifts to some $\xi'$, but using the transitivity of the action of the tangent space can fix this.
We already had an obstruction theory of $R$, since we can always find a quotient
\[
I \to S = k[[t_R\dual]] \surjects R
\]
and $h_K$ has an obstruction theory

- $\mathrm{def} = t_R = \qty{\mfm_R/\mfm_R^2}\dual$
- $\mathrm{obs} = \qty{I/\mfm_S I}\dual$
:::


:::{.fact title="proof can be found in FGA"}
Any other obstruction theory $(\mathrm{def}', \mathrm{obs}')$ of $h_R$ admits an injection $\qty{I/\mfm_S I}\dual \injects \mathrm{obs}'$.
:::

Combining these three facts, we conclude the following:
If $F$ has an obstruction theory $\mathrm{def}(F), \mathrm{obs}(F)$, then $F$ has a miniversal family $h_R \mapsvia \xi F$ with $R = S/ I$ a quotient of the formal power series ring over some ideal, where $S = k[[t_F\dual]]$.
It follows that $\dim(I/\mfm_S I) \leq \dim \mathrm{obs}(F)$, and thus the minimal number of generators of $I$ (equal to the LHS by Nakayama) is bounded by the RHS.
Thus
\[
\dim_k \mathrm{def}(F) \geq \dim R \geq \dim \mathrm{def}(F) - \dim \mathrm{obs}(F)
.\]

In particular, if $\dim(R) = \dim \mathrm{def}(F) - \dim \mathrm{obs}(F)$, then $R$ is a complete intersection.
If $\dim(R) = \dim \mathrm{def}(R)$, the ideal doesn't have any generators, and $R \cong S$.
In particular, if $\mathrm{obs}(F) = 0$, then $R \cong S$ is isomorphic to this power series ring.

Finally, if $F$ is the deformation functor for a global representable functor, then $R = \hat{\OO}_{\mfm, p}$ is the completion of this local ring and the same things hold for this completion.
Thus regularity can be checked on the completion.
So if you have a representable functor with an obstruction theory (e.g. the Hilbert Scheme) with zero obstruction, then we have smoothness at that point.
If we know something about the dimension at a point relative to the obstruction, we can deduce information about being a local intersection.
So the deformation tells you the dimension of a minimal smooth embedding, and the obstruction is the maximal number of equations needed to cut it out locally.


:::{.remark}
The content here: see Hartshorne's *Deformation Theory*.
The section in FGA is in less generality but has many good examples. 
See "Fundamental Algebraic Geometry". 
See also representability of the Picard scheme.
:::


# Thursday April 9th

Let $F: \Art_{/k} \to \sets$ be a deformation functor with an obstruction theory.
Then H1-H3 imply the existence of a miniversal family, and gives us some control on the hull $h_{R} \to F$, namely
\[
\dim \mathrm{def}(F) \geq \dim R \geq \dim \mathrm{def}(F) - \dim \mathrm{obs}(F)
.\]
In particular, if $\mathrm{obs}(F) = 0$, then $R \cong k[[\mathrm{def}(F)\dual]] = k[[ t_{F}\dual ]]$.


:::{.example title="?"}
Let $M = \hilb_{\PP^n_{/k}}^{dt + (1-g)}$ where $k=\bar k$, and suppose $[Z] \in M$ is a smooth point.
Then
\[
\mathrm{def} = \hom_{ \mods{ \OO_{x} } }(I_{Z}, \OO_{Z}) = \hom_{Z}(I_{Z}/I_{Z}^2, \OO_{Z}) = H^0(N_{Z/X})
.\]
the normal bundle $N_{Z/X} = (I/I^2)\dual$ of the regular embedding, and $\mathrm{obs} = H^1(N_{Z/X})$.

:::{.claim}
If $H^1(\OO_{Z}(1)) = 0$ (e.g. if $d > 2g-2)$ then $M$ is smooth.
:::

:::{.proof title="of claim"}
The tangent bundle of $\PP^n$ sits in the Euler sequence
\[
0 \to \OO \to \OO(1)^{n+1} \to T_{\PP^n} \to 0
.\]

And the normal bundles satisfies
\[
0 \to T_{Z} &\to T_{\PP^n}\mid_{Z} \to N_{Z/\PP^n} \to 0 \\ \\
&\Downarrow \text{ is the dual of }\\ \\
0 \to I/I^2 &\to \Omega \mid_{Z} \to \Omega \to 0
.\]

There is another SES:
\[
?????
.\]

Taking the LES in cohomology yields
\[
H^1(\OO_{Z}(1)^{n+1})=0 \to H^1(N_{Z/\PP^n}) =0 \to 0
\]
and thus $M$ is smooth at $[Z]$.
We can compute the dimension using Riemann-Roch:
\[
\dim_{[Z]} M 
&= \dim H^0(N_{Z/\PP^n}) \\
&= \chi(N_{Z/\PP^n}) \\
&= \deg N + \rk N(1-g) \\
&= \deg T_{\PP^n} \mid _Z - \deg T_{Z} + (n-1)(1-g) \\
&= d(n+1) + (2-2g) + (n-1)(1-g)
.\]

:::

:::


:::{.remark}
This is one of the key outputs of obstruction theory: being able to compute these dimensions.
:::

:::{.example title="?"}
Let $X \subset \PP^5$ be a smooth cubic hypersurface and let $H = \hilb_{X_{/k}}^{\text{lines} = t+1} \subset \hilb_{\PP^5/k}^{t+1} = \Gr(1, \PP^5)$, the usual Grassmannian.


:::{.claim}
Let $[\ell] \in H$, then the claim is that $H$ is smooth at $[\ell]$ of dimension 4.
:::

:::{.proof title="of claim"}
We have

- $\mathrm{def} = H^0(N_{\ell/X})$
- $\mathrm{obs} = H^1(N_{\ell/X})$

We have an exact sequence
\[
0 \to N_{\ell/X} \to N_{\ell/\PP} \to N_{X/\PP}\mid_\ell \to 0 \\
.\]

There are surjections from $\OO_\ell(1)^6$ onto the last two terms.


:::{.claim title="Subclaim"}
For $N = N_{\ell/\PP}$ or $N_{X/\PP}\mid_\ell$, we have $H^1(N) = 0$ and $\OO(1)^6 \surjects N$ is surjective on global sections.
:::


:::{.proof title="of subclaim"}
Because $\ell$ is a line, $\OO_\ell(1) = \OO(1)$ and $H^1(\OO_\ell(1)) = 0$ and the previous proof applies, so $H^1(N) = 0$.

:::

We thus have a diagram:

![Image](figures/image_2020-04-09-12-51-51.png)

In particular, $T_\ell = \OO(2)$, and the LES for $0 \to \OO \to K \to T_\ell$ shows $H^1(K) = 0$.
Looking at the horizontal SES $0 \to K \to \OO_\ell(1)^6 \surjects N_{\ell/\PP}$ yields the surjection claim.
We have

![Diagram](figures/a.png)

and taking the LES in cohomology yields

![Diagram](figures/image_2020-04-09-12-55-01.png)\

Therefore $H$ is smooth at $\ell$ and
\[
\dim_\ell H
&= \chi(N_{\ell/X}) \\
&= \deg T_{X} - \deg T_\ell + 3 \\
&= \deg T_\PP - \deg N_{X/\PP} - \deg T_\ell + 3 \\
&= 6 - 3 - 2 + 3 = 4
.\]
:::

:::



:::{.remark}
It turns out that the Hilbert scheme of lines on a cubic has some geometry: the Hilbert scheme of two points on a K3 surface.
:::

## Abstract Deformations Revisited

Take $X_{0} / k$ some scheme and consider the deformation functor $F(A)$ taking $A$ to $X/A$ flat with an embedding $\iota: X_{0} \injects X$ with $\iota \tensor k$ an isomorphism.
Start with H1, the gluing axiom (regarding small thickenings $A' \to A$ and a thickening $A'' \to A$).
Suppose 
\[
X_{0} \injects X' \in F(A') \to F(A)
.\]
which restricts to $X_{0} \injects X$.
Then in $F(A)$, we have $X_{0} \injects X' \tensor_{A'} A$, and we obtain a commutative diagram where $X' \tensor A \injects X'$ is a closed immersion:

![???](figures/abcdefg.png){width=350px}

The restriction $X' \to X$ means that there exists a diagram


\begin{tikzcd}
X' 
&  
& X
  \ar[ll, dotted, "\exists"] 
\\
& 
X
  \ar[ur, hook] 
  \ar[ul, hook]
\end{tikzcd}

Note that this is not necessarily unique.
We have

![Diagram?](figures/image_2020-04-09-13-06-40.png){width=350px}

This means that we can find embeddings such that

\begin{tikzcd}
X'' & \ar[l, "\exists", hook] X \ar[r, "\exists", hook] & X' \\
& X_{0} \ar[ul, hook] \ar[u, hook] \ar[ur, hook]
\end{tikzcd}

![Diagram](figures/image_2020-04-09-13-08-19.png){width=350px}

And thus if we have

![Diagram](figures/image_2020-04-09-13-08-42.png){width=350px}

then $X_{0} \injects Z$ is **a** required lift (again not unique).

:::{.question}
When is such a lift unique?
:::

Suppose $X_{0} \injects W$ is another lift, then it restricts to both $X, X'$ and we can fill in the following diagrams:

![Diagram](figures/image_2020-04-09-13-10-44.png){width=350px}

Using the universal property of $Z$, which is the coproduct of this diagram:

![Diagram](figures/image_2020-04-09-13-11-13.png){width=350px}

However, there may be no such way to fill in the following diagram:

![Diagram](figures/image_2020-04-09-13-11-58.png){width=350px}

But if there exists a map making this diagram commute:

![Diagram](figures/image_2020-04-09-13-12-25.png){width=350px}

Then there is a map $Z\to W$ which is flat after tensoring with $k$, which is thus an isomorphism.[^nakayama_rmk]


:::{.remark}
Thus the lift is unique if

- $X = X_{0}$, then the following diagrams commute by taking the identity and the embedding you have.
  Note that in particular, this implies H2.

  ![Diagram](figures/image_2020-04-09-13-15-09.png){width=350px}

- Generally, these diagrams can be completed (and thus the gluing maps are bijective) if the map
\[
\aut(X_{0}\injects X') \to \aut(X_{0} \injects X)
.\]
of automorphisms of $X'$ commuting with $X_{0} \injects X$ is surjective.
:::

So in this situation, there is only *one* way to fill in this diagram up to isomorphism:

![Diagram](figures/image_2020-04-09-13-18-59.png){width=350px}

If we had two ways of filling it in, we obtain bridging maps:

![Diagram](figures/image_2020-04-09-13-20-07.png){width=350px}


:::{.lemma title="?"}
If $H^0(X_{0}, T_{X_{0}}) = 0$ (where the tangent bundle always makes sense as the dual of the sheaf of Kahler differentials) which we can identify as derivations $D_{\OO_{k}}(\OO_{X_{0}}, \OO_{X_{0}})$, then the gluing map is bijective.
:::


:::{.proof title="?"}
The claim is that $\aut(X_{0} \injects X) = 1$ are always trivial.
This would imply that all random choices lead to triangles that commute.
Proceeding by induction, for the base case $\aut(X_{0} \injects X_{0}) = 1$ trivially.
Assume $X_{0} \injects X_{i}$ lifts $X_{0} \injects X$, then there's an exact sequence
\[
0 
\to 
\Der_{k}(\OO_{X_{0}}, \OO_{X_{0}}) 
\to  
\Aut(X_{0} \injects X_0') 
\to 
\Aut(X_{0} \injects X)
.\]
:::


Thus $F$ always satisfies H1 and H2, and $H^0(T_{X_{0}}) = 0$ (so no "infinitesimal automorphism") implies H4.
Recall that the dimension of deformations of $F$ over $k[\eps]$ is finite, i.e. $\dim t_{F} < \infty$
This is where some assumptions are needed.

If $X_{/K}$ is either

- Projective, or
- Affine with isolated singularities,

this is enough to imply H3.
Thus by Schlessinger, under these conditions $F$ has a miniversal family.

Moreover, if $H^0(T_{X_{0}}) = 0$ then $F$ is pro-representable.

:::{.example title="?"}
If $X_{0}$ is a smooth projective genus $g\geq 2$ curve, then

- Obstruction theory gives the existence of a miniversal family
- We have $\mathrm{obs} = H^2(T_{X_{0}}) = 0$, and thus the base of the miniversal family is smooth of dimension $\mathrm{def}(F) \dim H^1(T_{X_{0}})$,
- $H^0(T_{X_{0}}) = 0$ and $\deg T_{X_{0}} = 2-2g < 0$, which implies that the miniversal family is universal.

We can conclude
\[
\dim H^1(T_{X_{0}}) = -\chi(T_{X_{0}}) =  -\deg T_{X_{0}} + g-1 =  3(g-1)
.\]
:::

:::{.remark}
Note that the global deformation functor is not representable by a scheme, and instead requires a stack.
However, the same fact shows smoothness in that setting.
:::

## Hypersurface Singularities

Consider $X(f) \subset \AA^n$, and for simplicity, $(f=0) \subset \AA^2$, and let 

- $S = \CC[x, y]$.

- $B = \CC[x, y] / (f)$ 

:::{.question}
What are the deformations over $A \da k[\eps]$?
:::

This means we have a ring $B'$ flat over $k$ and tensors to an isomorphism, so tensoring $k\to A\to k$ yields the following:

\begin{tikzcd}
0 
	\ar[r] 
& B 
	\ar[r] 
& B'
	 \ar[r] 
& B 
	\ar[r] 
& 0 
\\
0
	\ar[r]
& S 
	\ar[u] 
	\ar[r] 
& S[\eps] 
	\ar[u, "\exists", twoheadrightarrow] 
	\ar[r] 
& S 
	\ar[r] 
	\ar[u] 
& 0
\\
0 
	\ar[r]
& S \cong I 
	\ar[u] 
	\ar[r] 
& I'= \gens{f'}
	\ar[u]
	\ar[r] 
& I = \gens{f} 
	\ar[u, "\cong"] 
	\ar[r]
& S
\end{tikzcd}

Thus any such $B'$ is the quotient of $S[\eps]$ by an ideal, and we have $f' = f + \eps g$.

:::{.question}
When do two $f'$s give the same $B'$?
:::


We have $\eps f' = \eps f$, so $\eps f \in (f')$ and we can modify $g$ by any $cf$ where $c\in S$, where only the equivalence class $g\in S/(f)$ matters.
Now consider $\aut(B \injects B')$, i.e. maps of the form
\[
x &\mapsto x + \eps a \\
y &\mapsto y + cb
\]
for $a, b\in S$.
Under this map,
\[
f_0' 
= f + \eps g \mapsto & f(x + \eps a, y + \eps b) + \eps g(x ,y) \\ \\
&\Downarrow \quad\text{implies} \\ \\
f(x, y) &= \eps a \dd{}{x} f + \eps b \dd{}{y} f + \eps g(x ,y)
,\]
so in fact only the class of $g\in S/(f, \del_{x} f, \del_{y} f)$.
This is the ideal of the singular locus, and will be Artinian (and thus finite-dimensional) if the singularities are isolated, which implies H3.
We can in fact exhibit the miniversal family explicitly by taking $g_{i} \in S$, yielding a basis of the above quotient.
The hull will be given by setting $R = \CC[[t_{1}, \cdots, t_{m} ]]$ and taking the locus $V(f + \sum t_{i} g_{i}) \subset \AA_{R}^2$.

:::{.example title="simple"}
For $f = xy$, then the ideal is $I = (xy, y, x) = (x, y)$ and $C/I$ is 1-dimensional, so the miniversal family is given by $V(xy + t) \subset \CC[[t_{1}]][x, y]$.
The greater generality is needed because there are deformation functors with a hull but no universal families.
:::

[^nakayama_rmk]: 
Recall that by Nakayama, a nonzero module tensor $k$ can not be zero.


# Tuesday April 14th

Recall that we are looking at $(X_{0})_{/k}$ and $F: \Art_{/k} \to \sets$ where $A$ is sent to $X_{/A}$ flat with $i: X_{0} \injects X$ where $i\tensor k$ is an isomorphism.
The second condition is equivalent to a cartesian diagram

\begin{tikzcd}
  X_{0} 
  \ar[r, hook]
  \ar[d] 
  \arrow[dr, phantom, "\scalebox{1.5}{$\ulcorner$}" , very near start, color=black]
& X 
  \ar[d] 
\\
  \spec k 
  \ar[r, hook] 
& \spec A
\end{tikzcd}


We showed we always have H1 and H2, and H3 if $X_{0}/k$ is projective or $X_{0}$ is affine with isolated singularities.
In this situation we have a miniversal family.
This occurs iff for $A' \to A$ a small thickening and $(X_{0} \injects X) \in F(A)$, we have a surjection
\[
\Aut_{A'}(X_{0} \injects X') \surjects \Aut_{A}(X_{0} \injects X)
.\]

where the RHS are automorphisms of $X_{/A}$, i.e. those which commute with the identity on $A$ and $X_{0}$.
We had a naive functor $F_{n}$ where we don't include the inclusion $X_{0} \injects X$.
When $F$ has a hull then the naive functor has a versal family, since there is a forgetful map that is formally smooth.
If it's the case that for all $A' \to A$ small and $F_{\text{n}} \to F_{n}(A)$ we have $\Aut_{A'}(X') \surjects \Aut_{A} (X)$, then $F = F_{n}$ and both are pro-representable.
The forgetful map is smooth because given $X_{/A}$ in $F_{n}(A)$, we have some inclusion $X_{0} \injects X$, so one gives surjectivity.
Using the surjectivity on automorphisms, we get

\begin{tikzcd}
X_{0}\ar[rd, hook] \ar[rr, hook] & & X\ar[ld, dotted] \\
& X & 
\end{tikzcd}


Deformation theory is better at answering when the following diagrams exist:


\begin{tikzcd}
X 
  \ar[r, dotted, hook, "\exists?"] 
  \ar[d]
  \arrow[dr, phantom, "\scalebox{1.5}{$\ulcorner$}" , shift right=0.4em, very near start, color=black]
& 
X'
  \ar[d, dotted, "\exists?"] 
\\
\spec A
  \ar[r]
& 
\spec A' 
\end{tikzcd}


i.e., the existence of an extension of $X$ to $A'$.
This is different than understanding diagrams of the following type,
where we're considering isomorphism classes of the squares, and deformation theory helps understand the blue one:

\begin{tikzpicture}
[
	greenbox/.style={
		draw=green, fill=green!3,  thick, rounded corners, rectangle
	},
	redbox/.style={
		draw=red, fill=red!3,  thick, rounded corners, rectangle
	},
]

\node[
	greenbox,	
	minimum height=0.9cm,
	minimum width=1.2cm	
] 
at (-0.1, 1.3) {};

\node[
	redbox,	
	minimum height=0.9cm,
	minimum width=1.2cm	
] 
at (2.35, 1.3) {};

\node[
	greenbox, 
	minimum height=2.4cm,
	minimum width=8.2cm	
] 
at (0, -0.5) {};

\node[
	draw=red,  thick, rectangle,
	minimum height=0.8cm,
	minimum width=1.2cm	
] 
at (-1.2, -0.6) {};

\node[
	draw=blue,  thick, rectangle, dotted,
	minimum height=0.8cm,
	minimum width=1.2cm	
] 
at (1.2, -0.6) {};

\node at (0, 0) {%
\begin{tikzcd}
& F(A')
	\ar[r]
& F(A)
\\
X_0
	\ar[r, hook]
	\ar[d]
& X
	\ar[r, hook]
	\ar[d]
& X'
	\ar[d]
\\
\spec k
	\ar[r]
& \spec A
	\ar[r]
& \spec A'
\end{tikzcd}
};

\end{tikzpicture}




:::{.example title="Hypersurface Singularities"}
Take $S = k[x, y]$ and $B = S/(f)$, then deformations of $\spec B$ to ?
Given $k \to k[\eps] \to k$ we can tensor[^tensor_up_to_iso]
to obtain

\begin{tikzcd}
	{0} & {B} & {B'} & {B} & {0} \\
	{0} & {S} & {S[\eps]} & {S} & {0} \\
	{0} & {I} & {I'} & {I} & {0} \\
	&& {\tiny \gens{f'}} & {\tiny \gens{f}}
	\arrow[from=3-1, to=3-2]
	\arrow[from=3-2, to=3-3]
	\arrow[from=3-3, to=3-4]
	\arrow[from=3-4, to=3-5]
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow[from=1-3, to=1-4]
	\arrow[from=1-4, to=1-5]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-3, to=2-4]
	\arrow[from=2-4, to=2-5]
	\arrow[from=3-2, to=2-2]
	\arrow["{\pi}", from=2-2, to=1-2]
	\arrow[from=3-3, to=2-3]
	\arrow["{\pi'}", from=2-3, to=1-3]
	\arrow[from=3-4, to=2-4]
	\arrow["{\pi}", from=2-4, to=1-4]
	\arrow["{\subseteq}" description, from=4-3, to=3-3, no head]
	\arrow["{\subseteq}" description, from=4-4, to=3-4, no head]
\end{tikzcd}


> [Link to diagram.](https://q.uiver.app/?q=WzAsMTcsWzAsMCwiMCJdLFsxLDAsIkIiXSxbMiwwLCJCJyJdLFszLDAsIkIiXSxbNCwwLCIwIl0sWzAsMSwiMCJdLFsxLDEsIlMiXSxbMiwxLCJTW1xcZXBzXSJdLFs0LDEsIjAiXSxbNCwyLCIwIl0sWzAsMiwiMCJdLFszLDEsIlMiXSxbMSwyLCJJIl0sWzMsMiwiSSJdLFsyLDIsIkknIl0sWzIsMywiXFxnZW5ze2YnfSJdLFszLDMsIlxcZ2Vuc3tmfSJdLFsxMCwxMl0sWzEyLDE0XSxbMTQsMTNdLFsxMyw5XSxbMCwxXSxbMSwyXSxbMiwzXSxbMyw0XSxbNSw2XSxbNiw3XSxbNywxMV0sWzExLDhdLFsxMiw2XSxbNiwxLCJcXHBpIl0sWzE0LDddLFs3LDIsIlxccGknIl0sWzEzLDExXSxbMTEsMywiXFxwaSJdLFsxNSwxNCwiXFxzdWJzZXRlcSIsMSx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMTYsMTMsIlxcc3Vic2V0ZXEiLDEseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV1d)

![Diagram](figures/image_2020-04-14-12-55-58.png){width=350px}

We want to understand $F(k[\eps])$.
We know $f' = f + \eps g$ for some $g\in S$.

:::{.observation}
\envlist

1. $g\in B$ and $f'' = f + \eps(g + cf)$ generates the same ideal.
2. We're free to reparameterize, i.e. $x \mapsto x + \eps a$ and $y \mapsto y + \eps b$ and thus  
\[
g \mapsto g + a f_{x} + b f_{y}
\]
, i.e. the partial derivatives.

:::

Thus isomorphism classes of $B'$ in deformations $B' \to B$ only depend on the isomorphism classes $g\in B/(f_{x}, f_{y}) B$.
When the singularities are isolated, this quotient is finite-dimensional as a $k\dash$vector space.

[^tensor_up_to_iso]: 
For flat maps, tensoring up to an isomorphism implies isomorphism.

:::



:::{.example title="?"}
$F(k[\eps]) = B/(f_{x}, f_{y})B$.
Thus H3 holds and there is a miniversal family $h_{R} \to F$.
We can describe it explicitly: take $g_{i} \in S$, yielding a $k\dash$basis in $S/(f, f_{x}, f_{y})$.
Then 
\[
V(f + \sum t_{i} g_{i}) \subset \spec k[[t_{1}, \cdots, t_{n}]][x, y]
.\]
Set $R = k[[t_{1}, \cdots, t_{n}]]$, then this lands in $\AA_{R}^2$.
:::


:::{.example title="?"}
The nodal curve $y^2 = x^3$, take .
\[
S/(y^2-x^3, 2y, -3x^2) = S/(y, x^2)
.\]
So take $g_{1} = 1, g_{2} = x$, then the miniversal family is .
\[
V(y^2 - x^3 + t + t_{2} x) \subset \AA^2_{k[[t_{1}, t_{2}]]}
.\]
This gives all ways of smoothing the node.
:::


:::{.remark}
Note that none of these are pro-representable. 
:::

Given $X$ and $A$, we obtain a miniversal family over the formal spectrum $\mathrm{Spf}(R) = (R, \xi)$ and a unique map:

![Diagram](figures/image_2020-04-14-13-10-21.png){width=350px}

We can take two deformations over $A = k[\xi]/ S^n$:

- $X_{1} = V(x + y)$??
- $X_{2} = V(x + uy)$??

As deformations over $A$, $X_{1} \cong X_{2}$ where we send , 
\[
s&\mapsto s, \\
y&\mapsto y, \\
x&\mapsto ux
.\]
since
\[
(xy + us) = (uxy + us) = (u(xy + s)) = (xy + s)
.\]
But we have two different classifying maps, which do commute up to an automorphism of $A$, but are not equal.
Since they pullback to different elements (?), $F$ can not be pro-representable.

![Diagram](figures/image_2020-04-14-13-20-05.png){width=350px}

So reparameterization in $A$ yield different objects in $F(A)$.
In other words, $\mcx \to \mathrm{Spf}(R)$ has automorphisms inducing reparameterizations of $R$.
This indicates why we need maps restricting to the identity.

## The Cotangent Complex 

For $X \mapsvia{f} Y$, we have $L_{X/Y} \in D \qcoh(X)$, the derived category of quasicoherent sheaves on $X$.
This answers the extension question:


:::{.answer}
For any square-zero thickening $Y \injects Y'$ (a closed immersion) with ideal $I$ yields an $\OO_{Y}\dash$module.


1. An extension exists iff $0 = \mathrm{obs} \in \ext^2(L_{X/Y}, f^* I)$
2. If so, the set of ways to do so is a torsor over this ext group.
3. The automorphisms of the completion are given by $\hom(L_{X/Y}, f^* I)$.
:::


:::{.remark}
Some special cases:
$X \to Y$ smooth yields $L_{X/Y} = \Omega_{X/Y}[0]$ concentrated in degree zero.
:::

:::{.example title="?"}
$Y = \spec k$ and $Y' = \spec k[\eps]$ yields
\[
\mathrm{obs} \in \Ext_{x}^2(\Omega_{X/Y}, \OO_{x})= H^2(T_{X_{/k}})
.\]

For $X\injects Y$ is a regular embedding (closed immersion and locally a regular sequence) $L_{X/Y} = \qty{I/I^2}[1]$, the conormal bundle.

![Diagram](figures/image_2020-04-14-13-32-13.png){width=350px}

:::


:::{.example title="?"}
For $Y$ smooth, $X \injects Y$ a regular embedding, $L_{X_{/k}} = \Omega_{X_{/k}}$ with $\mathrm{obs}/\mathrm{def} = \Ext^{2/1}(\Omega_{x}, \OO)$ and the infinitesimal automorphisms are the homs.
:::


:::{.example title="?"}
For $Y = \spec k[x, y] = \AA^2$ and $X = \spec B = V(f) \subset \AA^2$ we get
\[
0 \to I/I^2 \to \Omega_{X_{/k}} \tensor B &\to \Omega_?{X_{/k}} \to 0 \\ \\
& \Downarrow \quad \text{equals} \\ \\
0 \to B \mapsvia{1 \mapsto (f_{x}, f_{y})} &B^2 \to \Omega_{B_{/k}} = L_{X_{/k}} \to 0
.\]

Taking $\hom(\wait, B)$ yields

\begin{tikzcd}
0 
  \ar[r]
& \hom(\Omega, B) 
  \ar[r]
& B^2 
  \ar[lld, "{(f_{x}, f_{y})^t}"]
\\
  \Ext^1(\Omega, B) 
  \ar[r]
& 0 
  \ar[r] 
& 0 
  \ar[lld]
\\
  \Ext^2(\Omega, B) 
  \ar[r] 
& 0 
  \ar[r] 
& 0
\end{tikzcd}

So , 
\[
\mathrm{obs} &= 0 \\ 
\mathrm{def} &= B/(f_{x}, f_{y})B \\
\aut &\neq 0
.\]
and 
:::


:::{.remark}
We have the following obstruction theories:

- For abstract deformations, we have 
\[
X_{0} {}_{/k} \text{ smooth } \implies 
\aut/\mathrm{def}/\mathrm{obs} = H^{0/1/2}(T_{X_{0}})
.\]

- For embedded deformations, $Y_{0}/k$ smooth, $X_{0} \injects Y_{0}$ regular, we have
\[
\aut/\mathrm{def}/\mathrm{obs} = 0, H^{0/1}(N_{X_{0}/Y_{0}})
.\]
  
  > As an exercise, interpret this in terms of $L_{X_{0}/Y_{0}}$.

- For maps $X_{0} \mapsvia{f_{0}} Y_{0}$, i.e. maps 
\[
X_{0} \cross k[\eps] \mapsvia{f} Y_{0} \cross k[\eps]
.\]
we consider the graph $\Gamma(f_{0}) \subset X_{0} \cross Y_{0}$.

![Diagram](figures/image_2020-04-14-13-43-40.png){width=350px}

Since all of these structures are special cases of the cotangent complex, they place nicely together in the following sense:
Given $X \injects_{i} Y$ we have
\[
0 \to T_{X} \to i^* T_{Y} \to N_{X/Y} \to 0
.\]

Yielding a LES
\[
0 &\to H^0(T_{X}) \to H^0(i^* T_{Y}) \to H^0(N_{X/Y}) \\
&\to H^1(T_{X}) \to H^1(i^* T_{Y}) \to H^1(N_{X/Y}) \\
&\to H^2(T_{X}) 
.\]

![Diagram](figures/image_2020-04-14-13-47-05.png){width=350px}

:::

:::{.exercise title="?"}
Consider $X \subset \PP^3$ a smooth quartic, and show that $\mathrm{def}(X) \cong k^{20}$ but $\mathrm{def}_{\text{embedded}} \cong k^{19}$.
This is a quartic K3 surface for which deformations don't lift (non-algebraic, don't sit inside any $\PP^n$).
:::


> Next time:
> Obstruction theory of sheaves, T1 lifting as a way to show unobstructedness.

# Characterization of Smoothness (Thursday April 16th)

> Recap from last time: the cotangent complex answers an extension problem.

Given $X \mapsvia{f} Y$ and $Y \injects Y'$ a square zero thickening.
When can the pullback diagram be filled in?

\begin{tikzcd}
  X  
  \ar[r, dotted] 
  \ar[d] \arrow[dr, phantom, "\scalebox{1.5}{\color{black}$\lrcorner$}" , very near start, color=black]
& X' 
  \ar[d, dotted] 
\\
  Y 
  \ar[r] 
& Y'
\end{tikzcd}

- The existence is governed by $\mathrm{obs} \in \Ext^2( L_{X/Y}, f^* I)$
- The number of extensions by $\Ext^1( L_{X/Y}, f^* I)$
- The automorphisms by $\Ext^0( L_{X/Y}, f^* I)$

Suppose we're considering $k[\eps] \to k$, where $L_{X_{/k}} = \Omega_{X_{/k}}$, and $H^*(T_{X_{/k}})$ houses the obstruction theory.
For an embedded deformation $X \injects Y$, we have

\begin{tikzcd}
X  
  \ar[r, dotted]
& X' 
  \ar[d, dotted] 
\\
Y 
  \ar[r] 
& Y \cross_{\spec k} \spec k[\eps]
\end{tikzcd}

then $L_{X/Y} = I/I^2 [1] = N_{X/Y}\dual[1]$ and
\[
\mathrm{obs} \in \ext^2(N\dual[1], \OO) = \Ext^1(N\dual, \OO) = H^1(N)
.\]
and similarly $\mathrm{def} = H^0(N)$ and $\aut = 0$.
For $X \mapsvia{f} Y$, we can think of this as an embedded deformation of $\Gamma \subset X \cross Y$, in which case $N\dual = F^* \Omega_{Y_{/k}}$.
Then $\mathrm{obs}, \mathrm{def} \in H^{1, 0}(f^* T_{X_{/k}})$ respectively and $\aut = 0$.
There is an exact triangle
\[
f^* L_{Y_{/k}} \to L_{X_{/k}} \to L_{X/Y} \to f^* L_{Y_{/k}}[1]
.\]

## T1 Lifting

This will give a criterion for a pro-representable functor to be smooth.
We've seen a condition on $F$ with obstruction theory for the hull to be smooth, namely $\mathrm{obs}(F) = 0$.
However, often $F = h_{R}$ will have $R$ smooth with a natural obstruction theory for which $\mathrm{obs}(F) \neq 0$.


:::{.example title="?"}
For $X_{/k}$ smooth projective, the picard functor $\pic_{X_{/k}}$ is smooth because we know it's an abelian variety.
We also know that the natural obstruction space is $\mathrm{obs} = H^2(\OO_{X})$, which may be nonzero.
We could also have abstract deformations given by $H^2(T_{X})$

Given $A \in \Art_{/k}$ and $M$ a finite length $A\dash$module, we can form the ring $A \oplus M$ where $M$ is square zero and $A\actson M$ by the module structure.
This yields
\[
0 \to M \to A \oplus M \to A \to 0
\]

The explicit ring structure is given by $(x, y) \cdot (x, y') = (xx', x'y + xy')$.
:::



:::{.proposition title="Characterization of Smoothness"}
Assume $\ch k =0$ and $F$ is a pro-representable deformation functor, so $F = \hom(R, \cdot)$ where $R$ is a complete local $k\dash$algebra with $\dim t_{R} < \infty$.

Then $R$ is smooth[^smoothness_reminder]
over $k$
$\iff$ 
for all $A\in \Art_{/k}$ and all $M, M' \in A\dash\text{mod}$ finite dimensional with $M \surjects M'$, we have

\[
F(A\oplus M) \surjects F(A\oplus M')
.\]


[^smoothness_reminder]: 
I.e. $R \cong k[[t_{R}\dual]]$.

:::

### Proof of Proposition 


:::{.observation}
First observe that $\ker(F(A\oplus M) \to F(A)) = \ker(\hom(R, A\oplus M) \to \hom(R, A))$, note that if we have two morphisms 

\begin{tikzcd}
R 
  \ar[r] 
& 
R
  \ar[r, shift left=0.75ex, "g \oplus g"] 
  \ar[r, shift right=0.75ex, "f \oplus g'"'] 
& 
A \oplus M
\end{tikzcd}

denoting these maps $h, h'$ we have

1. $g-g' \in \Der_{k}(R, M)$, since 
\[
(h-h')(x, y) 
&= h(x)h(y) - h'(x) h'(y) \\
&= (f(x)f(y), f(x)g(y) + f(y)g(x) )  - (f(x)f(y), f(x) g'(y) + f(y) g'(x)) \\
&= f(x)(g-g')(y) + f(y)(g-g')(x)
.\]

2. Given $g: R\to A\oplus M$ and $\theta \in \Der_{k}(R, M)$, then $g + \theta: R \to A\oplus M$.

:::

We conclude that the fibers are naturally torsors for $\Der_{k}(R, M)$ if nonempty.
It is in fact a canonically trivial torsor, since there is a distinguished element in each fiber.
Thus to show the following,
it is enough to show surjection on fibers and trivial extensions go to trivial ones, then $\Der_{k}(R, M) \to \Der_{k}(R, M')$ with $0\mapsto 0$.

\begin{tikzcd}
F(A\oplus M) 
  \ar[rr]
  \ar[rd]
& 
& F(A\oplus M') 
  \ar[ld]
\\
& F(A) 
&
\end{tikzcd}

The criterion for $F$ being surjective is equivalent to 
\[
\Der_{k}(R, M) &\surjects \Der_{k}(R, M') \\ \\
&\Downarrow \qquad \text{identified as }\\ \\
\hom_{R}(\Omega_{R_{/k}}, M) &\surjects \hom(\Omega_{R_{/k}'}, M')
.\]

:::{.warnings}
$\Omega_{R_{/k}}$ is complicated.
An example is 
\[
\Omega_{k[[x]]/k} \tensor k((x)) = \Omega_{k((x))/k}
.\]
which is an infinite dimensional $k((x))$ vector space.
:::

Here we only need to consider the completions $\hom_{R}(\hat \Omega_{R_{/k}}, M) \surjects \hom(\hat \Omega_{R_{/k}'}, M') = k[[x]]~dx$.


:::{.fact}
In characteristic zero, $R?k$ is smooth iff $\hat \Omega_{R_{/k}}$ is free.
:::
  
Thus the surjectivity condition is equivalent to checking that $\hom(\hat \Omega_{R_{/k}}, \wait)$ is right-exact on finite length modules.
This happens iff $\hat \Omega$ are projective iff they are free.


:::{.fact title="from algebra"}
Uses an algebra fact: for a complete finitely-generated module $M$ over a complete ring, then $M$ is free if $M$ projective with respect to sequences of finite-length modules.
Over a local ring, finitely-generated and projective implies free.
:::


:::{.remark}
This is powerful -- allows showing deformations of Calabi-Yaus are unobstructed!
:::


:::{.definition title="Calabi-Yau"}
A smooth projective $X_{/k}$ is **Calabi-Yau** iff
\[
\omega_{x} \cong \OO_{x}
,\]
i.e. the canonical bundle is trivial.
:::




:::{.proposition title="?"}
$X_{/k}$ CY with $H^0(T_{X}) = 0$ (implying that the deformation functor $F$ of $X$ is pro-representable, say by $R$, and has no infinitesimal automorphisms) has unobstructed deformations, i.e. $R$ is smooth of dimension $H^1(T_{X})$.

:::

Note that $H^2(T_{X}) \neq 0$ in general, so this is a finer criterion.


:::{.example title="?"}
Take $X \subset \PP^4$ a smooth quintic threefold.

- By adjunction, this is Calabi-Yau since
\[
\omega_{x} = \omega_{\PP^4}(5) \mid_{X} = \OO_{x}
.\]

- By Lefschetz,
\[
H^i_\mathrm{sing} (\PP^4, \CC) 
&\mapsvia{\cong} 
H^i_{\mathrm{sing}}(X, \CC)
&& \text{except in middle dimension} \\ \\
&\Downarrow \quad \text{ implies} \\ \\
H^{3, 1} 
&= H^{1, 3} = 0
.\]

- By Serre duality,
\[
H^0(T_{x}) &= 0 \cong H^4(\Omega_{x} \tensor \omega_{x}) \\ \\
&\Downarrow \quad\text{implies} \\ \\
H^3(\Omega_{x}) &= H^{3, 1} = 0
.\]

:::

:::{.exercise title="?"}
There are nontrivial embedded deformations that yield the same abstract deformations, write them down for the quintic threefold.
:::

:::{.claim}
The abstract moduli space here is given by $\PGL(5) \sm \hilb$ where $\hilb$ is smooth.
:::

### Proof that obstructions to deformations of Calabi-Yaus are unobstructed

We need to show that for any $M \surjects M'$ that
\[
F(A\oplus M) \surjects F(A\oplus M')
.\]
The fibers of the LHS are extensions from $A$ to $A\oplus M$, and the RHS are extensions of $X/A$?
By dualizing, we need to show $H^1(T_{X/A}\tensor M ) \surjects H^1(T_{X/A} \tensor M')$ since the LHS is $\ext^1(\Omega_{X/A}, M)$.
We want the bottom map here to be surjective:

\begin{tikzcd}
  X  
  \ar[d]
& X' 
  \ar[d] 
\\
  \spec A 
  \ar[r, hook] 
& \spec A \oplus M
\end{tikzcd}


:::{.fact title="Important"}
For $X/A$ a deformation of a CY, $H^*(T_{X/A})$ is free.
This will finish the proof, since the map is given by $H^1(T_{X/A}) \tensor M \surjects H^1(T_{X/A}) \tensor M'$ by exactness.
This uses the fact that there's a spectral sequence
\[
\Tor_{q}(H^p(T_{X/A}), M) \implies H^{p+q} (T_{X/A} \tensor M)
\]
which follows from base change and uses the fact that $T_{X/A}$ is flat.
:::


We'll be looking at $\Tor_{1}(H^0(T_{X/A}), M)$ which is zero by freeness.
Hodge theory is now used: by Deligne-Illusie, for $X\mapsvia{f} S$ smooth projective, taking pushforwards $R^p f_* \Omega^q_{X_{/S}}$ are free (coming from degeneration of Hodge to de Rham) and commutes with base change.


:::{.remark}
This implies that $\omega_{X/A} = \OO_{X}$ is trivial.
Using Deligne-Illusie, since $\omega$ is trivial on the special fiber, $H^0(\omega_{X/A}) = A$ is free of rank 1.
We thus have a section $\OO_{X} \to \omega_{X/A}$ which is an isomorphism by flatness, since it's an isomorphism on the special fiber.
:::


:::{.remark}
By Serre duality, $H^1(T_{X/A}) = H^{n-1}(\Omega_{X/A} \tensor \omega_{X/A}) \dual = H^{n-1}(\Omega_{X/A})\dual$, which is free by Deligne-Illusie.
  This also holds for $H^0(T_{X/A}) = H^n(\Omega_{X/A})\dual$ is free.
:::

Thus deformations of Calabi-Yaus are unobstructed.

### Remarks

:::{.remark}
In fact we need much less.
Take $A_{n} = k[t] / t^n$, then consider

\begin{tikzcd}
0
  \ar[r]
& A_n   
  \ar[r]
& A_n[\eps]
  \ar[r]
& A_n \\
0
  \ar[r]
  \ar[u, equal]
& A_n   
  \ar[r]
  \ar[u, equal]
& A_n \oplus \eps A_n
  \ar[r]
  \ar[u, equal]
& A_n 
  \ar[u, equal]
\end{tikzcd}

For a deformation $X/A_{n}$, let $T^1(X/A_{n}) = \ker(F(A_{n}[\eps]) \to F(A_{n}) )$, the fiber above $X/A_{n}$.
Then Kuramata shows that one only needs to show surjectivity for these kinds of extensions, which is quite a bit less.
:::

In the T1 lifting theorem, the condition is equivalent to the following:
For any deformation $X/A_{n+1}$, there is a map
\[
T^1(X/A_{n+1}) \to T^1(X\tensor A_{n} / A_{n})
.\]
and surjectivity is equivalent to the lifting condition.
In the CY situation, the extension group $T^1(X/A_{n+1}) =  H^1(T_{X/A_{n+1}})$ and the RHS is $H^1(T_{X\tensor A_{n} / A_{n}})$.
So the slogan for the T1 lifting property is the following:

:::{.slogan}
If the deformation space is free and commutes with base change, then deformations are unobstructed.
:::

Commuting with base change means the RHS is $H^1(T_{X/A_{n}}) \tensor A_{n}$, so we just need to show it's free?

# Monday April 27th

## Principle of Galois Cohomology

Let $\ell_{/k}$ a galois extension and $X_{/k}$ some "object" for which it makes sense to associate another object over $\ell$.
We'll prove that there's a correspondence
\[
\correspond{
\ell_{/k}, \text{ twisted forms} \\
Y \text{ of } X_{/k}
}
&\mapstofrom
H^1(\ell_{/k}, \aut(X_{/\ell}))
.\]



Recall that $\PGL(n ,\ell) \da \GL(n ,\ell) / \ell\units$.

:::{.example title="?"}
Let $X = \PP^{n-1}/k$, then $H^1(\ell_{/k}, \PGL(n, \ell)$ parameterizes twisted forms of $\PP^{n-1}$, e.g. for $n=2$ twisted forms of $\PP^1$ and plane curves.
:::


:::{.example title="?"}
Take $X = M_{n}(k)$ the algebra of $n\times n$ matrices.
Then by a theorem (Skolern-Noether) $\aut(M_{n}(k)) = \PGL(n, k)$.
Thus $H^1(\ell_{/k}, \PGL(n, k))$ also parameterizes twisted forms of $M_{n}(k)$ in the category of unital (not necessarily commutative) $k\dash$algebras.
These are exactly central simple algebras $A_{/k}$ where $\dim_{k} A = n^2$ with center $Z(A) = k$ with no nontrivial two-sided ideals.
By taking \(\ell = k^{s} \), we get a correspondence
\[
\correspond{\text{CSAs} A_{/k} \text{ of degree } n} 
&\mapstofrom
\correspond{\text{ Severi-Brauer varieties of dimension n-1} }
.\]
Taking $n=2$ we obtain
\[
\correspond{\text{Quaternion algebras } A_{/k}} 
&\mapstofrom
\correspond{\text{Genus 0 curves } \ell_{/k}}
.\]

:::

## The Weil Descent Criterion

Fix $\ell_{/k}$ finite Galois with $g \da \aut(\ell_{/k})$.

1. $X_{/k} \to X_{/\ell}$ with a $g\dash$action.

2. What additional data on an $\ell\dash$variety $Y_{/\ell}$ do we need in order to "descend the base" from $\ell$ to $k$?

For $\sigma \in g$, write $\ell^\sigma$ to denote $\ell$ given the structure of an $\ell\dash$algebra via $\sigma: \ell \to \ell^\sigma$.
If $X_{/\ell}$ is a variety, so is $X^\sigma_{/\ell}$?

\begin{tikzcd}
X^\sigma\ar[dr, dotted] \ar[r]\ar[d] & X \ar[d] \\
\spec \ell^\sigma \ar[r, "f"] & \spec \ell
\end{tikzcd}


where $f$ is the map induced on $\spec$ by $\sigma$.
We can also think of these on defining equations:
\[
X     &= \spec \ell[t_{1}, \cdots, t_{n}] / \gens{p_{1}, \cdots, p^n} \\
X^\sigma &= \spec \ell[t_{1}, \cdots, t_{n}] / \gens{\sigma_{p_{1}}, \cdots, \sigma{p^n}} \\
.\]

For $X_{/k}, X_{/\ell}$, we canonically identify $X$ with $X^\sigma$ by the map $f_\sigma: X \mapsvia{\cong} X^\sigma$, a canonical isomorphism of $\ell\dash$varieties.
We thus have

\begin{tikzcd}
X \ar[r, "f_\sigma"] \ar[rr, bend left, "f_{\sigma \tau}"] & X^\sigma \ar[r, "f_\sigma"] & X^{\sigma \tau}
\end{tikzcd}


under a "cocycle condition" $f_{\sigma \tau} = {}^\sigma f_\tau \circ f_\sigma$.


:::{.theorem title="Weil"}
Given $Y_{/\ell}$ quasi-projective and $\forall \sigma \in g$ we have descent datum $f_\sigma: Y\mapsvia{\cong} Y^\sigma$ satisfying the above cocycle condition, and there exists a unique $X_{/k}$ such that $X_{/\ell} \mapsvia{\cong} Y_{/\ell}$ and the descent data coincide.
:::


### An Application

Let $X_{/k}$ be a quasiprojective variety and $Y_{/k}$ and $\ell_{/k}$ twisted forms.
Then $a_{0} \in Z' (\ell_{/k}, \aut X)$.
Conversely, we have the following:

:::{.definition title="Twisted Descent Data"}
Let $a_{0}$ be such a cocycle and $\theset{s_\sigma: X\to X^\sigma}$ be descent datum attached to $X$.
Define twisted descent datum $g_\sigma \da f_\sigma \circ a_\sigma$ from
\[
X /\ell\mapsvia{a_\sigma} X_{/\ell} \mapsvia{f_\sigma} X^\sigma / \ell
.\]
:::


:::{.exercise title="?"}
Check that $g_\sigma$ satisfies the cocycle condition, so by Weil uniquely determines a ($k\dash$model) $Y_{/k}$ of $X_{/\ell}$.
:::



:::{.example title="?"}
Let $G_{/k}$ be a smooth algebraic group and $X_{/k}$ a torsor under $G$.
Then $\Aut(G) \supset \aut_{G\dash\text{torsor}} (G) = G$, since in general the translations will only be a subgroup of the full group of automorphisms.
Then
\[
H^1(\ell_{/k}, G) \to H^1(\ell_{/k}, \aut G)
\]
defines a twisted form $X$ of $G$.
How do you descend the torsor structure? 
This is possible, but not covered in Bjoern's book!
This requires expressing the descent data more functorially -- see the book on Neron models.
:::

## The Cohomology Theory

### Motivation

Let $G_{/k}$ be a smooth connected commutative algebraic group where $\ch k$ does not divide $n$, so the map $[n]: G \to G$ is an isogeny.
Then
\[
0 \to G[n] (k^{s} ) \to G(k^{s} ) \mapsvia{[n]} G(k^{s} ) \to 0
\]
is a SES of $g = \aut(k^{s}_{/k})\dash$modules.

:::{.claim}
Taking the associated cohomology sequence yields the Kummer sequence:
\[
0 \to G(k) / nG(k) \to H^1(k, G[n]) \to H^1(k, G)[n] \to 0
\]
where the RHS is the **Weil–Châtelet** group and the LHS is the **Mordell-Weil** group.
:::

For $g$ a profinite group, a commutative discrete $g\dash$group is by definition a $g\dash$module.
These form an abelian category with enough injectives, so we can take right-derived functors of left-exact functors.
We will consider the functor 
$$
A \mapsto A^g \da \theset{x\in A \suchthat \sigma x = x ~\forall \sigma\in g}
,$$
then define $H^i(g, A)$ to be the $i$th right-derived functor of $A \mapsto A^\sigma$.
This is abstractly defined by taking an injective resolution, applying the functor, then taking cohomology.
A concrete description is given by $C^n(g, A) = \Map(g^n, A)$ with
\[
d: C^n(g, A) &\to C^{n+1}(g, A) \\
(df)(\sigma_{1}, \cdots, \sigma_{n+1} 
&\da 
\sigma_{1} f(\sigma_{2}, \cdots, \sigma_{n+1}) \\
&\qquad + \sum_{i=1}^n (-1) f(\sigma _1, \cdots, \sigma_{i-1}, \sigma_{i}, \sigma_{i+1}, \cdots, \sigma_{n+1}) \\
&\qquad + (-1)^{n+1} f(\sigma_{1}, \cdots, \sigma_{n})
.\]
Then $d^2 = 0$, $H^n$ is kernels mod images, and this agrees with $H^1$ as defined before with $H^0 = A^g$.
We'll see that that
\[
H^i(g, A) = \directlim_{U} G^i(g/U, A^U)
.\]
If $g$ is finite, $A$ is a $g\dash$module $\iff$ $A$ is a $\ZZ[g]\dash$module, and thus
\[
A^g = \hom_{\ZZ[g]\dash\text{mod}}(\ZZ, A)
.\]
where $\ZZ$ is equipped with a trivial $g\dash$action.
We can thus think of 
\[
H^i(g, A) = \ext^i_{\ZZ[g]}(\ZZ, A)
.\]

> The end!

