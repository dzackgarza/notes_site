# Friday February 14th

Let $R$ be a ring and consider $K_0(R)$.

> Measures difference between f.g. projective and free modules over $R$.

Define $(M(R), +) \definedas$ the commutative monoid of isomorphism classes of f.g. projective $R\dash$modules with addition given by direct sum, i.e. $[P] + [Q] = [P\oplus Q]$ with identity the zero modules, and $K_0(R) = G((M(R), +))$ is the group completion, which any map $M(R) \to G$ a group factors through.

Concretely, any element of $K_0(R)$ is of the form $[P] - [Q]$, where 
$$
[P_1] -[Q_1] \sim [P_2] - [Q_2] \iff [M] + [P_1] + [Q_2] = [M] + [P_2] + [Q_2]
$$ 
for every finitely generated projective $R\dash$ module $M$.
Note that excluding the $R$ here fails transitivity and thus doesn't yield an equivalence relation.

If $P, Q$ are finitely generated projective $R\dash$modules, then $[P] = [Q]$ iff $\exists M$ such that $P \oplus M \cong Q \oplus M$ iff there exists $N$ a finitely generated projective such that $M\oplus N \cong R^n$ for some $n$, i.e. $P \oplus R^n \cong Q\oplus R^n$.
In such a case, we say $P, Q$ are *stably isomorphic*.

Note that $[P] = 0$ iff $[P]$ has rank zero, or $[P] \oplus R^n \cong R^n$.
Also note that $[P] \cong [Q]$ can occur without necessarily having $P\cong Q$ as modules.

We can actually make $K_0(R)$ into a ring with $[P] \cdot [Q] \definedas [P \tensor_R Q]$.

> Note that the tensor product of two finitely-generated $R\dash$modules is still finitely generated as an $R\dash$module.

*Example:*
Let $R$ be a PID, then $M(R)$ is a commutative semiring (no additive inverses) and is equal to $(\NN, +, \cdot)$ (occurs whenever )very finitely generated projective is free).
Similarly $G(R) = (\NN, +, \cdot)$.
Since $R$ has invariant basis number, there is always an injective group morphism

\begin{align*}
(\ZZ, +) &\mapsto (K_0(R), +) \\
n &\mapsto [R^n]
.\end{align*}

> Yields no cancellation among free modules.
> We want to essentially ignore this case, so we'll mod out.

Definition (Reduced $K$ Group)
: The reduced $K$ group is given by $\tilde{K_0(R)} \definedas (K_0(R), +) / (\ZZ, +)$.

Note that $[P] = [G]$ in $\tilde{K_0(R)}$ iff there exist $m, n$ such that $P \oplus R^m \cong Q \oplus R^n$.
Moreover $[P] = 0$ iff $\exists m, n$ such that $P \oplus R^n \cong R^n$.
In this case we say $P$ is *stably free*.

Exercise
: If $P$ is a projective module (possibly not finitely generated) then there exists a free module $F$ such that $P\oplus F$ is free.

Example
: For $n\in \ZZ$, define $R_n \definedas \RR[t_0, \cdots, t_n] / \generators{\sum t_i^2 - 1}$.
  This is the ring of polynomial functions on the $n\dash$sphere.
  To construct a stably free module that is not free, take $TS^n$ for any $n$ for which it's trivial.

By Poincare Hopf, need euler characteristic zero, which happens when $n$ is odd.
Tangent bundle also trivial for lie groups.

:::{.theorem title="Bott-Milnor: Trivial Tangent Bundles of Spheres"}
The tangent bundle of $S^n$ is trivial iff $n\in \theset{1,3,7}$.
:::


If every module is free, they are stably free, yielding $K_0= 0$.

**Fact:**
If $R$ is a dedekind domain, $\tilde{ K_0(R) } = \pic (R)$, the ideal class group.

> So f.g. projectives need not be free, since ideals need not be principal.
> Theorem of Clayborn: $\pic (R)$ can be any commutative group!

Analogy: bundles are locally trivial, are projective modules "locally free"? 
We'll need localization to make sense of this, but such a theorem turns out to be true.

Definition (Local Ring)
: A local ring is a ring $R$ with a unique maximal ideal, usually written $(R, \mfm)$.

Exercise
: $R$ is local iff $R\setminus R\units \normal R$ is an ideal.

Localizing in the right way will yield local rings.

Lemma
: Let $q: R \to R/\mfm$ and $x\in R$, then $x\in R\units \iff q(x) \in (R/\mfm)\units$.

Proof
: The forward implication holds for any ring.
  The converse doesn't usually (think $\ZZ \to \ZZ/p\ZZ$).
  But if $q(x) \in (R/\mfm)\units = R/\mfm\setminus 0$, then $x\in R\setminus \mfm = R\units$.

:::{.theorem title="Projective Implies Free"}
A f.g. projective module over a local ring is free.
:::


This turns out to be true with "f.g." dropped, but that is a harder theorem.

To prove this, we'll need the following:

:::{.theorem title="Corollary of Nakayama's Lemma"}
For $(R, \mfm)$ a local ring and $M$ a finitely generated $R\dash$module.
Take a finite collection $\theset{m_i}$ such that $\theset{\bar m_i} \in M/\mfm M$ are generators as an $R/\mfm$ module.
Then $M$ is generated by $\theset{x_i}$.
:::


Usually identified *as* Nakayama's Lemma.


:::{.proof}
Let $P$ be a  f.g. projective $R\dash$module for $R$ a local ring.
Choose $Q$ such that $P \oplus Q = R^n$.
By base change, $P/\mfm P \oplus Q/\mfm Q = (R/\mfm)^n$.

So choose $R/\mfm$ bases $\theset{\bar p_i}^a$ of $P/\mfm P$ and $\theset{\bar q_j}^b$ of $Q/\mfm Q$.
Choose any lifts $p_i\in P, q_j\in Q$.
Let $A \in M_{n, m}(R)$ be the matrix formed by setting the first columns to $p_i$ and the remaining to $q_j$.

Then $\det(A) \mod \mfm \in (R/\mfm)\units$, and by the lemma, $\det(A) \in R\units$ and thus $A$ is invertible.
So $\theset{p_i, q_j}$ are $R\dash$linearly independent, so $\theset{p_i}$ span $P$ by Nakayama's lemma.
Thus $P$ is a free $R\dash$module.
:::

## Flat Modules

> Why are projective modules called such? See notes, characterization in terms of linear algebra and projection operators.

Suppose we have a SES of $R\dash$modules and we tensor with some $R\dash$module $M$:

\begin{center}
\begin{tikzcd}
& 0 \arrow[r] \arrow[dd] & N_1 \arrow[r, hook] \arrow[dd] & N_2 \arrow[r, tail] \arrow[dd, "\wait \tensor_R M"] & N_3 \arrow[r] \arrow[dd]  & 0 \\
&                        &                                &                                                     &                           &   \\
\cdots \arrow[r] & \cdots \arrow[r]       & N_1 \tensor_R M \arrow[r]      & N_2 \tensor_R M \arrow[r, tail]                     & N_3 \tensor_R M \arrow[r] & 0
\end{tikzcd}
\end{center}

Note that the induced map of the injection need not remain an injection.

Example
: Take $\ZZ \mapsto{\times 2} \ZZ \to \ZZ/2\ZZ$, then taking $\wait \tensor \ZZ/2\ZZ$ yields $\ZZ/2\ZZ \mapsvia{\times 2} \ZZ/2\ZZ$, which is the zero map.

Definition (Flat Modules)
: A module $M$ is **flat** iff $M\tensor_R \wait$ is exact, i.e. if $N_1 \injects N_2 \implies M\tensor_R N_1 \injects M\tensor_R N_2$.

Proposition (Flat Implies Torsionfree in Domains)
: If $R$ is a domain, then flat $\implies$ torsionfree.

Proof
: For the contrapositive, suppose $M$ is not torsionfree, then there exists some nonzero $r\in R^\bullet$ and $0\neq m\in M$ such that $rm = 0$.
  Then take $R\mapsvia{\times r} R$, which is injective since $R$ is a domain.
  Then tensoring with $M$ yields $M \mapsvia{\times r} M$, which has nonzero kernel by assumption.

Exercise (Important)
: Let $M_i$ be a family of $R\dash$modules, then $\bigoplus_i M_i$ is flat iff $M_i$ is flat for all $i$.

> Use the fact that tensor commutes with direct sum, use functoriality of direct sum to sum maps.

Proposition (Projective Implies Flat)
: Projective $\implies$ flat.

We now have the chain:
\begin{center}
Free $\implies$ projective $\implies$ flat $\implies_{R\text{ a domain }}$ torsionfree.
\end{center}

Proof (easy)
: By the exercise, $P$ projective implies existence of a $Q$ where $P\oplus Q$ is free, so it's enough to show that free $\implies$ flat.
  If $F$ is free, $F\cong \oplus_i R$, so $F$ is flat iff $R$ is flat.
  But $R\tensor_R R = R$, which does not change a SES at all.

So flat is somewhere between projective and torsionfree.

The next theorem is related to Cayley-Hamilton.


:::{.theorem title="Existence of Minimal Polynomials"}
Let $M$ be a finitely generated $R\dash$module with generators $\theset{x_i}$ and $I\normal R$, and take $\phi \in \endo_R(M)$ such that $\phi(M) \subseteq IM$.
Then there exist a set of coefficients $\theset{a_i}^n$ such that $\phi^n + a_{n-1}\phi^{n-1} + \cdots + a_1 \phi + a_0 = 0 \in \endo_R(M)$.
:::


Proof (Sneaky)
:   For all $i\leq n$, there exists a set $\theset{a_{ij}}_{j=1}^n \subset I$ such that $\phi(x_i) = \sum_{j=1}^n a_{ij} x_j$.
    Equivalently, for all $i$, 

    \begin{align*}
    \sum_{j=1}^n \qty{ \delta_{ij} \phi - a_{ij} } = 0
    .\end{align*}

    Let $P$ be a matrix with entry $i,j$ equal to $\delta_{ij} \phi - a_{ij} \in M_{n\times n}(R[\phi])$ where $R[\phi] \leq \endo_R(M)$ is the subalgebra generated by $\phi$.
    Note that this makes the base ring commutative, so this matrix makes sense.
    We can rewrite this as $P \cdot [x_1, x_2, \cdots, x_n]^t = 0$.

    **Claim:**
    If $S$ is a ring and $P\in M_{n \times n}(S)$, then there is an identity

    \begin{align*}
    P\adj(P) = \adj(P) P = \det(P) I_n
    .\end{align*}

    > Note that expanding this in the $2\times 2$ case yields a collection of polynomial identities, which tend to remain true in arbitrary rings (see "permanence of polynomial identities").

    Then $\det(P) I_n \vector x = \adj(P) M \vector x = \vector 0$ (often called **the determinant trick**).
    Thus $\det(P) x_i = 0$ for all $i$.
    But then $\det(P) M = 0$, and since $M$ is a faithful $R[\phi]\dash$module, we have $\det(P) = 0$.

    Then thinking of $\phi$ as a variable, expanding the determinant yields a monic polynomial in $\phi$ with coefficients that are products of $a_{ij}$, which are in $I$.


Note the analogy to $\det(I\lambda - A)$, so this yields the usual characteristic polynomial in the case of fields.

:::{.theorem title="NAK, a.k.a. Nakayama-Azumaya-Krull"}
Let $J\normal R$ be an ideal and $M\in \rmod$ finitely generated such that $JM = M$.
Then

a. $\exists x\in R$ such that $x\cong 1\mod J$ and $xM = 0$.

b. Suppose $J \in \mcj$ (the Jacobson radical), i.e. $J$ is in every maximal ideal; then $M = 0$.
:::

Note that if $R$ were local, this reduces to a simple case.

Proof (of (a))
: Apply the previous proposition to $\phi = \id_M$ and $I = J$; then the polynomial relation reduces to the existence of some $x = 1 + a_{n-1} + \cdots + a_0$ with $a_i \in J$, and this is equal to the zero endomorphism and thus $xM = 0$ and $x = 1\mod J$ as desired.

Proof (of (b))
: If $J\in \mfm$ for all $\mfm \in \maxspec(R)$, then if $x = 1 \mod J$ and $x = 1 \mod \mfm$, this forces $x\not\in\mfm$ and so $x\in R\units$.
  So if $yx = 1$ and $xM = 0 $, then $0 = yxM = M$.


Corollary
: Suppose $J \in \mcj$ and $M \in \rmod$ is f.g. with $N\leq_R M$ a submodule such that $JM + N = M$, then $N=M$.

Proof
: Apply part (b) above to $M/N$.
  If $M$ is f.g. then so is $M/N$, and $J(M/N) = \frac{JM + N}{N} = M/N$ (just from pushing into quotients).

Definition (Non-generator)
: An element $x\in M$ is a *non-generator* if whenever $S$ is a generating set for $M$, then $S\setminus x$ is still a generating set.

Thus if you're trying to find generators for a module, it never helps to add elements of $J$.

Corollary
: Let $J\in\mcj$, $M\in \rmod$ f.g., $x_1, \cdots, x_n$ such that $\theset{\bar x_i} \in M/JM$ are generators.
  Then $M$ is generated by $\theset{x_i}$.

Proof
: Take $N = \generators{\theset{x_i}} \leq M$.
  Then $\im(N) \subset M/JM$ is given by $\im(N) = \frac{N + JM}{JM} = \frac{M}{JM}$ since $\im(N)$ was assumed a generating set.
  But then $N = M$ by the previous corollary.

Theorem (3.44, Generalized NAK)
: Let $J\normal R$, $M\in\rmod$ f.g., then $JM = M \iff J + \ann M = R$.

Proof
:   \hfill 
    $\impliedby$
    $JM = M \iff M/JM = 0 \iff \ann M/JM = R$, and $\ann M/JM = \ann(M\tensor R/J) \supseteq J + \ann M = R$.

    $\implies$:
    Exercise.

Exercise
: Why does this imply part (b) in NAK?

Use the assumption that $J, \ann M$ are comaximal, and $J\in \mcz$, which forces $\ann M = R$ and thus $M = 0$.
